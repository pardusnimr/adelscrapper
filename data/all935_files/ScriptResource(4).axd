
Type.registerNamespace('PPSMA');PPSMA.$create_AjaxOlapRenderRequestRecord=function(outerDivId,controlType,olapContextId,height,width,reportLocation,inputs,navigationAction,viewProperties){var $o={};$o.TargetControlId=outerDivId;$o.TargetControlType=controlType;$o.OlapContextId=olapContextId;$o.Height=height;$o.Width=width;$o.ReportLocation=reportLocation;$o.Inputs=inputs;$o.NavigationAction=navigationAction;$o.ViewProperties=viewProperties;return $o;}
PPSMA.$create_AjaxOlapMetadataRequestRecord=function(outerDivId,controlType,olapContextId,metadataContextId,reportLocation,metadataAction){var $o={};$o.TargetControlId=outerDivId;$o.TargetControlType=controlType;$o.OlapContextId=olapContextId;$o.MetadataContextId=metadataContextId;$o.ReportLocation=reportLocation;$o.MetadataAction=metadataAction;return $o;}
PPSMA.SubMenuType=function(){};PPSMA.SubMenuType.prototype = {DrillDownTo:0,AddActions:1}
PPSMA.SubMenuType.registerEnum('PPSMA.SubMenuType',false);PPSMA.MenuMetadataTypes=function(){};PPSMA.MenuMetadataTypes.prototype = {None:0,CellActions:1,MeasureData:2,DimensionData:3}
PPSMA.MenuMetadataTypes.registerEnum('PPSMA.MenuMetadataTypes',false);PPSMA.OlapReportType=function(){};PPSMA.OlapReportType.prototype = {Grid:0,ColumnChart:1,ColumnChartStacked:2,ColumnChartStacked100:3,LineChart:4,LineChartWithMarkers:5,PieChart:6,BarChart:7,BarChartStacked:8,BarChartStacked100:9}
PPSMA.OlapReportType.registerEnum('PPSMA.OlapReportType',false);PPSMA.OlapView=function(){};PPSMA.OlapView.registerInterface('PPSMA.OlapView');PPSMA.Dimension=function(name,caption,type){this.$0=name;this.$1=caption;this.$2=type;}
PPSMA.Dimension.prototype={$0:null,$1:null,$2:0,$3:null,$4:null,get_name:function(){return this.$0;},get_caption:function(){return this.$1;},get_dimensionType:function(){return this.$2;},get_userDefinedHierarchies:function(){return this.$3;},get_attributeHierarchies:function(){return this.$4;},createUserDefinedHierarchies:function(count){this.$3=new Array(count);return this.$3;},createAttributeHierarchies:function(count){this.$4=new Array(count);return this.$4;}}
PPSMA.DimensionProperties=function(uniqueName,displayCaption,numPropertiesCount){this.$0=uniqueName;this.$1=displayCaption;this.$2=numPropertiesCount;this.$3=new Array(numPropertiesCount+1);this.$4=new Array(numPropertiesCount+1);this.$5=new Array(numPropertiesCount+1);for(var $0=0;$0<numPropertiesCount+1;$0++){this.$5[$0]=false;}}
PPSMA.DimensionProperties.prototype={$0:null,$1:null,$2:0,$3:null,$4:null,$5:null,$6:null,get_name:function(){return this.$0;},get_caption:function(){return this.$1;},get_enabledCount:function(){var $0=0;for(var $1=0;$1<this.$2;$1++){if(this.$5[$1]){++$0;}}return $0;},get_count:function(){return this.$2;},get_captions:function(){return this.$4;},get_names:function(){return this.$3;},get_checked:function(){return this.$5;},get_noPropertiesMessage:function(){return this.$6;},set_noPropertiesMessage:function(value){this.$6=value;return value;}}
PPSMA.Hierarchy=function(name,caption,type){this.$0=name;this.$1=caption;this.$3=type;if(this.$3!==1){this.$3=0;}}
PPSMA.Hierarchy.prototype={$0:null,$1:null,$2:null,$3:0,get_hierarchyType:function(){return this.$3;},get_name:function(){return this.$0;},get_caption:function(){return this.$1;},get_levels:function(){return this.$2;},createLevels:function(count){this.$2=new Array(count);return this.$2;}}
PPSMA.Level=function(name,caption,index){this.$0=name;this.$1=caption;this.$2=index;}
PPSMA.Level.prototype={$0:null,$1:null,$2:0,get_name:function(){return this.$0;},get_caption:function(){return this.$1;},get_index:function(){return this.$2;}}
PPSMA.ResultHierarchy=function(name,isSingleton,deepestLevel,highestLevel,highestLevelName,dimension){this.$0=name;this.$1=isSingleton;this.$2=deepestLevel;this.$3=highestLevel;this.$4=highestLevelName;this.$5=false;this.$6=null;this.$7=dimension;}
PPSMA.ResultHierarchy.prototype={$0:null,$1:false,$2:0,$3:0,$4:null,$5:false,$6:null,$7:null,get_name:function(){return this.$0;},get_dimension:function(){return this.$7;},get_isSingleton:function(){return this.$1;},get_deepestLevel:function(){return this.$2;},get_highestLevel:function(){return this.$3;},get_highestLevelName:function(){return this.$4;},get_isAggregated:function(){return this.$5;},set_isAggregated:function(value){this.$5=value;return value;},createMemberProperties:function(uniqueName,memberPropertyCount){if(!this.$6){this.$6=new PPSMA.ResultMemberProperties(uniqueName,memberPropertyCount);}},get_memberProperties:function(){return this.$6;}}
PPSMA.ResultMemberProperties=function(uniqueName,count){this.$0=uniqueName;this.$5=count;this.$2=new Array(this.$5);this.$3=new Array(this.$5);this.$4=new Array(this.$5);this.$1=0;}
PPSMA.ResultMemberProperties.prototype={$0:null,$1:0,$2:null,$3:null,$4:null,$5:0,createProperty:function(name,caption){this.$2[this.$1]=name;this.$3[this.$1]=caption;this.$4[this.$1]=true;++this.$1;},hide:function(propertyName){for(var $0=0;$0<this.$1;$0++){if(this.$2[$0]===propertyName){this.$4[$0]=false;break;}}},isPropertyHidden:function(propertyName){for(var $0=0;$0<this.$1;$0++){if(this.$2[$0]===propertyName){return ((this.$4[$0])?false:true);}}return true;},get_numPropertiesHidden:function(){var $0=0;for(var $1=0;$1<this.$1;$1++){if(!this.$4[$1]){++$0;}}return $0;},get_count:function(){return this.$1;},get_name:function(){return this.$0;},get_captions:function(){return this.$3;},get_names:function(){return this.$2;}}
PPSMA.Results=function(rowCount,columnCount,canNavigate,isDesigner){this.$3=new Array(0);this.$6=new Array(0);this.$9=new Array(0);this.$A=rowCount;this.$B=columnCount;this.$C=canNavigate;this.$D=isDesigner;this.$E=0;this.$F=0;this.$10=null;this.$11='nosort';this.$12='nosort';this.$13=0;this.$14=0;this.$15=0;this.$16=0;this.$17=0;this.$18=0;this.$19='';this.$1A='';}
PPSMA.Results.prototype={$0:false,$1:0,$2:null,$4:0,$5:null,$7:0,$8:null,$A:0,$B:0,$C:false,$D:false,$E:0,$F:0,$10:null,$11:null,$12:null,$13:0,$14:0,$15:0,$16:0,$17:0,$18:0,$19:null,$1A:null,get_rowMembers:function(){return this.$2;},get_columnMembers:function(){return this.$5;},get_filterMembers:function(){return this.$8;},get_rowHierarchies:function(){return this.$3;},get_columnHierarchies:function(){return this.$6;},get_filterHierarchies:function(){return this.$9;},get_rowCount:function(){return this.$A;},get_columnCount:function(){return this.$B;},get_canNavigate:function(){return this.$C;},get_isDesigner:function(){return this.$D;},get_filterEmptyAxis:function(){return this.$E;},set_filterEmptyAxis:function(value){this.$E=value;return value;},get_sortedAxes:function(){return this.$F;},set_sortedAxes:function(value){this.$F=value;return value;},get_sortTuple:function(){return this.$10;},set_sortTuple:function(value){this.$10=value;return value;},get_sortTypeCol:function(){return this.$11;},set_sortTypeCol:function(value){this.$11=value;return value;},get_sortTypeRow:function(){return this.$12;},set_sortTypeRow:function(value){this.$12=value;return value;},get_sortColIndex:function(){return this.$13;},set_sortColIndex:function(value){this.$13=value;return value;},get_sortRowIndex:function(){return this.$14;},set_sortRowIndex:function(value){this.$14=value;return value;},get_unknownFilterParameters:function(){return this.$0;},set_unknownFilterParameters:function(value){this.$0=value;return value;},get_valueFilterCol:function(){return this.$15;},set_valueFilterCol:function(value){this.$15=value;return value;},get_valueFilterRow:function(){return this.$16;},set_valueFilterRow:function(value){this.$16=value;return value;},get_valueFilterParamsCol:function(){return this.$19;},set_valueFilterParamsCol:function(value){this.$19=value;return value;},get_valueFilterParamsRow:function(){return this.$1A;},set_valueFilterParamsRow:function(value){this.$1A=value;return value;},get_topFilterCol:function(){return this.$17;},set_topFilterCol:function(value){this.$17=value;return value;},get_topFilterRow:function(){return this.$18;},set_topFilterRow:function(value){this.$18=value;return value;},createRowMembers:function(hierarchyCount){this.$1=hierarchyCount;this.$3=new Array(hierarchyCount);this.$2=new Array(this.$A);for(var $0=0;$0<this.$A;$0++){this.$2[$0]=new Array(this.$1);}return this.$2;},createColumnMembers:function(hierarchyCount){this.$4=hierarchyCount;this.$6=new Array(hierarchyCount);this.$5=new Array(this.$B);for(var $0=0;$0<this.$B;$0++){this.$5[$0]=new Array(this.$4);}return this.$5;},createFilterMembers:function(hierarchyCount){this.$7=hierarchyCount;this.$9=new Array(hierarchyCount);this.$8=new Array(this.$7);return this.$8;}}
PPSMA.Member=function(id,name,cap,lName,lNum,hasP,hasC,dd){this.id=id;this.$0=name;this.$1=cap;this.$2=lName;this.$3=lNum;this.$4=hasP;this.$5=hasC;this.$6=dd;}
PPSMA.Member.prototype={id:null,$0:null,$1:null,$2:null,$3:0,$4:false,$5:false,$6:false,get_id:function(){return this.id;},get_name:function(){return this.$0;},get_caption:function(){return this.$1;},get_levelName:function(){return this.$2;},get_levelNumber:function(){return this.$3;},get_hasParent:function(){return this.$4;},get_hasChildren:function(){return this.$5;},get_drilledDown:function(){return this.$6;},set_drilledDown:function(value){this.$6=value;return value;}}
PPSMA.ReportsCommon=function(){}
PPSMA.ReportsCommon.getCellTypeId=function(currCell){var $0='\u0000';if(currCell){var $1=currCell.getAttribute('id');if($1&&$1.length>=5){var $2=$1.charAt(0);switch($2){case 'R':case 'C':case 'D':case 'P':case 'Z':case 'Y':$0=$2;break;}}}return $0;}
PPSMA.ReportsCommon.isInMoreAccessibleMode=function(){var $0=false;var $1=window.document.cookie.split(';');for(var $2=0;$2<$1.length;$2++){var $3=$1[$2].split('=');if($3.length===2){if($3[0].trim()==='WSS_AccessibilityFeature'){$0=Boolean.parse($3[1].trim().toLowerCase());}}else{PPSMA.ReportsCommon.logErrorCondition('IsInMoreAccessibleMode: Unexpected name0=value0; format:'+window.document.cookie);}}return $0;}
PPSMA.ReportsCommon.logErrorCondition=function(msg){}
PPSMA.ReportsCommon.getHeaderCellHierarchy=function(olapViewContext,currCell){var $0=null;if(currCell){var $1=PPSMA.ReportsCommon.getCellRowPosition(currCell);var $2=PPSMA.ReportsCommon.getCellColumnPosition(currCell);if(($1!==-1)&&($2!==-1)){var $3=PPSMA.ReportsCommon.getCellTypeId(currCell);var $4;switch($3){case 'Z':case 'Y':$4=olapViewContext.get_results().get_rowHierarchies();$0=$4[$1];break;case 'R':$4=olapViewContext.get_results().get_rowHierarchies();$0=$4[$2];break;case 'C':var $5=olapViewContext.get_results().get_columnHierarchies();$0=$5[$1];break;case 'D':case 'P':break;}}}return $0;}
PPSMA.ReportsCommon.getCellRowPosition=function(currCell){var $0=-1;if(currCell){var $1=currCell.getAttribute('id');if($1&&$1.length>=5){var $2=$1.match(new RegExp('R[0-9]+','g'));if($2&&$2.length>=1){var $3=$2[0];if($3.length>=1){$0=parseInt($3.substring(1,$3.length));}}}}return $0;}
PPSMA.ReportsCommon.getSortedCellColumnPosition=function(currCell){var $0=PPSMA.ReportsCommon.getCellTypeId(currCell);var $1=PPSMA.ReportsCommon.getCellColumnPosition(currCell);if($0==='C'){$1=$1-(parseInt(currCell.getAttribute('colspan'))-1);}return $1;}
PPSMA.ReportsCommon.getCellColumnPosition=function(currCell){var $0=-1;if(currCell){var $1=currCell.getAttribute('id');if($1&&$1.length>=5){var $2=$1.match(new RegExp('C[0-9]+','g'));if($2&&$2.length>=1){var $3=$2[0];if($3.length>=1){$0=parseInt($3.substring(1,$3.length));}}}}return $0;}
PPSMA.ReportsCommon.debugPrint=function(msg){}
PPSMA.DialogsCommon=function(){}
PPSMA.DialogsCommon.addDialogResizeEventHandlers=function(windowResizeHandler,resizeImgLnkClickHandler){try{if(windowResizeHandler){Sys.UI.DomEvent.addHandler(window,'resize',windowResizeHandler);}}catch($1){return false;}var $0=document.getElementsByTagName('a');if(!$0){return false;}for(var $2=0;$2<$0.length;$2++){var $3=$0[$2];if((PPSMA.DomElementEx.tagsMatch($3.tagName,'a'))&&$3.className==='ms-dlgCloseBtn'&&resizeImgLnkClickHandler){Sys.UI.DomEvent.addHandler($3,'click',resizeImgLnkClickHandler);return true;}}return false;}
PPSMA.DialogsCommon.removeWindowResizeEventHandler=function(windowResizeHandler){try{Sys.UI.DomEvent.removeHandler(window,'resize',windowResizeHandler);return true;}catch($0){return false;}}
PPSMA.DialogsCommon.getDlgFrameContainerDiv=function(){var $0=document.getElementsByTagName('div');for(var $1=0;$1<$0.length;$1++){var $2=$0[$1];if(PPSMA.DomElementEx.tagsMatch($2.className,'ms-dlgFrameContainer')){return $2;}}return null;}
PPSMA.ContextMenu=function(){}
PPSMA.ContextMenu.create=function(currItem,ctxObject,xOffset,yOffset,isInPulpit){if(PPSMA.ContextMenu.isMenuOn()&&PPSMA.ContextMenu.get_menuType()!=='tooltip'){return false;}PPSMA.ContextMenu.$2();if(!currItem||(PPSMA.DomElementEx.tagsMatch(currItem.tagName,'a')&&!isInPulpit)){return false;}return PPSMA.ContextMenu.$3(currItem,ctxObject,xOffset,yOffset,'menu');}
PPSMA.ContextMenu.createTooltip=function(currItem,ctxObject,xOffset,yOffset){if(PPSMA.ContextMenu.isMenuOn()&&PPSMA.ContextMenu.get_menuType()!=='tooltip'){return false;}PPSMA.ContextMenu.$2();return PPSMA.ContextMenu.$3(currItem,ctxObject,xOffset,yOffset,'tooltip');}
PPSMA.ContextMenu.get_menuType=function(){return PPSMA.Menu.GetType(PPSMA.ContextMenu.$1);}
PPSMA.ContextMenu.isMenuOn=function(){return PPSMA.Menu.IsOpen(PPSMA.ContextMenu.$1);}
PPSMA.ContextMenu.addMenuSeparator=function(p){var $0=PPSMA.ContextMenu.$A();if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.addSubMenu=function(p,caption,imgUrl,indent){var $0=PPSMA.ContextMenu.$C(caption,null,null,null,imgUrl,indent);if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.addDynamicSubMenu=function(p,caption,fetchFunction,populateFunction,hoverOffFunction,indent){var $0=PPSMA.ContextMenu.$C(caption,fetchFunction,populateFunction,hoverOffFunction,null,indent);if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.addToggleMenuOption=function(p,caption,eventFunction,imageUrl,altText,selected,indent){var $0=PPSMA.ContextMenu.$8(caption,eventFunction,imageUrl,altText,selected,true,indent);if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.addMenuOption=function(p,caption,eventFunction,imageUrl,altText,selected,indent){var $0=PPSMA.ContextMenu.$8(caption,eventFunction,imageUrl,altText,selected,false,indent);if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.addDisabledMenuOption=function(p,caption,eventFunction,imageUrl,indent){var $0=PPSMA.ContextMenu.$9(caption,imageUrl,'',indent);if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.addMenuItem=function(p,type){var $0=PPSMA.ContextMenu.$B(type);if(!$0){return null;}PPSMA.ContextMenu.$6(p,$0);return $0;}
PPSMA.ContextMenu.removeAllButFirst=function(p){while(p.childNodes.length>1){p.removeChild(p.lastChild);}}
PPSMA.ContextMenu.refreshMenu=function(currentMenu,force){if(PPSMA.ContextMenu.isMenuOn()){PPSMA.Menu.Refresh(PPSMA.ContextMenu.$1,currentMenu,force);}}
PPSMA.ContextMenu.$2=function(){PPSMA.ContextMenu.$1=null;PPSMA.ContextMenu.$0=null;}
PPSMA.ContextMenu.$3=function($p0,$p1,$p2,$p3,$p4){PPSMA.ContextMenu.$0=$p0;var $0=PPSMA.ContextMenu.$0.getAttribute('ID');PPSMA.ContextMenu.$1=PPSMA.ContextMenu.$7($0+'_'+$p4,$p4);if(!$p1.addPrimaryMenuItems(PPSMA.ContextMenu.$1)){PPSMA.ContextMenu.$2();return false;}PPSMA.ContextMenu.$4(PPSMA.ContextMenu.$1,PPSMA.ContextMenu.$0,true,false,$p2,$p3);return true;}
PPSMA.ContextMenu.$4=function($p0,$p1,$p2,$p3,$p4,$p5){if($p0){if(!PPSMA.Menu.IsOpen($p0)){PPSMA.Menu.Show($p0,$p1,$p2,$p3,$p4,$p5);}}}
PPSMA.ContextMenu.$5=function($p0,$p1,$p2){if(!$p0){return;}if(!isNullOrEmpty($p1)){$p0.setAttribute('iconSrc',$p1);}if(!isNullOrEmpty($p2)){$p0.setAttribute('iconAltText',$p2);}}
PPSMA.ContextMenu.$6=function($p0,$p1){if($p0&&$p1){$p0.appendChild($p1);}}
PPSMA.ContextMenu.$7=function($p0,$p1){var $0=$get($p0);if($0){$0._initialized = false;$0._oContents = null;$0.innerHTML='';return $0;}$0=document.createElement('MENU');if(!$0){return null;}if(!isNullOrEmpty($p0)){$0.id=$p0;}$0.className='bsm-SrvMenuUI';$0._menuType = $p1;PPSMA.ContextMenu.$6(document.body,$0);return $0;}
PPSMA.ContextMenu.$8=function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $0=PPSMA.ContextMenu.$B('option');if(!$0){return null;}PPSMA.DomElementEx.setInnerText($0,$p0);if($p6){$0.setAttribute('indent','true');}var $1=$p1;if($p4&&!isNullOrEmpty($p2)){$0.setAttribute('selected','true');if(!$p5){$1='';}}$0.setAttribute('onmenuclick',$1);PPSMA.ContextMenu.$5($0,$p2,$p3);return $0;}
PPSMA.ContextMenu.$9=function($p0,$p1,$p2,$p3){var $0=PPSMA.ContextMenu.$B('option');if(!$0){return null;}PPSMA.DomElementEx.setInnerText($0,$p0);$0.setAttribute('enabled','false');if($p3){$0.setAttribute('indent','true');}PPSMA.ContextMenu.$5($0,$p1,$p2);return $0;}
PPSMA.ContextMenu.$A=function(){var $0=PPSMA.ContextMenu.$B('separator');PPSMA.DomElementEx.setInnerText($0,'');return $0;}
PPSMA.ContextMenu.$B=function($p0){var $0=document.createElement('SPAN');if(!$0){return null;}$0.setAttribute('type',$p0);return $0;}
PPSMA.ContextMenu.$C=function($p0,$p1,$p2,$p3,$p4,$p5){var $0=PPSMA.ContextMenu.$B('submenu');if(!$0){return null;}if($p5){$0.setAttribute('indent','true');}PPSMA.ContextMenu.$5($0,$p4,null);if(!isNullOrEmpty($p1)){$0.setAttribute('onfetch',$p1);}if(!isNullOrEmpty($p2)){$0.setAttribute('onpopulate',$p2);}if(!isNullOrEmpty($p3)){$0.setAttribute('onhoveroff',$p3);}var $1=PPSMA.ContextMenu.$D($p0);PPSMA.ContextMenu.$6($0,$1);return $0;}
PPSMA.ContextMenu.$D=function($p0){var $0=PPSMA.ContextMenu.$B('label');if(!$0){return null;}PPSMA.DomElementEx.setInnerText($0,$p0);return $0;}
PPSMA.ShowProperties=function(viewCtxName,olapViewContext){this.$0=viewCtxName;this.$1=olapViewContext;this.$2=null;this.$3=-1;}
PPSMA.ShowProperties.prototype={$0:null,$1:null,$2:null,$3:0,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,get_selectedButton:function(){return this.$9;},setCallbackMethod:function(callback){this.$7=callback;},show:function(currCell){this.$2=currCell;this.$2C();this.$22();this.$26();window.setTimeout(Function.createDelegate(this,this.$2B),250);},getTotalMemberPropertyCount:function(){if(this.$3===-1){this.$3=0;var $0=this.$1.get_results().get_rowHierarchies();if($0){for(var $1=0;$1<$0.length;$1++){var $2=$0[$1].get_name();var $3=this.$30($2);this.$3+=$3.get_count();}}}return this.$3;},isEnabled:function(currCell){var $0=this.$2A(currCell);if(!$0){return true;}if($0.get_name()===this.$1.get_measureHierarchyName()){return false;}else{return true;}},$22:function(){var $0=this.$2A(this.$2);if($0){this.$4=$0.get_name();if(!this.$1.getDimensionPropertiesList($0.get_name())){this.$1.getDimensionProperties(this.$2F(),Function.createDelegate(this,this.$23));}else{this.$23(true);}}},$23:function($p0){if((this.$1.get_dimensionData())&&$p0){if(this.$2D()){this.$2E();this.$2B();this.setInitialFocus();this.$1.notifyBrowserOfAsyncUpdate($get(this.$1.get_ctrlProxyId()+'_ShowPropertiesDiv'));}else{this.$6.close(0);}}else{this.$1.getDimensionProperties(this.$2F(),Function.createDelegate(this,this.$23));}},setInitialFocus:function(){var $0=$get(this.$1.get_ctrlProxyId()+'_gDimProperties');if(($0)&&($0.firstChild)&&($0.firstChild.firstChild)){$0.firstChild.firstChild.focus();}else{PPSMA.ReportsCommon.logErrorCondition('ShowProperties: can\'t set initial focus.');}},inputClick:function(e){var $0=$get(this.$1.get_ctrlProxyId()+'_gDimProperties');var $1=$0.getElementsByTagName('input');var $2=this.$2A(this.$2).get_name();var $3=this.$1.getDimensionPropertiesList($2);var $4=$3.get_checked();var $5=PPSMA.EventsEx.getCurrentElement(e.rawEvent);if($5.className==='dimPropCheckBox'){var $6=$5.id;var $7=parseInt($6.substr((this.$1.get_ctrlProxyId().length+'_divPropCheckBox_'.length),$6.length));($1[$7]).checked=!($1[$7]).checked;}else if($5.className==='dimPropCheckBoxLabel'){var $8=$5.id;var $9=parseInt($8.substr((this.$1.get_ctrlProxyId().length+'_divPropLabel_'.length),$8.length));($1[$9]).checked=!($1[$9]).checked;}for(var $A=0;$A<$1.length;++$A){var $B=$get(this.$1.get_ctrlProxyId()+'_divPropCheckBox_'+$A);var $C=$1[$A];if(!$C.checked){$4[$A]=false;}else{$4[$A]=true;}}},selectAll:function(e){var $0=$get(this.$1.get_ctrlProxyId()+'_gDimProperties');var $1=$0.getElementsByTagName('input');var $2=$get(this.$1.get_ctrlProxyId()+'_propSelectAll');var $3=this.$2A(this.$2).get_name();var $4=this.$1.getDimensionPropertiesList($3);var $5=$4.get_checked();for(var $6=0;$6<$1.length;++$6){var $7=$1[$6];if($7.checked!==$2.checked){$7.checked=$2.checked;$5[$6]=$2.checked;}}},handleHidePropertyMenuClick:function(hierName,propertyName){if(!this.get_$25()){return;}var $0=this.$1.getDimensionPropertiesList(hierName);if($0){var $1=$0.get_names();var $2=$0.get_checked();for(var $3=0;$3<$0.get_count();$3++){if(($1[$3]===propertyName)&&($2[$3])){$2[$3]=false;break;}}}else{var $4=this.$1.get_results().get_rowHierarchies();for(var $5=0;$5<$4.length;$5++){var $6=$4[$5];if($6.get_name()===hierName){var $7=$6.get_memberProperties();if($7){$7.hide(propertyName);break;}}}}this.$1.applyDimensionProperties();},apply:function(e){var $0=this.$2A(this.$2);if(!$0||isNullUndefinedOrEmpty($0.get_name())||!this.$32($0.get_name())){this.$6.close(0);return;}var $1=$get(this.$1.get_ctrlProxyId()+'_ShowPropertiesDiv');$1.style.display='none';var $2=$get(this.$1.get_ctrlProxyId()+'_gDimProperties');var $3=$2.getElementsByTagName('input');var $4=this.$1.getDimensionPropertiesList($0.get_name());if($4){var $5=$4.get_checked();for(var $7=0;$7<$3.length;++$7){var $8=$3[$7];$5[$7]=$8.checked;}var $6=$get(this.$1.get_ctrlProxyId()+'_propSelectAll');$5[$4.get_count()]=$6.checked;}this.$1.applyDimensionProperties();this.$6.close(1);},cancel:function(e){this.$6.close(0);},$24:function($p0,$p1){this.$9='1';if(!$p0){this.$9='2';var $0=this.$2A(this.$2);if($0&&!isNullUndefinedOrEmpty($0.get_name())){this.$31($0.get_name());}}this.$27();if(this.$7){this.$7();}},get_$25:function(){return this.$1.get_results().get_canNavigate();},$26:function(){this.$8=Function.createDelegate(this,this.$28);if(!PPSMA.DialogsCommon.addDialogResizeEventHandlers(this.$8,Function.createDelegate(this,this.$29))){PPSMA.ReportsCommon.logErrorCondition('ShowProperties: couldn\'t add the resize event handlers');}var $0=$get(this.$1.get_ctrlProxyId()+'_propSelectAll');if($0){Sys.UI.DomEvent.addHandler($0,'click',Function.createDelegate(this,this.selectAll));}$0=$get(this.$1.get_ctrlProxyId()+'_propApply_');if($0){Sys.UI.DomEvent.addHandler($0,'click',Function.createDelegate(this,this.apply));}$0=$get(this.$1.get_ctrlProxyId()+'_propCancel_');if($0){Sys.UI.DomEvent.addHandler($0,'click',Function.createDelegate(this,this.cancel));}$0=$get(this.$1.get_ctrlProxyId()+'_gDimProperties');if($0){Sys.UI.DomEvent.addHandler($0,'click',Function.createDelegate(this,this.inputClick));}},$27:function(){if(!PPSMA.DialogsCommon.removeWindowResizeEventHandler(this.$8)){PPSMA.ReportsCommon.logErrorCondition('ShowProperties: couldn\'t remove the resize event handlers');}this.$8=null;},$28:function($p0){window.setTimeout(Function.createDelegate(this,this.$2B),250);},$29:function($p0){window.setTimeout(Function.createDelegate(this,this.$2B),250);},$2A:function($p0){var $0=PPSMA.ReportsCommon.getCellTypeId($p0);var $1=null;if(($0==='R')||($0==='Z')||($0==='Y')){$1=PPSMA.ReportsCommon.getHeaderCellHierarchy(this.$1,$p0);}else if($0==='P'){var $2=this.$1.get_results().get_rowHierarchies();var $3=PPSMA.ReportsCommon.getCellColumnPosition($p0);$1=$2[$3];}return $1;},$2B:function(){var $0=$get(this.$1.get_ctrlProxyId()+'_ShowPropertiesDiv');var $1=$get(this.$1.get_ctrlProxyId()+'_DimPropertiesDiv');var $2=$get(this.$1.get_ctrlProxyId()+'_gDimProperties');var $3=$get(this.$1.get_ctrlProxyId()+'_ShowPropertiesFooter');var $4=$get(this.$1.get_ctrlProxyId()+'_SelectedMemberNameTable');if(!$0||!$2||!$3||!$4){return;}if(!$1&&!getBrowserIs().ie55up){return;}var $5=PPSMA.DialogsCommon.getDlgFrameContainerDiv();if(!$5){PPSMA.ReportsCommon.logErrorCondition('Resize: unable to find ms-dlgFrameContainer');return;}var $6=$5.offsetWidth;var $7=$5.offsetHeight;$0.style.height=$7+'px';$0.style.width=$6+'px';var $8=$7-($3.offsetHeight+$4.offsetHeight);$8=($8>0)?$8:0;if(!getBrowserIs().ie55up){$1.style.height=$8+'px';}$2.style.height=$8+'px';var $9=$3.firstChild;var $A=$3.lastChild;if(!$9||!$A){return;}var $B=$6-($9.offsetWidth+$A.offsetWidth);if($B>=0&&$9.nextSibling){$9.nextSibling.style.width=$B+'px';}},$2C:function(){var $0=this.$1.get_ctrlProxyId();var $1=document.createElement('div');$1.id=$0+'_ShowPropertiesDiv';$1.className='dimPropParentBorder';document.body.appendChild($1);var $2=document.createElement('div');$2.id=$0+'_SelectedMemberNameTable';$2.className='dimPropSelectedMember';var $3=document.createElement('span');$3.id=$0+'_gspanSelectedDimension';$3.innerHTML='&nbsp;';$2.appendChild($3);$1.appendChild($2);var $4=null;if(!getBrowserIs().ie55up){$4=document.createElement('div');$4.id=$0+'_DimPropertiesDiv';$4.style.backgroundColor='white';}var $5=document.createElement('fieldset');$5.style.border='none';$5.id=$0+'_gDimProperties';$5.className='dimPropCheckBoxes';if((!getBrowserIs().ie55up)&&($4)){$4.appendChild($5);$1.appendChild($4);}else{$1.appendChild($5);}var $6=document.createElement('div');$6.id=$0+'_ShowPropertiesFooter';$6.style.backgroundColor='#f0f0f0';$6.style.left='0px';$6.style.height='30px';$6.style.width='100%';$6.style.paddingTop='5px';$1.appendChild($6);var $7=document.createElement('div');$7.className='dimPropFloatLeft';$6.appendChild($7);var $8=document.createElement('div');$8.innerHTML='&nbsp;';$8.className='dimPropFloatLeft';$6.appendChild($8);var $9=document.createElement('div');$9.className='dimPropFloatLeft';$6.appendChild($9);var $A=document.createElement('input');$A.id=$0+'_propSelectAll';$A.setAttribute('type','checkbox');$A.setAttribute('title',PPSMA.SR.OlapPropertiesDialog_SelectAll);$A.style.marginLeft='8px';$7.appendChild($A);var $B=document.createElement('label');$B.id=$0+'_propSelectAll'+'label';$B.setAttribute('for',$0+'_propSelectAll');$B.setAttribute('title',PPSMA.SR.OlapPropertiesDialog_SelectAll);$B.className='dimPropCheckBoxLabel';$B.innerHTML=PPSMA.SR.OlapPropertiesDialog_SelectAll;$7.appendChild($B);var $C=document.createElement('input');$C.id=$0+'_propApply_';$C.className='ms-ButtonHeightWidth';$C.style.width='5em';$C.style.marginRight='4px';$C.value=PPSMA.SR.OlapPropertiesDialog_Apply;$C.type='button';$9.appendChild($C);var $D=document.createElement('input');$D.id=$0+'_propCancel_';$D.className='ms-ButtonHeightWidth';$D.style.width='5em';$D.style.marginLeft='4px';$D.style.marginRight='8px';$D.value=PPSMA.SR.OlapPropertiesDialog_Cancel;$D.type='button';$9.appendChild($D);var $E=document.createElement('div');$E.appendChild($1);var $F=PPSMA.SizeEx.getCenterXandY(300,200);var $10=SP.UI.$create_DialogOptions();$10.height=200;$10.width=300;$10.title=PPSMA.SR.OlapPropertiesDialog_Title;$10.html=$E;$10.html.innerHTML=$E.innerHTML;PPSMA.DomElementEx.removeElement($1);$10.x=$F.x;$10.y=$F.y;$10.dialogReturnValueCallback=Function.createDelegate(this,this.$24);this.$6=SP.UI.ModalDialog.showModalDialog($10);},$2D:function(){var $0=$get(this.$1.get_ctrlProxyId()+'_ShowPropertiesDiv');var $1;var $2=null;var $3=null;var $4=null;var $5;if(this.$1.get_dimensionData()){var $8=PPSMA.XmlEx.loadXml(this.$1.get_dimensionData());var $9=$8.getElementsByTagName('DimensionProperties');var $A=$8.getElementsByTagName('DimProperty');$5=$9[0].getAttribute('caption');$1=this.$1.addDimensionPropertiesList(this.$4,$5,$A.length);$1.set_noPropertiesMessage($9[0].getAttribute('NoPropertiesMessage'));if($A.length>0){var $B=this.$30(this.$4);var $C=null;if($B){$C=$B.get_names();}$2=$1.get_names();$3=$1.get_captions();$4=$1.get_checked();for(var $D=0;$D<$A.length;$D++){$2[$D]=$A[$D].getAttribute('name');$3[$D]=$A[$D].getAttribute('caption');if($B){for(var $E=0;$E<$B.get_count();$E++){if($C[$E]===$2[$D]){$4[$D]=true;}}}}}}else{$1=this.$1.getDimensionPropertiesList(this.$4);$5=$1.get_caption();$2=$1.get_names();$3=$1.get_captions();$4=$1.get_checked();}var $6=null;var $7;if(!getBrowserIs().ie55up){$6=PPSMA.DomElementEx.getChildElementById($0,this.$1.get_ctrlProxyId()+'_DimPropertiesDiv');$7=PPSMA.DomElementEx.getChildElementById($6,this.$1.get_ctrlProxyId()+'_gDimProperties');}else{$7=PPSMA.DomElementEx.getChildElementById($0,this.$1.get_ctrlProxyId()+'_gDimProperties');}if($1.get_count()>0){var $F=0;var $10;if($1.get_count()<10){$10=$1.get_count()*20;if((!getBrowserIs().ie55up)&&($6)){$6.style.height=$10+'px';$6.style.overflow='hidden';}$7.style.height=$10+'px';$7.style.overflow='hidden';}else{$10=200;if((!getBrowserIs().ie55up)&&($6)){$6.style.height=$10+'px';$6.style.overflowX='hidden';$6.style.overflowY='auto';}$7.style.height=$10+'px';$7.style.overflow='auto';}var $11=PPSMA.DomElementEx.getChildElementById($0,this.$1.get_ctrlProxyId()+'_SelectedMemberNameTable');var $12=PPSMA.DomElementEx.getChildElementById($11,this.$1.get_ctrlProxyId()+'_gspanSelectedDimension');$12.innerHTML=String.format(PPSMA.SR.OlapPropertiesDialog_PropertiesCaption,$5);var $13=0;this.$5=new Array($1.get_count()+1);for(var $16=0;$16<$1.get_count();$16++){var $17=this.$1.get_ctrlProxyId()+'_inputPropCheckBox_'+$16;var $18=this.$1.get_ctrlProxyId()+'_divPropCheckBox_'+$16;var $19=this.$1.get_ctrlProxyId()+'_divPropLabel_'+$16;var $1A=document.createElement('div');var $1B=document.createElement('input');var $1C=document.createElement('label');$1A.id=$18;$1A.className='dimPropCheckBox';if(!getBrowserIs().ie55up){$1A.style.paddingLeft='0px';}$1B.setAttribute('type','checkbox');$1B.setAttribute('title',$3[$16]);$1B.setAttribute('value',$2[$16]);$1B.setAttribute('id',$17);$1C.setAttribute('for',$17);$1C.setAttribute('title',$3[$16]);$1C.className='dimPropCheckBoxLabel';$1C.id=$19;var $1D=$3[$16];if($1D.length>100){$1D=$1D.substr(0,100)+PPSMA.SR.OlapPropertiesDialog_LongStringPadding;}$1C.innerHTML='&nbsp;'+$1D;$1A.appendChild($1B);$1A.appendChild($1C);$7.appendChild($1A);var $1E=$1C.offsetWidth;if($1E>$F){$F=$1E;}if($4[$16]){this.$5[$13++]=$17;}}var $14=PPSMA.DomElementEx.getChildElementById($0,this.$1.get_ctrlProxyId()+'_ShowPropertiesFooter');var $15=$get(this.$1.get_ctrlProxyId()+'_propSelectAll');if($13===$1.get_count()){this.$5[$13]=$15.getAttribute('id');}return true;}alert($1.get_noPropertiesMessage());return false;},$2E:function(){for(var $0=0;$0<this.$5.length;$0++){if(isNullUndefinedOrEmpty(this.$5[$0])){break;}var $1=$get(this.$5[$0]);$1.checked=true;}},$2F:function(){var $0=PPSMA.XmlEx.loadXml('<_dimProp />');var $1=$0.createElement('Dimension');$0.documentElement.appendChild($1);$1.setAttribute('name',this.$4);return PPSMA.XmlEx.getXml($0.documentElement);},$30:function($p0){var $0=this.$1.get_results().get_rowHierarchies();for(var $1=0;$1<$0.length;$1++){if($0[$1].get_name()===$p0){var $2=$0[$1];return $2.get_memberProperties();}}return null;},$31:function($p0){var $0=this.$30($p0);if($0){var $1=$0.get_names();var $2=this.$1.getDimensionPropertiesList($p0);if($2){var $3=$2.get_names();var $4=$2.get_checked();for(var $5=0;$5<$2.get_count();$5++){$4[$5]=false;for(var $6=0;$6<$0.get_count();$6++){if($1[$6]===$3[$5]){$4[$5]=true;}}}}}},$32:function($p0){var $0=this.$30($p0);var $1=this.$1.getDimensionPropertiesList($p0);if($1){if(((!$0)||(!$0.get_count()))&&($1.get_enabledCount()>0)){return true;}var $2=null;if($0){$2=$0.get_names();}var $3=$1.get_names();var $4=$1.get_checked();for(var $5=0;$5<$1.get_count();$5++){if(!$0||!$2){if($4[$5]){return true;}}else{var $6=false;for(var $7=0;$7<$0.get_count();$7++){if($2[$7]===$3[$5]){$6=true;if(!$4[$5]){return true;}}}if(!$6&&$4[$5]){return true;}}}}return false;}}
PPSMA.ThinFieldListItemSelectedEventArgs=function(uniqueName,caption,isSelected){PPSMA.ThinFieldListItemSelectedEventArgs.initializeBase(this);this.itemUniqueName=uniqueName;this.itemCaption=caption;this.itemIsSelected=isSelected;}
PPSMA.ThinFieldListItemSelectedEventArgs.prototype={itemUniqueName:null,itemCaption:null,itemIsSelected:false}
PPSMA.ThinFieldList=function(olapViewContext,multiSelect,displayKpis){this.$12=new Sys.EventHandlerList();this.$0=olapViewContext;this.$2=false;this.$3=false;this.$0.get_measures().set_ctrlProxyId(this.$0.get_ctrlProxyId());this.$0.get_measures().set_multiSelectEnabled(multiSelect);this.$0.get_measures().set_displayKpis(displayKpis);this.$0.get_measures().set_resourcePath(this.$0.get_resourcePath());this.$5=this.$0.get_ctrlProxyId()+'_ThinFieldListDiv';this.$6=this.$0.get_ctrlProxyId()+'_ULDisplayObjects';}
PPSMA.ThinFieldList.prototype={$0:null,$1:null,$2:false,$3:false,$4:null,$5:null,$6:null,resize:function(ulDivHeight,measureGroupcomboBoxWidth){var $0=$get('_ScrollList');if($0){$0.style.height=ulDivHeight.toString()+'px';}this.$0.get_measures().resize(measureGroupcomboBoxWidth);},showInChangeMeasure:function(){this.show(null,$get('flId'));},show:function(currCell,parentElement){this.$1=currCell;this.$4=parentElement;this.$1D(this.$0.get_results());this.$22();if(!this.$0.get_measureData()){this.$0.getMeasureGroups(Function.createDelegate(this,this.$19));}else{this.$19(true);}},reOrderItem:function(uniqueName,newOrderIndex){if(!this.$3){return false;}var $0=this.$0.get_measures().getObjectByName(uniqueName);if($0){return (this.$0.get_measures().setQueryOrder($0,newOrderIndex,this.$0.get_ctrlProxyId()));}return false;},deSelectItem:function(uniqueName){if(!this.$3){return false;}var $0=this.$0.get_measures().getObjectByName(uniqueName);if(this.$0.get_measures().deSelectObject($0)){this.$0.get_measures().set_selectedCount(this.$0.get_measures().get_selectedCount()-1);return true;}else{return false;}},get_measuresLoaded:function(){return this.$3;},add_itemSelected:function(value){this.$12.addHandler('__ItemSelected__',value);},remove_itemSelected:function(value){this.$12.removeHandler('__ItemSelected__',value);},add_resizeOnDataLoaded:function(value){this.$12.addHandler('__ResizeOnDataLoaded__',value);},remove_resizeOnDataLoaded:function(value){this.$12.removeHandler('__ResizeOnDataLoaded__',value);},$17:function($p0,$p1,$p2){var $0=this.$12.getHandler('__ItemSelected__');if($0){$0(this,new PPSMA.ThinFieldListItemSelectedEventArgs($p0,$p1,$p2));}},$18:function(){var $0=this.$12.getHandler('__ResizeOnDataLoaded__');if($0){$0();}},$19:function($p0){this.$3=false;if(this.$0.get_measureData()&&$p0){this.$3=this.$1F();if(!this.$3){this.$24();}else{this.$18();this.$0.notifyBrowserOfAsyncUpdate($get('_ScrollList'));}}else{this.$24();}},$1A:function($p0){var $0=PPSMA.EventsEx.getCurrentElement($p0.rawEvent);if(!$0){return;}var $1=$0.parentNode;var $2=this.$0.get_measures().findMeasureOrKpiByID($1.id);if(!$2){alert('Error. Unknown object was selected.');return;}var $3;var $4='';var $5=false;if(Object.getType($2).getName()==='PPSMA.Measure'){$3=!$2.get_selected();}else{$5=($2).get_selected();$4=this.$0.get_measures().findKpiComponentID($1.id);$3=!($2).isComponentSelected($4);}if((!this.$0.get_measures().get_multiSelectEnabled())&&($3)){for(var $6=0;$6<this.$0.get_measures().get_selectedCount();$6++){var $7=this.$0.get_measures().getSelectedMeasureOrKpiByOrder($6);if($7){this.$17($7.get_name(),$7.get_caption(),false);break;}}}else if((this.$0.get_measures().get_multiSelectEnabled())&&($5)&&($3)){this.$17($2.get_name(),$2.get_caption(),false);}this.$17($2.get_name(),$2.get_caption(),$3);this.$0.get_measures().componentClicked($2,$1,$4,$3);},apply:function(e){if(this.$2){var $0=$get(this.$0.get_ctrlProxyId()+'_ThinFieldListDiv');$0.style.display='none';this.$1B();this.$0.applyMeasureSelectorChanges();}},cancel:function(e){if(this.$2){var $0=$get(this.$0.get_ctrlProxyId()+'_ThinFieldListDiv');if($0){$0.style.display='none';}this.$1B();}},$1B:function(){this.$2=false;},$1C:function($p0){var $0=($p0+'_propApply_');var $1=$get($0);if($1){Sys.UI.DomEvent.addHandler($1,'click',Function.createDelegate(this,this.apply));}$0=($p0+'_propCancel_');$1=$get($0);if($1){Sys.UI.DomEvent.addHandler($1,'click',Function.createDelegate(this,this.cancel));}},$1D:function($p0){var $0=false;for(var $1=0;$1<$p0.get_rowHierarchies().length;$1++){if($p0.get_rowHierarchies()[$1].get_name()===this.$0.get_measureHierarchyName()){var $2=$p0.get_rowMembers();if($2){for(var $3=0;$3<$2.length;$3++){this.$17($2[$3][$1].get_name(),$2[$3][$1].get_caption(),true);if(!this.$0.get_measures().get_multiSelectEnabled()){return;}$0=true;}}}}if($0){return;}for(var $4=0;$4<$p0.get_columnHierarchies().length;$4++){if($p0.get_columnHierarchies()[$4].get_name()===this.$0.get_measureHierarchyName()){var $5=$p0.get_columnMembers();if($5){for(var $6=0;$6<$5.length;$6++){this.$17($5[$6][$4].get_name(),$5[$6][$4].get_caption(),true);if(!this.$0.get_measures().get_multiSelectEnabled()){return;}$0=true;}}}}if($0){return;}if(0===$p0.get_rowHierarchies().length||0===$p0.get_columnHierarchies().length){return;}for(var $7=0;$7<$p0.get_filterHierarchies().length;$7++){if($p0.get_filterHierarchies()[$7].get_name()===this.$0.get_measureHierarchyName()){var $8=$p0.get_filterMembers();if($8){this.$17($8[$7].get_name(),$8[$7].get_caption(),true);if(!this.$0.get_measures().get_multiSelectEnabled()){return;}}}}},$1E:function(){var $0=true;var $1=this.$0.get_ctrlProxyId();var $2=$get($1+'_ThinFieldListDiv');if($2){if(!this.$4){document.body.removeChild($2);}else{this.$4.removeChild($2);}this.$1C($1);$0=false;}$2=document.createElement('div');$2.id=this.$5;$2.style.margin='0px';$2.setAttribute('tabIndex','-1');var $3=document.createElement('div');$3.id=this.$0.get_ctrlProxyId()+'MeasureGroupsDropDownSelectWrapperDiv';var $4;if(!this.$4){$2.className='chgMeasTflMainDiv';$2.setAttribute('style','left:0px; top:0px; display:none; display: none;');$4=this.$0.get_measures().writeMeasureGroupComboBoxHtml(210-2);}else{$4=this.$0.get_measures().writeMeasureGroupComboBoxHtml(-1);}$3.appendChild($4);$2.appendChild($3);var $5=document.createElement('div');$5.id='_ScrollList';$5.style.overflow='auto';$5.style.position='relative';$5.setAttribute('tabIndex','-1');var $6=document.createElement('ul');$6.id=this.$6;$6.className='chgMeasTflListItems';$2.appendChild($5);$5.appendChild($6);if(!this.$4){var $7=document.createElement('div');$7.id=this.$0.get_ctrlProxyId()+'_MeasureGroupsFooter';$7.className='chgMeasTflFooter';var $8=document.createElement('A');$8.id=this.$0.get_ctrlProxyId()+'_propApply_';$8.className='chgMeasTflApply';$8.innerHTML=PPSMA.SR.OlapPropertiesDialog_Apply;var $9=document.createElement('A');$9.id=this.$0.get_ctrlProxyId()+'_propCancel_';$9.className='chgMeasTflCancel';$9.innerHTML=PPSMA.SR.OlapPropertiesDialog_Cancel;$7.appendChild($8);$7.appendChild($9);$2.appendChild($7);}if(!this.$4){document.body.appendChild($2);}else{this.$4.appendChild($2);}this.$1C($1);return $0;},$1F:function(){this.$23();this.$1E();var $0=$get(this.$0.get_ctrlProxyId()+'_ULDisplayObjects');if((this.$0.get_measureData())&&(!this.$0.get_measures().get_haveData())){var $1=PPSMA.XmlEx.loadXml(this.$0.get_measureData());var $2=this.$0.get_measures().loadMeasuresFromXml($1);}if(!this.$0.get_measures()){alert('Measures is null');return false;}this.$0.get_measures().setSelectedMeasuresFromResults(this.$0.get_results());this.$0.get_measures().writeMeasureGroupComboBoxContents();if(this.$0.get_measures().get_displayObjectCount()>0){var $3=20;if(!getBrowserIs().ie55up){$3=23;}if(!this.$4){var $5;if(this.$0.get_measures().get_displayObjectCount()<10){$5=(this.$0.get_measures().get_displayObjectCount()*20)+2-$3;$0.style.height=$5+'px';$0.style.overflow='hidden';}else{$5=202-$3;$0.style.height=$5+'px';$0.style.overflow='auto';}}var $4=$get(this.$0.get_ctrlProxyId()+'_ThinFieldListDiv');if(!$4){return false;}if(!this.$4){$4.style.width=''+210+'px';$4.style.height=''+202+'px';$4.style.left='0px';$4.style.top='0px';}else{$4.style.display='block';}if(!this.$4){this.$21($4,202+40+$3);}this.$0.get_measures().writeDivOutputHtml($0,Function.createDelegate(this,this.$1A));this.$20($0);if(!this.$4){if(this.$0.get_measures().get_labelOffsetWidth()>210){$4.style.width=(this.$0.get_measures().get_labelOffsetWidth()+30)+'px';var $6=$get('MeasureGroupsDropDownSelect');if($6){$6.style.width=(this.$0.get_measures().get_labelOffsetWidth()+(30-2))+'px';}}}}else{return false;}this.$2=true;return true;},$20:function($p0){var $0=$p0.getElementsByTagName('a');for(var $1=0;$1<$0.length;$1++){var $2=$0[$1];if($2.className==='chgMeasExCoA'){Sys.UI.DomEvent.addHandler($2,'click',Function.createDelegate(this.$0.get_measures(),this.$0.get_measures().handleExpandCollapseClick));}}},$21:function($p0,$p1){var $0=PPSMA.SizeEx.getAbsoluteTop(this.$1);var $1=PPSMA.SizeEx.getAbsoluteLeft(this.$1);var $2=this.$1.offsetWidth;var $3=this.$1.offsetHeight;var $4=PPSMA.SizeEx.getClientHeight();if(($0+$p1)>$4){$0-=$p1;if($0<0){$0=0;}}var $5=PPSMA.SizeEx.getClientWidth();if(($1+225)>$5){$1=($5-225);if($1<0){$1=0;}}var $6=0;var $7=0;var $8=$get(this.$0.get_innerTargetId());if($8){$6=$8.scrollLeft;$7=$8.scrollTop;}$p0.style.left=($1+$2-$6-10)+'px';$p0.style.top=($0+$3-$7-10)+'px';},$22:function(){var $0=document.createElement('div');$0.id=this.$0.get_ctrlProxyId()+'_ThinFieldListLoadingDiv';if($0){$0.style.display='block';$0.style.fontSize='8pt';$0.style.fontFamily='Tahoma';$0.innerHTML=PPSMA.SR.OlapContextMenu_DynamicLoadText;if(!this.$4){this.$21($0,202);document.body.appendChild($0);}else{this.$4.appendChild($0);}}},$23:function(){var $0=$get(this.$0.get_ctrlProxyId()+'_ThinFieldListLoadingDiv');if($0){if(!this.$4){document.body.removeChild($0);}else{this.$4.removeChild($0);}}},$24:function(){var $0=$get(this.$0.get_ctrlProxyId()+'_ThinFieldListLoadingDiv');if($0){$0.innerHTML=PPSMA.SR.OlapContextMenu_ErrorLoadingMeasures;}}}
PPSMA.BaseMeasureKpi=function(){}
PPSMA.BaseMeasureKpi.prototype={_resourcePath:null,_uniqueName:null,_displayCaption:null,_measureGroup:null,_hierarchyName:null,_description:null,_isVisible:false,_order:0,_index:0,$0:0,get_resourcePath:function(){return this._resourcePath;},set_resourcePath:function(value){this._resourcePath=value;return value;},get_visible:function(){return this._isVisible;},set_visible:function(value){this._isVisible=value;return value;},get_name:function(){return this._uniqueName;},set_name:function(value){this._uniqueName=value;return value;},get_index:function(){return this._index;},set_index:function(value){this._index=value;return value;},get_caption:function(){return this._displayCaption;},set_caption:function(value){this._displayCaption=value;return value;},get_measureGroupName:function(){return this._measureGroup;},set_measureGroupName:function(value){this._measureGroup=value;return value;},get_description:function(){return this._description;},set_description:function(value){this._description=value;return value;},get_order:function(){return this._order;},set_order:function(value){this._order=value;return value;},get_axisHierarchy:function(){return this._hierarchyName;},set_axisHierarchy:function(value){this._hierarchyName=value;return value;},get_offsetWidth:function(){return this.$0;},set_offsetWidth:function(value){this.$0=value;return value;}}
PPSMA.Kpi=function(){PPSMA.Kpi.initializeBase(this);this._isVisible=true;this.$5=true;this.$6=new Array(4);for(var $0=0;$0<4;$0++){this.$6[$0]=false;}}
PPSMA.Kpi.prototype={$1:null,$2:null,$3:null,$4:null,$5:false,$6:null,get_selected:function(){for(var $0=0;$0<4;$0++){if(this.$6[$0]){return true;}}return false;},set_selected:function(value){if(!value){for(var $0=0;$0<4;$0++){this.$6[$0]=false;}}return value;},get_expanded:function(){return this.$5;},set_expanded:function(value){this.$5=value;return value;},get_uniqueId:function(){return ('_kli'+'_K'+this._index.toString());},get_value:function(){return this.$1;},set_value:function(value){this.$1=value;return value;},get_goal:function(){return this.$2;},set_goal:function(value){this.$2=value;return value;},get_status:function(){return this.$3;},set_status:function(value){this.$3=value;return value;},get_trend:function(){return this.$4;},set_trend:function(value){this.$4=value;return value;},isComponentSelected:function(componentName){var $0=this.$D(componentName);if(($0<0)||($0>=4)){return false;}return this.$6[$0];},writeDivOutputHtml:function(ctrlProxyId,ulBody,padding,folderId,parentClickHandler,componentClickHandler){var $0=PPSMA.Measures.getKpiUniqueID(this,ctrlProxyId)+'_F'+folderId.toString();var $1=padding.toString()+'px';var $2=document.createElement('li');var $3=document.createElement('a');var $4=document.createElement('img');$2.id=$0;$2.className='chgMeasTflListItem';$2.style.listStyleType='none';$3.setAttribute('href','#');Sys.UI.DomEvent.addHandler($3,'mouseup',parentClickHandler);$4.setAttribute('alt',PPSMA.SR.OlapChangeMeasure_CollapseKpi);$4.setAttribute('src',this.get_resourcePath()+'pps_minus_stoplight.gif');$4.setAttribute('border','0px');$3.appendChild($4);$2.appendChild($3);var $5=window.document.createTextNode(this._displayCaption);$2.appendChild($5);ulBody.appendChild($2);this.set_offsetWidth($2.offsetWidth);var $6=document.createElement('ul');if(this.$2){this.$E(ctrlProxyId,$6,$0,'Goal',PPSMA.SR.OlapChangeMeasure_KpiGoal,(padding+0),componentClickHandler);}if(this.$1){this.$E(ctrlProxyId,$6,$0,'Value',PPSMA.SR.OlapChangeMeasure_KpiValue,(padding+0),componentClickHandler);}if(this.$3){this.$E(ctrlProxyId,$6,$0,'Status',PPSMA.SR.OlapChangeMeasure_KpiStatus,(padding+0),componentClickHandler);}if(this.$4){this.$E(ctrlProxyId,$6,$0,'Trend',PPSMA.SR.OlapChangeMeasure_KpiTrend,(padding+0),componentClickHandler);}$6.style.display='block';$2.appendChild($6);return true;},setVisibility:function(ctrlProxyId,folderId){var $0=PPSMA.Measures.getKpiUniqueID(this,ctrlProxyId)+'_F'+folderId.toString();var $1=$get($0);if(!$1){return false;}if(!this._isVisible){$1.style.display='none';return false;}else{$1.style.display='block';return true;}},expandCollapse:function(kpiElem){this.$F(kpiElem,!this.$5);},setInputElemCheckValue:function(ctrlProxyId,inputElem,folderId,component,isChecked){var $0=PPSMA.Measures.getKpiUniqueID(this,ctrlProxyId)+'_F'+folderId.toString();var $1=$get($0);if($1){var $2=$1.getElementsByTagName('input');var $3=-1;if(component!==''){$3=this.$D(component);if(($3<0)||($3>=4)){return;}var $4=$2[$3];if($4!==inputElem){($4).checked=isChecked;}this.$6[$3]=isChecked;}if((isChecked)||((!isChecked)&&(component===''))){for(var $5=0;$5<$2.length;$5++){var $6=$2[$5];if(($5!==$3)&&($6!==inputElem)){($6).checked=false;this.$6[$5]=false;}}}}},$D:function($p0){if($p0==='Goal'){return 0;}else if($p0==='Value'){return 1;}else if($p0==='Status'){return 2;}else if($p0==='Trend'){return 3;}else{return -1;}},$E:function($p0,$p1,$p2,$p3,$p4,$p5,$p6){var $0=$p5.toString()+'px';var $1=this._displayCaption;if((this._description)&&(this._description.length>0)){$1+=' (';$1+=this._description;$1+=')';}var $2=$p2+'_'+$p3;var $3=document.createElement('li');var $4=document.createElement('input');var $5=document.createElement('label');$3.id=$2;$3.className='chgMeasTflListItem';$3.style.listStyleType='none';$3.setAttribute('title',$1);$4.setAttribute('type','checkbox');$4.className='chgMeasTflListCheckBox';$4.setAttribute('title',$1);$4.setAttribute('title',$1);$4.style.cursor='hand';$4.setAttribute('value',$p3);Sys.UI.DomEvent.addHandler($4,'click',$p6);$5.style.cursor='hand';Sys.UI.DomEvent.addHandler($5,'mouseup',$p6);var $6=window.document.createTextNode($p4);$3.appendChild($4);$3.appendChild($5);$5.appendChild($6);$p1.appendChild($3);this.set_offsetWidth($6.offsetWidth);},$F:function($p0,$p1){var $0=$p0.getElementsByTagName('ul');var $1=$0[0];if(!$1){return;}if(!$p1){$1.style.display='none';var $2=$p0.getElementsByTagName('img');var $3=$2[0];if($3){$3.setAttribute('alt',PPSMA.SR.OlapChangeMeasure_ExpandKpi);$3.setAttribute('src',this.get_resourcePath()+'pps_plus_stoplight.gif');}}else{$1.style.display='block';var $4=$p0.getElementsByTagName('img');var $5=$4[0];if($5){$5.setAttribute('alt',PPSMA.SR.OlapChangeMeasure_CollapseKpi);$5.setAttribute('src',this.get_resourcePath()+'pps_minus_stoplight.gif');}}this.$5=$p1;}}
PPSMA.Measure=function(){PPSMA.Measure.initializeBase(this);this._isVisible=true;this.$1=false;this._order=-1;}
PPSMA.Measure.prototype={$1:false,get_uniqueId:function(){return ('_mli'+'_M'+this._index.toString());},get_selected:function(){return this.$1;},set_selected:function(value){this.$1=value;return value;},writeDivOutputHtml:function(ctrlProxyId,ulBody,padding,folderId,parentClickHandler,componentClickHandler){var $0=PPSMA.Measures.getMeasureUniqueID(this,ctrlProxyId)+'_F'+folderId.toString();if(!ulBody.id.endsWith('_ULDisplayObjects')){ulBody.style.paddingLeft='20px';}else{ulBody.style.paddingLeft='0px';}var $1=this._displayCaption;if((this._description)&&(this._description.length>0)){$1+=' (';$1+=this._description;$1+=')';}var $2=document.createElement('li');var $3=document.createElement('input');var $4=document.createElement('label');$2.setAttribute('id',$0);$2.className='chgMeasTflListItem';$2.style.listStyleType='none';$2.setAttribute('title',$1);$3.setAttribute('title',$1);$3.setAttribute('type','checkbox');$3.className='chgMeasTflListCheckBox';$3.setAttribute('title',$1);$3.style.cursor='hand';$3.setAttribute('value',this._uniqueName);Sys.UI.DomEvent.addHandler($3,'click',componentClickHandler);$4.style.cursor='hand';Sys.UI.DomEvent.addHandler($4,'mouseup',componentClickHandler);var $5=window.document.createTextNode(this._displayCaption);$2.appendChild($3);$2.appendChild($4);$4.appendChild($5);$4.style.paddingTop='2px';$4.style.paddingLeft='4px';$4.style.position='absolute';ulBody.appendChild($2);if(this.$1){($3).checked=true;}this.set_offsetWidth($5.offsetWidth);return true;},setVisibility:function(ctrlProxyId,folderId){var $0=PPSMA.Measures.getMeasureUniqueID(this,ctrlProxyId)+'_F'+folderId.toString();var $1=$get($0);if(!$1){return false;}if(!this._isVisible){$1.style.display='none';return false;}else{$1.style.display='block';return true;}},setInputElemCheckValue:function(ctrlProxyId,inputElem,folderId,componentId,isChecked){var $0=PPSMA.Measures.getMeasureUniqueID(this,ctrlProxyId)+'_F'+folderId.toString();var $1=$get($0);if($1){var $2=$1.getElementsByTagName('input');var $3=$2[0];if($3!==inputElem){($3).checked=isChecked;}}this.$1=isChecked;}}
PPSMA.Folder=function(name,level,index){this.$5=true;this.$3=level;this.$2=name;this.$6=index;this.$0=[];this.$1=[];}
PPSMA.Folder.addFolders=function(folders,folderList,measure_or_kpi,level,resourcePath){if((!folderList)||(!folderList.length)){return null;}var $0=null;var $1=[];var $2=folderList.split(';');if($2.length>1){for(var $7=0;$7<$2.length;$7++){$0=PPSMA.Folder.addFolders(folders,$2[$7],measure_or_kpi,level,resourcePath);if($0){for(var $8=0;$8<$0.length;$8++){Array.add($1,$0[$8]);}}}return $1;}var $3=folderList.split('\\');if(!$3.length){return null;}var $4=PPSMA.Folder.getChildFolder(folders,$3[0],-1);if(!$4){$4=new PPSMA.Folder($3[0],level,++PPSMA.Measures.folderCount);$4.set_resourcePath(resourcePath);Array.add(folders,$4);}Array.add($1,$4);if($3.length===1){var $9=Object.getType(measure_or_kpi);if($9.getName()==='PPSMA.Measure'){$4.addMeasure(measure_or_kpi);}else if($9.getName()==='PPSMA.Kpi'){$4.addKpi(measure_or_kpi);}return $1;}var $5=folderList.indexOf('\\');var $6=folderList.substring(($5+1),folderList.length);$0=PPSMA.Folder.addFolders($4.get_childrenFolders(),$6,measure_or_kpi,(level+1),resourcePath);if($0){for(var $A=0;$A<$0.length;$A++){if(!PPSMA.Folder.folderIsAlreadyInDisplay($4.get_childrenFolders(),$0[$A])){Array.add($4.get_childrenFolders(),$0[$A]);}}}return $1;}
PPSMA.Folder.getChildFolder=function(folders,folderName,folderIndex){for(var $0=0;$0<folders.length;$0++){var $1=folders[$0];if(folderIndex===-1){if($1.get_name()===folderName){return $1;}}else if($1.get_index()===folderIndex){return $1;}}for(var $2=0;$2<folders.length;$2++){var $3=folders[$2];var $4=PPSMA.Folder.getChildFolder($3.get_childrenFolders(),folderName,folderIndex);if($4){return $4;}}return null;}
PPSMA.Folder.folderIsAlreadyInDisplay=function(folders,folder){for(var $0=0;$0<folders.length;$0++){var $1=folders[$0];var $2=Object.getType($1);if($2.getName()==='PPSMA.Folder'){var $3=$1;if($3.get_name()===folder.get_name()){return true;}}}return false;}
PPSMA.Folder.prototype={$0:null,$1:null,$2:null,$3:0,$4:0,$5:false,$6:0,$7:null,get_resourcePath:function(){return this.$7;},set_resourcePath:function(value){this.$7=value;return value;},get_expanded:function(){return this.$5;},set_expanded:function(value){this.$5=value;return value;},get_index:function(){return this.$6;},set_index:function(value){this.$6=value;return value;},get_uniqueId:function(){return ('_fli_'+'F'+this.$6);},get_offsetWidth:function(){return this.$4;},set_offsetWidth:function(value){this.$4=value;return value;},get_childrenFolders:function(){return this.$0;},get_name:function(){return this.$2;},get_level:function(){return this.$3;},expandCollapse:function(folderElem){this.$D(folderElem,!this.$5);},writeDivOutputHtml:function(ctrlProxyId,ulBody,padding,kpiClickFunc,componentInputClickFunc){var $0=PPSMA.Measures.getFolderUniqueID(this,ctrlProxyId);var $1=document.createElement('li');var $2=document.createElement('a');var $3=document.createElement('img');var $4=document.createElement('img');$4.setAttribute('src',this.get_resourcePath()+'folder.gif');$1.setAttribute('id',$0);$1.className='chgMeasTflListItem';$1.style.listStyleType='none';$1.style.paddingTop='3px';$2.setAttribute('href','#');$2.className='chgMeasExCoA';$3.className='chgMeasExCoImg';$4.className='chgMeasFolderImg';$2.appendChild($3);$1.appendChild($2);$1.appendChild($4);var $5=document.createElement('span');$5.style.textIndent='0px';$5.style.position='absolute';$5.style.paddingTop='1px';$5.style.paddingRight='2px';$5.style.paddingBottom='2px';$5.style.paddingLeft='5px';$1.appendChild($5);ulBody.appendChild($1);if(!ulBody.id.endsWith('_ULDisplayObjects')){ulBody.style.paddingLeft='20px';}else{ulBody.style.paddingLeft='0px';}this.set_offsetWidth($1.offsetWidth);var $6=false;var $7=document.createElement('ul');for(var $8=0;$8<this.$1.length;$8++){if(Object.getType(this.$1[$8]).getName()!=='PPSMA.Folder'){(this.$1[$8]).writeDivOutputHtml(ctrlProxyId,$7,(padding+10),this.$6,kpiClickFunc,componentInputClickFunc);if((this.$1[$8]).get_selected()){$6=true;}}}for(var $9=0;$9<this.$0.length;$9++){var $A=this.$0[$9];var $B=(this.$3+1);if($A.writeDivOutputHtml(ctrlProxyId,$7,(padding+10),kpiClickFunc,componentInputClickFunc)){$6=true;}}$1.appendChild($7);if($6){var $C=document.createElement('B');$5.appendChild($C);var $D=window.document.createTextNode(this.$2);$C.appendChild($D);$3.setAttribute('alt',String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$2));$3.setAttribute('title',String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$2));$3.setAttribute('src',this.get_resourcePath()+'minus.gif');$7.style.display='block';this.$5=true;}else{var $E=window.document.createTextNode(this.$2);$5.appendChild($E);$3.setAttribute('alt',String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$2));$3.setAttribute('title',String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$2));$3.setAttribute('src',this.get_resourcePath()+'plus.gif');$7.style.display='none';this.$5=false;}return $6;},addMeasure:function(measure){if(!Array.contains(this.$1,measure)){Array.add(this.$1,measure);}},addKpi:function(kpi){if(!Array.contains(this.$1,kpi)){Array.add(this.$1,kpi);}},sortDisplayObjects:function(){for(var $0=0;$0<this.$1.length;$0++){for(var $1=0;$1<this.$1.length;$1++){var $2=this.$1[$0];var $3=this.$1[$1];if($2.get_caption().localeCompare($3.get_caption())<0){var $4=this.$1[$1];this.$1[$1]=this.$1[$0];this.$1[$0]=$4;(this.$1[$1]).set_index($2.get_index());(this.$1[$0]).set_index($3.get_index());}}}for(var $5=0;$5<this.$0.length;$5++){for(var $6=0;$6<this.$0.length;$6++){var $7=this.$0[$5];var $8=this.$0[$6];if($7.get_name().localeCompare($8.get_name())<0){var $9=this.$0[$6];this.$0[$6]=this.$0[$5];this.$0[$5]=$9;}}}},setMeasuresVisibility:function(ctrlProxyId){var $0=false;for(var $1=0;$1<this.$1.length;$1++){var $2=this.$1[$1];if($2.setVisibility(ctrlProxyId,this.$6)){$0=true;}}for(var $3=0;$3<this.$0.length;$3++){var $4=this.$0[$3];if($4.setMeasuresVisibility(ctrlProxyId)){$0=true;}}this.$E(ctrlProxyId,$0);return $0;},$C:function($p0,$p1){var $0=PPSMA.Measures.getFolderUniqueID(this,$p0);var $1=$get($0);var $2=$1.getElementsByTagName('span');var $3=$2[0];if($3){while($3.childNodes.length>0){$3.removeChild($3.childNodes[0]);}if($p1){var $4=document.createElement('B');$3.appendChild($4);var $5=window.document.createTextNode(this.$2);$4.appendChild($5);}else{var $6=window.document.createTextNode(this.$2);$3.appendChild($6);}}},setInputElemCheckValue:function(obj,inputElem,ctrlProxyId,component,isChecked){if(Array.contains(this.$1,obj)){obj.setInputElemCheckValue(ctrlProxyId,inputElem,this.$6,component,isChecked);}for(var $0=0;$0<this.$0.length;$0++){(this.$0[$0]).setInputElemCheckValue(obj,inputElem,ctrlProxyId,component,isChecked);}this.checkForSelectedMeasuresAndKpis(ctrlProxyId);},checkForSelectedMeasuresAndKpis:function(ctrlProxyId){var $0=false;for(var $1=0;$1<this.$1.length;$1++){var $2=this.$1[$1];if($2.get_selected()){$0=true;}}for(var $3=0;$3<this.$0.length;$3++){var $4=this.$0[$3];if($4.checkForSelectedMeasuresAndKpis(ctrlProxyId)){$0=true;}}this.$C(ctrlProxyId,$0);return $0;},$D:function($p0,$p1){var $0=$p0.getElementsByTagName('ul');var $1=$0[0];if(!$1){return;}var $2=$p0.getElementsByTagName('img');var $3=$2[0];if($3){if(!$1.id.endsWith('_ULDisplayObjects')){$1.style.paddingLeft='20px';}else{$1.style.paddingLeft='0px';}if(!$p1){$1.style.display='none';$3.setAttribute('alt',String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$2));$3.setAttribute('title',String.format(PPSMA.SR.OlapChangeMeasure_ExpandFolder,this.$2));$3.setAttribute('src',this.get_resourcePath()+'plus.gif');}else{$1.style.display='block';$3.setAttribute('alt',String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$2));$3.setAttribute('title',String.format(PPSMA.SR.OlapChangeMeasure_CollapseFolder,this.$2));$3.setAttribute('src',this.get_resourcePath()+'minus.gif');}}this.$5=$p1;},$E:function($p0,$p1){var $0=PPSMA.Measures.getFolderUniqueID(this,$p0);var $1=$get($0);if(!$1){return false;}if(!$p1){$1.style.display='none';return false;}else{$1.style.display='block';return true;}}}
PPSMA.Measures=function(){this.$D=null;this.$5='none';this.$2=0;this.$3=0;this.$4=0;this.$6=[];this.$7=[];this.$8=[];this.$C=false;this.$B=true;}
PPSMA.Measures.getMeasureUniqueID=function(measure,ctrlProxyId){if(!measure){return '';}return (ctrlProxyId+measure.get_uniqueId());}
PPSMA.Measures.getKpiUniqueID=function(kpi,ctrlProxyId){if(!kpi){return '';}return (ctrlProxyId+kpi.get_uniqueId());}
PPSMA.Measures.getFolderUniqueID=function(folder,ctrlProxyId){if(!folder){return '';}return (ctrlProxyId+folder.get_uniqueId());}
PPSMA.Measures.prototype={$0:null,$1:null,$2:0,$3:0,$4:0,$5:null,$6:null,$7:null,$8:null,$9:0,$A:null,$B:false,$C:false,$D:null,$E:null,$F:null,$10:null,$11:null,get_resourcePath:function(){return this.$10;},set_resourcePath:function(value){this.$10=value;return value;},get_ctrlProxyId:function(){return this.$A;},set_ctrlProxyId:function(value){this.$A=value;return value;},get_multiSelectEnabled:function(){return this.$B;},set_multiSelectEnabled:function(value){this.$B=value;return value;},get_displayKpis:function(){return this.$C;},set_displayKpis:function(value){this.$C=value;return value;},get_selectedCount:function(){return this.$3;},set_selectedCount:function(value){this.$3=value;return value;},get_measureCount:function(){return this.$2;},get_haveData:function(){if((this.$2>0)||(this.$4>0)){return true;}else{return false;}},get_kpiCount:function(){return this.$4;},get_measureGroupName:function(){if((this.$11)&&(this.$11!=='_ALL_')){return this.$11;}else{return '';}},set_measureGroupName:function(value){this.$11=value;return value;},get_axis:function(){return this.$5;},get_displayObjectCount:function(){return this.$8.length;},get_hierarchyCount:function(){return this.$6.length;},get_labelOffsetWidth:function(){return this.$9;},getDisplayObject:function(index){if((index>=0)&&(index<this.$8.length)){return this.$8[index];}return null;},findMeasureOrKpiByID:function(elemId){var $0=this.findMeasureByID(elemId);if($0){return $0;}$0=this.findKpiByID(elemId);if($0){return $0;}return null;},findMeasureByID:function(measureElemId){if(!this.$0){return null;}var $0=measureElemId.indexOf('_F');var $1=measureElemId.substr(0,$0);for(var $2=0;$2<this.$0.length;$2++){var $3=(this.$A+this.$0[$2].get_uniqueId());if($3===$1){return this.$0[$2];}}return null;},findKpiComponentID:function(kpiComponentElemId){if(!this.$C){return '';}var $0=kpiComponentElemId.indexOf('_F');var $1=kpiComponentElemId.substr(0,$0);var $2=kpiComponentElemId.indexOf('_',($0+2));return (kpiComponentElemId.substr(($2+1),kpiComponentElemId.length));},findKpiByID:function(kpiElemId){if((!this.$C)||(!this.$1)){return null;}var $0=kpiElemId.indexOf('_F');var $1=kpiElemId.substr(0,$0);for(var $2=0;$2<this.$1.length;$2++){var $3=(this.$A+this.$1[$2].get_uniqueId());if($3===$1){return this.$1[$2];}}return null;},findFolderByID:function(folderElemId){var $0=folderElemId.indexOf('_F');var $1=folderElemId.substring(($0+2),folderElemId.length);var $2=parseInt($1);return (PPSMA.Folder.getChildFolder(this.$7,'',$2));},setQueryOrder:function(obj,order,ctrlProxyId){if(!this.$0){return false;}if(!obj){return false;}if(!obj.get_selected()){return false;}if(obj.get_order()===order){return false;}if(obj.get_order()<order){for(var $0=(obj.get_order()+1);$0<=order;$0++){var $1=this.getSelectedMeasureOrKpiByOrder($0);if($1){$1.set_order(($0-1));}}}else{for(var $2=(obj.get_order()-1);$2>=order;$2--){var $3=this.getSelectedMeasureOrKpiByOrder($2);if($3){$3.set_order(($2+1));}}}obj.set_order(order);return true;},getSelectedMeasureOrKpiByOrder:function(orderIndex){var $0=this.getSelectedMeasureByOrder(orderIndex);if($0){return $0;}$0=this.getSelectedKpiByOrder(orderIndex);if($0){return $0;}return null;},getSelectedMeasureByOrder:function(orderIndex){for(var $0=0;$0<this.$0.length;$0++){if((this.$0[$0].get_selected())&&(this.$0[$0].get_order()===orderIndex)){return this.$0[$0];}}return null;},getSelectedKpiByOrder:function(orderIndex){if((!this.$C)||(!this.$1)){return null;}for(var $0=0;$0<this.$1.length;$0++){if((this.$1[$0].get_selected())&&(this.$1[$0].get_order()===orderIndex)){return this.$1[$0];}}return null;},getObjectByName:function(uniqueName){if(!this.$0){return null;}var $0=this.getMeasureByName(uniqueName);if($0){return $0;}var $1=this.getKpiByName(uniqueName);if($1){return $1;}return null;},getMeasureByName:function(uniqueName){for(var $0=0;$0<this.$0.length;$0++){if(this.$0[$0].get_name()===uniqueName){return this.$0[$0];}}return null;},getKpiByName:function(uniqueName){if((!this.$C)||(!this.$1)){return null;}for(var $0=0;$0<this.$1.length;$0++){if(this.$1[$0].get_name()===uniqueName){return this.$1[$0];}}return null;},getMeasure:function(index){if(!this.$2){return null;}for(var $0=0;$0<this.$0.length;$0++){if(this.$0[$0].get_index()===index){return this.$0[$0];}}return null;},getKpi:function(index){if(!this.$4){return null;}for(var $0=0;$0<this.$1.length;$0++){if(this.$1[$0].get_index()===index){return this.$1[$0];}}return null;},getHierarchyName:function(index){if((index<0)||(index>=this.$6.length)){return '';}return this.$6[index].toString();},measureGroupComboBoxClick:function(e){var $0=PPSMA.EventsEx.getCurrentElement(e.rawEvent);if(!$0){return;}var $1=$0.getElementsByTagName('option');for(var $2=0;$2<$1.length;++$2){var $3=$1[$2];if($3.selected){var $4=$3.id.substring('mg_'.length,$3.id.length);if($4!=='_ALL_'){$0.title=$4;}else{$0.title=PPSMA.SR.OlapChangeMeasure_AllMeasureGroups;}this.$12($4);this.$11=$4;break;}}},resize:function(width){var $0=$get(this.$A+'MeasureGroupsDropDownSelect');if($0){$0.style.width=width.toString()+'px';}},writeMeasureGroupComboBoxHtml:function(width){var $0=document.createElement('select');$0.id=this.$A+'MeasureGroupsDropDownSelect';if(getBrowserIs().ie55up){$0.style.height=20+'px';}else{$0.style.height=23+'px';}$0.style.left='2px';if(width!==-1){$0.style.width=width.toString()+'px';}$0.style.fontSize='8pt';$0.style.color='#000000';$0.style.fontFamily='Tahoma';Sys.UI.DomEvent.addHandler($0,'change',Function.createDelegate(this,this.measureGroupComboBoxClick));var $1=document.createElement('option');$1.id='mg_'+'_ALL_';$1.selected=true;$1.innerHTML=PPSMA.SR.OlapChangeMeasure_AllMeasureGroups;$0.title=PPSMA.SR.OlapChangeMeasure_AllMeasureGroups;$0.appendChild($1);return $0;},writeMeasureGroupComboBoxContents:function(){if(!this.$E){return;}if(this.$E.length>0){var $0=$get((this.$A+'MeasureGroupsDropDownSelect'));if($0){for(var $1=0;$1<this.$E.length;$1++){var $2=document.createElement('option');$2.id='mg_'+this.$E[$1];$2.innerHTML=this.$F[$1];$0.appendChild($2);if(this.$11===this.$E[$1]){$2.selected=true;$0.title=this.$F[$1];}}}}else{}},writeDivOutputHtml:function(ulBody,componentInputClickFunc){if(this.$C){if(!this.$D){this.$D=Function.createDelegate(this,this.$16);}}this.$17();this.$9=0;for(var $0=0;$0<this.$8.length;$0++){var $1=0;if(Object.getType(this.$8[$0]).getName()!=='PPSMA.Folder'){(this.$8[$0]).writeDivOutputHtml(this.$A,ulBody,0,0,this.$D,componentInputClickFunc);$1=(this.$8[$0]).get_offsetWidth();}else{var $2=this.$8[$0];$2.writeDivOutputHtml(this.$A,ulBody,0,this.$D,componentInputClickFunc);$1=$2.get_offsetWidth();}if($1>this.$9){this.$9=$1;}}if((this.$11)&&(this.$11!=='')){this.$12(this.$11);}},loadMeasuresFromXml:function(xdoc){if(!xdoc){return 0;}this.$13(xdoc);this.$14();this.$2=0;this.$4=0;if(xdoc.documentElement){this.$11=xdoc.documentElement.getAttribute('LastMeasureGroupName');}PPSMA.Measures.folderCount=0;var $0=xdoc.getElementsByTagName('Measure');if($0.length>0){Array.clear(this.$6);this.$0=new Array($0.length);if($0.length>0){for(var $1=0;$1<$0.length;$1++){this.$0[$1]=new PPSMA.Measure();this.$0[$1].set_name($0[$1].getAttribute('uniqueName'));this.$0[$1].set_caption($0[$1].getAttribute('caption'));this.$0[$1].set_index($1);this.$0[$1].set_resourcePath(this.get_resourcePath());var $2=PPSMA.Folder.addFolders(this.$7,this.$15($0[$1].getAttribute('displayFolder')),this.$0[$1],1,this.get_resourcePath());if($2){for(var $3=0;$3<$2.length;$3++){if(!PPSMA.Folder.folderIsAlreadyInDisplay(this.$8,$2[$3])){Array.add(this.$8,$2[$3]);}}}else{Array.add(this.$8,this.$0[$1]);}this.$0[$1].set_description($0[$1].getAttribute('description'));this.$0[$1].set_measureGroupName($0[$1].getAttribute('measureGroup'));this.$18(this.$0[$1],$0[$1].getAttribute('hierarchyName'));}}this.$2=$0.length;if(this.$C){var $4=xdoc.getElementsByTagName('Kpi');if($4.length>0){this.$1=new Array($4.length);for(var $5=0;$5<$4.length;$5++){this.$1[$5]=new PPSMA.Kpi();this.$1[$5].set_name($4[$5].getAttribute('uniqueName'));this.$1[$5].set_caption($4[$5].getAttribute('caption'));this.$1[$5].set_index($5);this.$1[$5].set_resourcePath(this.get_resourcePath());var $6=PPSMA.Folder.addFolders(this.$7,this.$15($4[$5].getAttribute('displayFolder')),this.$1[$5],1,this.get_resourcePath());if($6){for(var $7=0;$7<$6.length;$7++){if(!PPSMA.Folder.folderIsAlreadyInDisplay(this.$8,$6[$7])){Array.add(this.$8,$6[$7]);}}}else{Array.add(this.$8,this.$1[$5]);}this.$1[$5].set_value($4[$5].getAttribute('value'));this.$1[$5].set_goal($4[$5].getAttribute('goal'));this.$1[$5].set_status($4[$5].getAttribute('status'));this.$1[$5].set_trend($4[$5].getAttribute('trend'));this.$1[$5].set_description($4[$5].getAttribute('description'));this.$1[$5].set_measureGroupName($4[$5].getAttribute('measureGroup'));}}this.$4=$4.length;}}return (this.$2+this.$4);},setSelectedMeasuresFromResults:function(results){if(!this.$0){return;}for(var $1=0;$1<this.$0.length;$1++){this.$0[$1].set_selected(false);this.$0[$1].set_order(-1);}var $0=false;this.$3=0;for(var $2=0;$2<results.get_rowHierarchies().length;$2++){for(var $3=0;$3<this.$0.length;$3++){var $4=results.get_rowMembers();if($4){for(var $5=0;$5<$4.length;$5++){if(this.$0[$3].get_name()===$4[$5][$2].get_name()){++this.$3;this.$0[$3].set_selected(true);this.$0[$3].set_order($5);$0=true;this.$5='Rows';if(!this.$B){return;}else{break;}}}}}}if($0){return;}for(var $6=0;$6<results.get_columnHierarchies().length;$6++){for(var $7=0;$7<this.$0.length;$7++){var $8=results.get_columnMembers();if($8){for(var $9=0;$9<$8.length;$9++){if(this.$0[$7].get_name()===$8[$9][$6].get_name()){++this.$3;this.$0[$7].set_selected(true);this.$0[$7].set_order($9);$0=true;this.$5='Columns';if(!this.$B){return;}else{break;}}}}}}if($0){return;}if(0===results.get_rowHierarchies().length||0===results.get_columnHierarchies().length){return;}for(var $A=0;$A<this.$0.length;$A++){var $B=results.get_filterMembers();if($B){for(var $C=0;$C<$B.length;$C++){if(this.$0[$A].get_name()===$B[$C].get_name()){++this.$3;this.$0[$A].set_selected(true);this.$0[$A].set_order($C);$0=true;this.$5='Filter';if(!this.$B){return;}else{break;}}}}}},componentClicked:function(obj,inputElem,component,isChecked){var $0;if(!isChecked){obj.set_order(-1);$0=(this.$3-1);}else{obj.set_order(this.$3);$0=(this.$3+1);}if((!this.$B)&&(isChecked)){for(var $1=0;$1<this.$0.length;$1++){var $2=this.$0[$1];if($2===obj){continue;}if($2.get_selected()){$2.set_order(-1);this.$19($2,inputElem,'',false);break;}}for(var $3=0;$3<this.$1.length;$3++){var $4=this.$1[$3];if($4===obj){continue;}if($4.get_selected()){$4.set_order(-1);this.$19($4,inputElem,'',false);break;}}$0=1;obj.set_order(0);}this.$19(obj,inputElem,component,isChecked);this.$3=$0;return obj.get_selected();},deSelectObject:function(obj){if(!this.$0){return false;}if(!obj){return false;}if(!obj.get_selected()){return false;}obj.set_order(-1);this.$19(obj,null,'',false);return true;},$12:function($p0){for(var $0=0;$0<this.$0.length;$0++){var $1=this.$0[$0];if($p0==='_ALL_'){$1.set_visible(true);}else{if($1.get_measureGroupName()===$p0){$1.set_visible(true);}else{$1.set_visible(false);}}}if((this.$C)&&(this.$1)){for(var $2=0;$2<this.$1.length;$2++){var $3=this.$1[$2];if($p0==='_ALL_'){$3.set_visible(true);}else{if($3.get_measureGroupName()===$p0){$3.set_visible(true);}else{$3.set_visible(false);}}}}for(var $4=0;$4<this.$8.length;$4++){if(Object.getType(this.$8[$4]).getName()!=='PPSMA.Folder'){(this.$8[$4]).setVisibility(this.$A,0);}else{var $5=this.$8[$4];if($5){$5.setMeasuresVisibility(this.$A);}}}},$13:function($p0){var $0=$p0.getElementsByTagName('MeasureGroup');if($0.length>0){this.$E=new Array($0.length);this.$F=new Array($0.length);for(var $1=0;$1<$0.length;$1++){this.$E[$1]=$0[$1].getAttribute('name');this.$F[$1]=$0[$1].getAttribute('caption');}}},$14:function(){if(!this.$F){return;}if(this.$F.length>1){for(var $0=0;$0<this.$F.length;$0++){for(var $1=($0+1);$1<this.$F.length;$1++){if(this.$F[$0].localeCompare(this.$F[$1])>=0){var $2=this.$F[$1];var $3=this.$E[$1];this.$F[$1]=this.$F[$0];this.$E[$1]=this.$E[$0];this.$F[$0]=$2;this.$E[$0]=$3;}}}}},$15:function($p0){var $0=$p0.split('\\');if($0.length<5){return $p0;}else{var $1=($0[0]+'\\'+$0[1]+'\\'+$0[2]+'\\'+$0[3]+'\\'+$0[4]);return $1;}},handleExpandCollapseClick:function(e){var $0=PPSMA.EventsEx.getEvent(e.rawEvent);$0.cancelBubble=true;e.preventDefault();e.stopPropagation();var $1=e.target;var $2=null;if(PPSMA.DomElementEx.tagsMatch($1.tagName,'img')&&PPSMA.DomElementEx.tagsMatch($1.className,'chgMeasExCoImg')){$2=$1.parentNode.parentNode;}else if(PPSMA.DomElementEx.tagsMatch($1.tagName,'a')&&PPSMA.DomElementEx.tagsMatch($1.className,'chgMeasExCoA')){$2=$1.parentNode;}else{PPSMA.ReportsCommon.logErrorCondition('couldn\'t find the folderElem');}if($2&&PPSMA.DomElementEx.tagsMatch($2.tagName,'li')&&PPSMA.DomElementEx.tagsMatch($2.className,'chgMeasTflListItem')&&!isNullUndefinedOrEmpty($2.id)){var $3=this.findFolderByID($2.id);if($3){$3.expandCollapse($2);}}else{PPSMA.ReportsCommon.logErrorCondition('couldn\'t find the folderElem');}},$16:function($p0){var $0=PPSMA.EventsEx.getEvent($p0.rawEvent);$0.cancelBubble=true;$p0.preventDefault();$p0.stopPropagation();var $1=PPSMA.EventsEx.getCurrentElement($p0.rawEvent);if(!$1){return;}var $2=$1.parentNode.parentNode;var $3=this.findKpiByID($2.id);if($3){$3.expandCollapse($2);}},$17:function(){for(var $0=0;$0<this.$8.length;$0++){var $1=Object.getType(this.$8[$0]);if($1.getName()==='PPSMA.Folder'){for(var $2=($0+1);$2<this.$8.length;$2++){var $3=Object.getType(this.$8[$2]);var $4=$3.getName();if(($4==='PPSMA.Measure')||($4==='PPSMA.Kpi')){var $5=this.$8[$2];this.$8[$2]=this.$8[$0];this.$8[$0]=$5;break;}}}}for(var $6=0;$6<this.$8.length;$6++){var $7=Object.getType(this.$8[$6]);if($7.getName()==='PPSMA.Folder'){break;}for(var $8=0;$8<this.$8.length;$8++){var $9=Object.getType(this.$8[$8]);if($9.getName()==='PPSMA.Folder'){break;}var $A=this.$8[$6];var $B=this.$8[$8];if($A.get_caption().localeCompare($B.get_caption())<0){var $C=this.$8[$8];this.$8[$8]=this.$8[$6];this.$8[$6]=$C;(this.$8[$8]).set_index($A.get_index());(this.$8[$6]).set_index($B.get_index());}}}for(var $D=0;$D<this.$8.length;$D++){var $E=Object.getType(this.$8[$D]).getName();if(($E==='PPSMA.Measure')||($E==='PPSMA.Kpi')){continue;}for(var $F=0;$F<this.$8.length;$F++){var $10=Object.getType(this.$8[$F]).getName();if(($10==='PPSMA.Measure')||($10==='PPSMA.Kpi')){continue;}var $11=this.$8[$D];var $12=this.$8[$F];if($11.get_name().localeCompare($12.get_name())<0){var $13=this.$8[$F];this.$8[$F]=this.$8[$D];this.$8[$D]=$13;}}}for(var $14=0;$14<this.$8.length;$14++){var $15=Object.getType(this.$8[$14]).getName();if(($15==='PPSMA.Measure')||($15==='PPSMA.Kpi')){continue;}var $16=this.$8[$14];$16.sortDisplayObjects();}},$18:function($p0,$p1){$p0.set_axisHierarchy($p1);if(!Array.contains(this.$6,$p1)){Array.add(this.$6,$p1);}},$19:function($p0,$p1,$p2,$p3){for(var $0=0;$0<this.$8.length;$0++){if(Object.getType(this.$8[$0]).getName()!=='PPSMA.Folder'){if((this.$8[$0]).get_name()===$p0.get_name()){$p0.setInputElemCheckValue(this.$A,$p1,0,$p2,$p3);}}}for(var $1=0;$1<this.$7.length;$1++){var $2=this.$7[$1];$2.setInputElemCheckValue($p0,$p1,this.$A,$p2,$p3);}}}
PPSMA.DetailsHelper=function(olapViewContext,contextId,rIndex,cIndex,resultTableIndex){this.$0=olapViewContext;this.$1=contextId;this.$2=rIndex;this.$3=cIndex;this.$4=resultTableIndex;}
PPSMA.DetailsHelper.popupShowDetails=function(reportId,uniqueId,tupleXml,resultTableIndex,drillThroughPage,resourceUrl,isScorcard){var $0='DTDWindow';var $1=PPSMA.DetailsHelper.$7('',800,400,',resizable,scrollbars',$0);if($1){PPSMA.DetailsHelper.$B($1,uniqueId,resourceUrl);PPSMA.DetailsHelper.$8($1,reportId,tupleXml,resultTableIndex,drillThroughPage,isScorcard);PPSMA.DetailsHelper.$C($1,uniqueId);}}
PPSMA.DetailsHelper.$7=function($p0,$p1,$p2,$p3,$p4){var $0=window.self.screen;var $1=Math.round(($0.availWidth-$p1)/2);var $2=Math.round(($0.availHeight-$p2)/2);if(!$p4){$p4=Math.random().toString();}var $3=window.open($p0,$p4,'left='+$1+',top='+$2+',height='+$p2+',width='+$p1+$p3);if($3){$3.focus();}else{alert(PPSMA.SR.OlapContextMenu_PopupWarning);}return $3;}
PPSMA.DetailsHelper.$8=function($p0,$p1,$p2,$p3,$p4,$p5){var $0=$p0.document.getElementById('drillThroughFormID');if(!$0){$0=$p0.document.createElement('form');$0.setAttribute('id','drillThroughFormID');$0.setAttribute('target','_self');$0.setAttribute('action',$p4);$0.setAttribute('method','post');$0.setAttribute('name','drillThroughForm');$p0.document.documentElement.appendChild($0);$0.appendChild(PPSMA.DetailsHelper.$A('_dd_reportId','reportId',$p1,$p0.document));$0.appendChild(PPSMA.DetailsHelper.$A('_dd_tupleXmlId','tuple',$p2,$p0.document));$0.appendChild(PPSMA.DetailsHelper.$A('_dd_resultTableIndexId','resultTableIndex',$p3,$p0.document));$0.appendChild(PPSMA.DetailsHelper.$A('_dd_pageId','page','1',$p0.document));$0.appendChild(PPSMA.DetailsHelper.$A('_dd_typeId','isScorecard',$p5.toString(),$p0.document));$0.appendChild(PPSMA.DetailsHelper.$A('accessMode','accessMode',PPSMA.ReportsCommon.isInMoreAccessibleMode().toString(),$p0.document));}else{PPSMA.DetailsHelper.$9('_dd_reportId',$p1,$p0.document);PPSMA.DetailsHelper.$9('_dd_tupleXmlId',$p2,$p0.document);PPSMA.DetailsHelper.$9('_dd_resultTableIndexId',$p3,$p0.document);PPSMA.DetailsHelper.$9('_dd_typeId',$p5.toString(),$p0.document);PPSMA.DetailsHelper.$9('accessMode',PPSMA.ReportsCommon.isInMoreAccessibleMode().toString(),$p0.document);}if($0){$0.submit();}}
PPSMA.DetailsHelper.$9=function($p0,$p1,$p2){var $0=$p2.getElementById($p0);$0.setAttribute('value',$p1);}
PPSMA.DetailsHelper.$A=function($p0,$p1,$p2,$p3){var $0=$p3.createElement('input');$0.setAttribute('id',$p0);$0.setAttribute('type','hidden');$0.setAttribute('name',$p1);$0.setAttribute('value',$p2);return $0;}
PPSMA.DetailsHelper.$B=function($p0,$p1,$p2){var $0=$p0.document;var $1='Img'+$p1;var $2=$p2+'../images/hig_progcircle_loading24.gif';$0.open();$0.write('<html><head>\n');$0.write('</head><body>\n');$0.write('<div style=\"width:100%;height:152px;\">&nbsp;</div>\n');$0.write('<div style=\"width:100%;text-align:center;\" >\n');$0.write('<img id=\"'+$1+'\" src=\"'+$2+'\"/>\n');$0.write('</div>\n');$0.write('</body></html>');$0.close();}
PPSMA.DetailsHelper.$C=function($p0,$p1){var $0='Img'+$p1;var $1=$p0.document.getElementById($0);$1.src=$1.src;}
PPSMA.DetailsHelper.prototype={$0:null,$1:null,$2:0,$3:0,$4:null,showDetails:function(){PPSMA.DetailsHelper.popupShowDetails(this.$0.get_reportId(),this.$1,this.getCellTupleXml(),this.$4,this.$0.get_drillThroughPage(),this.$0.get_resourcePath(),false);},getCellTupleXml:function(){var $0=this.$0.get_results();var $1=$0.get_rowMembers();var $2=$0.get_columnMembers();var $3=$0.get_filterMembers();var $4=PPSMA.XmlEx.loadXml('<_dd />');var $5=$4.createElement('RowMembers');var $6=$4.createElement('ColumnMembers');var $7=$4.createElement('BackgroundMembers');$4.documentElement.appendChild($5);$4.documentElement.appendChild($6);$4.documentElement.appendChild($7);if($1){for(var $8=0;$8<$1[this.$2].length;$8++){var $9=$1[this.$2][$8];var $A=$4.createElement('Row');$A.setAttribute('name',$9.get_name());$A.setAttribute('caption',$9.get_caption());$5.appendChild($A);}}if($2){for(var $B=0;$B<$2[this.$3].length;$B++){var $C=$2[this.$3][$B];var $D=$4.createElement('Column');$D.setAttribute('name',$C.get_name());$D.setAttribute('caption',$C.get_caption());$6.appendChild($D);}}if($3){for(var $E=0;$E<$3.length;$E++){var $F=$3[$E];var $10=$4.createElement('Filter');$10.setAttribute('name',$F.get_name());$10.setAttribute('caption',$F.get_caption());$7.appendChild($10);}}return PPSMA.XmlEx.getXml($4.documentElement);}}
PPSMA.DrillDownToHelper=function(drillFromMember,drillFromHierarchy,drillFromAxisId,olapViewContext){this.$0=drillFromMember;this.$1=drillFromHierarchy;this.$2=drillFromAxisId;this.$3=olapViewContext;}
PPSMA.DrillDownToHelper.$5=function($p0,$p1){var $0=0;var $1=null;if(($p0)&&($p0.length>0)){for(var $2=0;$2<$p0.length;$2++){var $3=$p0[$2];var $4=$3.get_levels();if($4.length>1){$0+=$4.length-1;$1=$3;}}}if($0<=1){if(($p1)&&($p1.length>0)){for(var $5=0;$5<$p1.length;$5++){var $6=$p1[$5];var $7=$6.get_levels();if($7.length>1){$0+=$7.length-1;$1=$6;}}}}if($0>1){$1=null;}return $1;}
PPSMA.DrillDownToHelper.$8=function($p0,$p1,$p2,$p3){if(!$p2.length){return $p1;}var $0=$p1;var $1=0;var $2=false;var $3='';if(($p2.length>0)&&($p2[0])){$3=$p2[$1].caption;}while($1<$p2.length&&$p2[$1]&&compareStrings($3,$p3)){if($0){PPSMA.ContextMenu.addMenuSeparator($p0);$0=false;}var $4=$p2[$1].fn;var $5=$p2[$1].imgRes;$3=$p2[$1].caption;PPSMA.ContextMenu.addMenuOption($p0,$3,$4,$5,null,false,false);$p2[$1]=null;$2=true;$1++;}if($2){for($1=0;$1<$p2.length;$1++){if($p2[$1]){Array.removeAt($p2,$1);$1--;}}}return $0;}
PPSMA.DrillDownToHelper.$C=function($p0,$p1,$p2){var $0=$p2+'(\''+escape($p1.get_name());$0+='\', \'\', \'\');';var $1=PPSMA.SR.OlapContextMenu_MultipleSelections;PPSMA.ContextMenu.addMenuOption($p0,$1,$0,null,null,false,true);}
PPSMA.DrillDownToHelper.$E=function($p0){var $0=false;if($p0){if($p0.get_dimensionType()!==2){var $1=$p0.get_userDefinedHierarchies();if($1){for(var $2=0;$2<$1.length;$2++){var $3=$1[$2];if(PPSMA.DrillDownToHelper.$F($3)){$0=true;break;}}}if(!$0){var $4=$p0.get_attributeHierarchies();if($4){for(var $5=0;$5<$4.length;$5++){var $6=$4[$5];if(PPSMA.DrillDownToHelper.$F($6)){$0=true;break;}}}}}}return $0;}
PPSMA.DrillDownToHelper.$F=function($p0){return !PPSMA.DrillDownToHelper.$10($p0);}
PPSMA.DrillDownToHelper.$10=function($p0){var $0=true;if($p0){var $1=$p0.get_levels();if(($1)&&($1.length>1)){$0=false;}}return $0;}
PPSMA.DrillDownToHelper.prototype={$0:null,$1:null,$2:null,$3:null,populateSubMenuItems:function(sm,menuClickHandler){var $0=this.$3.get_cubeMetadata();if($0){for(var $1=0;$1<$0.length;$1++){var $2=$0[$1];if(PPSMA.DrillDownToHelper.$E($2)){var $3=$2.get_userDefinedHierarchies();var $4=$2.get_attributeHierarchies();if(this.$11($3)||this.$11($4)){this.$4(sm,$2,$3,$4,menuClickHandler,true);}else{this.$4(sm,$2,$3,$4,menuClickHandler,false);}}}}},$4:function($p0,$p1,$p2,$p3,$p4,$p5){var $0=this.$1A($p1);if($p5){var $1=PPSMA.DrillDownToHelper.$5($p2,$p3);if($1){this.$A($p0,$1,$p1,$p4,$0,$p5);}else{var $2=PPSMA.ContextMenu.addSubMenu($p0,$p1.get_caption(),$0,false);var $3=this.$6($2,$p1,$p2,$p4);var $4=this.$7($p2,$p1,$p4);this.$9($2,$p3,$p1,$p4,$3,$4);}}else{PPSMA.ContextMenu.addDisabledMenuOption($p0,$p1.get_caption(),'',$0,false);}},$6:function($p0,$p1,$p2,$p3){var $0=false;if($p2){for(var $1=0;$1<$p2.length;$1++){var $2=$p2[$1];if(PPSMA.DrillDownToHelper.$F($2)){var $3=this.$13($2);var $4=this.$12($2);var $5;if($2.get_name()===this.$1.get_name()){$5=this.$0.get_levelNumber();}else{var $7=this.$17($2);if(!$7){$5=0;}else{$5=$7.get_deepestLevel();}}var $6=$2.get_levels();if(($6)&&($6.length>2)){if($p1.get_name()===this.$1.get_dimension()){var $8=this.$0.get_levelName();var $9=$8.lastIndexOf('.');var $A=$8.substring($9+1,$8.length);for(var $B=1;$B<$6.length;$B++){var $C=$6[$B];var $D=$C.get_name();var $E=$D.lastIndexOf('.');var $F=$D.substring($E+1,$D.length);if($F===$A){$5=$B;}}}PPSMA.ContextMenu.addDisabledMenuOption($p0,$2.get_caption(),null,null,false);if($3){PPSMA.DrillDownToHelper.$C($p0,$2,$p3);}else{for(var $10=1;$10<$6.length;$10++){var $11=$6[$10];if($4||($10<=$5)){this.$B($p0,$11,$2,$p3,false);}else{this.$B($p0,$11,$2,$p3,true);}}}$0=true;}}}}return $0;},$7:function($p0,$p1,$p2){var $0=[];if($p0){var $1=this.$19($p1);for(var $2=0;$2<$p0.length;$2++){var $3=$p0[$2];if(PPSMA.DrillDownToHelper.$F($3)){var $4=$3.get_levels();if(($4)&&($4.length===2)){var $5=this.$D($3);var $6;if($5!==''){$6=$p2+'(\''+escape($3.get_name())+'\', \''+escape($5)+'\', \''+escape($4[1].get_name())+'\');';}else{$6=$p2+'(\''+escape($3.get_name())+'\', \'\', \'\');';}var $7={};$7.caption = $3.get_caption();$7.fn = $6;$7.imgRes = $1;Array.add($0,$7);}}}}return $0;},$9:function($p0,$p1,$p2,$p3,$p4,$p5){var $0=$p4;if($p1){var $1=this.$19($p2);for(var $2=0;$2<$p1.length;$2++){var $3=$p1[$2];if(PPSMA.DrillDownToHelper.$F($3)){var $4=$3.get_levels();if($4.length>1){$0=PPSMA.DrillDownToHelper.$8($p0,$0,$p5,$3.get_caption());if($0){PPSMA.ContextMenu.addMenuSeparator($p0);$0=false;}var $5=this.$D($3);var $6;if($5!==''){$6=$p3+'(\''+escape($3.get_name())+'\', \''+escape($5)+'\', \''+escape($4[1].get_name())+'\');';}else{$6=$p3+'(\''+escape($3.get_name())+'\', \'\', \'\');';}var $7=this.$17($3);var $8=this.$12($3);if($8||(($7)&&($7.get_deepestLevel()>0))){PPSMA.ContextMenu.addDisabledMenuOption($p0,$3.get_caption(),'',$1,false);}else{PPSMA.ContextMenu.addMenuOption($p0,$3.get_caption(),$6,$1,null,false,false);}}}}}PPSMA.DrillDownToHelper.$8($p0,$0,$p5,'');},$A:function($p0,$p1,$p2,$p3,$p4,$p5){var $0=this.$D($p1);var $1;if($0!==''){var $2=$p1.get_levels()[1];$1=$p3+'(\''+escape($p1.get_name())+'\', \''+escape($0)+'\', \''+escape($2.get_name())+'\');';}else{$1=$p3+'(\''+escape($p1.get_name())+'\', \'\', \'\');';}if($p5){PPSMA.ContextMenu.addMenuOption($p0,$p2.get_caption(),$1,$p4,null,false,false);}else{PPSMA.ContextMenu.addDisabledMenuOption($p0,$p2.get_caption(),null,$p4,false);}},$B:function($p0,$p1,$p2,$p3,$p4){var $0=this.$D($p2);var $1=$p3+'(\''+escape($p2.get_name())+'\', \''+escape($0)+'\', \''+escape($p1.get_name())+'\');';if($p4){PPSMA.ContextMenu.addMenuOption($p0,$p1.get_caption(),$1,null,null,false,true);}else{PPSMA.ContextMenu.addDisabledMenuOption($p0,$p1.get_caption(),null,null,true);}},$D:function($p0){var $0;if($p0.get_name()===this.$1.get_name()){$0=this.$0.get_name();}else{$0=$p0.get_name()+'.DefaultMember';var $1=this.$3.get_results().get_filterMembers();var $2=this.$3.get_results().get_filterHierarchies();if(($1)&&($2)){for(var $3=0;$3<$2.length;$3++){var $4=$2[$3];if($4.get_name()===$p0.get_name()){$0=(!$4.get_isAggregated())?$1[$3].get_name():'';break;}}}}return $0;},$11:function($p0){var $0=false;if($p0){for(var $1=0;$1<$p0.length;$1++){var $2=$p0[$1];if(!this.$12($2)){$0=true;break;}}}return $0;},$12:function($p0){var $0=false;if($p0){if(this.$2==='C'){$0=(this.$14($p0));}else if(this.$2==='R'){$0=(this.$15($p0));}}return $0;},$13:function($p0){var $0=false;if($p0){var $1=this.$16($p0);if($1){$0=$1.get_isAggregated();}}return $0;},$14:function($p0){var $0=null;if(this.$3){var $1=this.$3.get_results().get_rowHierarchies();for(var $2=0;$2<$1.length;$2++){var $3=$1[$2];if($3.get_name()===$p0.get_name()){$0=$3;break;}}}return $0;},$15:function($p0){var $0=null;if(this.$3){var $1=this.$3.get_results().get_columnHierarchies();for(var $2=0;$2<$1.length;$2++){var $3=$1[$2];if($3.get_name()===$p0.get_name()){$0=$3;break;}}}return $0;},$16:function($p0){var $0=null;if(this.$3){var $1=this.$3.get_results().get_filterHierarchies();for(var $2=0;$2<$1.length;$2++){var $3=$1[$2];if($3.get_name()===$p0.get_name()){$0=$3;break;}}}return $0;},$17:function($p0){var $0=this.$18($p0);if(!$0){$0=this.$16($p0);}return $0;},$18:function($p0){var $0=null;if(this.$3){$0=this.$14($p0);if(!$0){$0=this.$15($p0);}}return $0;},$19:function($p0){var $0;if($p0.get_dimensionType()===1){$0=this.$3.get_resourcePath()+'AttributeTime.gif';}else{$0=this.$3.get_resourcePath()+'Attribute.gif';}return $0;},$1A:function($p0){var $0;if($p0.get_dimensionType()===1){$0=this.$3.get_resourcePath()+'DimensionTime.gif';}else{$0=this.$3.get_resourcePath()+'Dimension.gif';}return $0;}}
PPSMA.AnalyzeInDecompHelper=function(){}
PPSMA.AnalyzeInDecompHelper.$7=function($p0,$p1,$p2,$p3,$p4){var $0=window.self.screen;var $1=Math.round(($0.availWidth-$p1)/2);var $2=Math.round(($0.availHeight-$p2)/2);if(!$p4){$p4=Math.random().toString();}var $3=window.open($p0,$p4,'left='+$1+',top='+$2+',height='+$p2+',width='+$p1+$p3);if($3){$3.focus();}else{alert(PPSMA.SR.OlapContextMenu_PopupWarning);}return $3;}
PPSMA.AnalyzeInDecompHelper.$8=function($p0,$p1,$p2){if(getBrowserIs().ie55up&&($p0.document.body)){$p0.document.body.innerHTML='';var $0='Img'+$p1;var $1=$p2+'../images/hig_progcircle_loading24.gif';var $2='<div style=\"width:100%;height:152px;\">&nbsp;</div>';$2+='<div style=\"width:100%;text-align:center;\">';$2+='<img id=\"'+$0+'\" src=\"'+$1+'\"/></div>';$p0.document.body.innerHTML=$2;}else{var $3=$p0.document;var $4='Img'+$p1;var $5=$p2+'../images/hig_progcircle_loading24.gif';$3.open();$3.write('<html><head>\n');$3.write('</head><body>\n');$3.write('<div style=\"width:100%;height:152px;\">&nbsp;</div>\n');$3.write('<div style=\"width:100%;text-align:center;\" >\n');$3.write('<img id=\"'+$4+'\" src=\"'+$5+'\"/>\n');$3.write('</div>\n');$3.write('</body></html>');$3.close();}}
PPSMA.AnalyzeInDecompHelper.$9=function($p0,$p1){var $0='Img'+$p1;var $1=$p0.document.getElementById($0);if($1){$1.src=$1.src;}}
PPSMA.AnalyzeInDecompHelper.getDefaultQueryParameters=function(){var $0=PPSMA.$create_DecompQueryParameters();if($0){$0.ClientState='';$0.SortType='descending';}return $0;}
PPSMA.AnalyzeInDecompHelper.$A=function($p0,$p1,$p2){var $0=$p0.get_results();var $1=$0.get_rowMembers();var $2=$0.get_columnMembers();var $3=$0.get_filterMembers();var $4=$0.get_filterHierarchies();var $5=PPSMA.$create_DecompTupleRecord();if($1){$5.RowSelections=new Array($1[$p1].length);for(var $6=0;$6<$1[$p1].length;$6++){var $7=$1[$p1][$6];$5.RowSelections[$6]=$7.get_name();}}if($2){$5.ColumnSelections=new Array($2[$p2].length);for(var $8=0;$8<$2[$p2].length;$8++){var $9=$2[$p2][$8];$5.ColumnSelections[$8]=$9.get_name();}}if($3){for(var $A=0;$A<$4.length;$A++){if($4[$A].get_name()!==$p0.get_measureHierarchyName()){continue;}var $B=$3[$A];$5.BackgroundMeasureName=$B.get_name();break;}}return $5;}
PPSMA.AnalyzeInDecompHelper.$B=function($p0){var $0=PPSMA.$create_DecompTupleRecord();var $1=PPSMA.XmlEx.loadXml($p0);var $2=$1.getElementsByTagName('Row');if($2.length>0){$0.RowSelections=new Array($2.length);for(var $4=0;$4<$2.length;$4++){$0.RowSelections[$4]=$2[$4].getAttribute('name');}}var $3=$1.getElementsByTagName('Column');if($3.length>0){$0.ColumnSelections=new Array($3.length);for(var $5=0;$5<$3.length;$5++){$0.ColumnSelections[$5]=$3[$5].getAttribute('name');}}return $0;}
PPSMA.AnalyzeInDecompHelper.$C=function($p0,$p1,$p2,$p3,$p4,$p5){var $0=$p0.document.getElementById('decompFormID');if(!$0){$0=$p0.document.createElement('form');$0.setAttribute('id','decompFormID');$0.setAttribute('target','_self');$0.setAttribute('action',$p5);$0.setAttribute('method','post');$0.setAttribute('name','decompForm');$p0.document.documentElement.appendChild($0);var $1=$p0.document.createElement('input');$1.setAttribute('id','reportId');$1.setAttribute('type','hidden');$1.setAttribute('name','reportId');$1.setAttribute('value',$p1);$0.appendChild($1);var $2=$p0.document.createElement('input');$2.setAttribute('id','tupleXmlId');$2.setAttribute('type','hidden');$2.setAttribute('name','tuple');$2.setAttribute('value',$p2);$0.appendChild($2);var $3=$p0.document.createElement('input');$3.setAttribute('id','queryParametersId');$3.setAttribute('type','hidden');$3.setAttribute('name','queryParameters');$3.setAttribute('value',$p3);$0.appendChild($3);var $4=$p0.document.createElement('input');$4.setAttribute('id','clientViewStateId');$4.setAttribute('type','hidden');$4.setAttribute('name','clientViewState');$4.setAttribute('value',$p4);$0.appendChild($4);}else{var $5=$p0.document.getElementById('reportId');$5.setAttribute('value',$p1);var $6=$p0.document.getElementById('tupleXmlId');$6.setAttribute('value',$p2);var $7=$p0.document.getElementById('queryParametersId');$7.setAttribute('value',$p3);var $8=$p0.document.getElementById('clientViewStateId');$8.setAttribute('value',$p4);}if($0){$0.submit();}}
PPSMA.AnalyzeInDecompHelper.prototype={$6:null,launchAnalyzeRequest:function(olapViewContext,contextId,rIndex,cIndex){this.$6=PPSMA.AnalyzeInDecompHelper.$7('',1000,600,',resizable,scrollbars=no,toolbar=no','DecompWindow');if(!this.$6){return;}PPSMA.AnalyzeInDecompHelper.$8(this.$6,'_DecompThrobberId',olapViewContext.get_resourcePath());var $0=PPSMA.AnalyzeInDecompHelper.getDefaultQueryParameters();if(this.$6.document){this.$6.document.title=PPSMA.SR.OlapContextMenu_AnalyzeInDecomp;}var $1=PPSMA.AnalyzeInDecompHelper.$A(olapViewContext,rIndex,cIndex);PPSMA.AnalyzeInDecompHelper.$C(this.$6,olapViewContext.get_reportId(),Sys.Serialization.JavaScriptSerializer.serialize($1),Sys.Serialization.JavaScriptSerializer.serialize($0),'',olapViewContext.get_decompTreePage());PPSMA.AnalyzeInDecompHelper.$9(this.$6,'_DecompThrobberId');},launchAnalyzeRequestFromScorecard:function(reportId,tupleXml,clientViewState,decompTreePage,resourcePath){this.$6=PPSMA.AnalyzeInDecompHelper.$7('',1000,600,',resizable,scrollbars=no,toolbar=no','DecompWindow');if(!this.$6){return;}PPSMA.AnalyzeInDecompHelper.$8(this.$6,'_DecompThrobberId',resourcePath);var $0=PPSMA.AnalyzeInDecompHelper.getDefaultQueryParameters();this.$6.document.title=PPSMA.SR.OlapContextMenu_AnalyzeInDecomp;var $1=PPSMA.AnalyzeInDecompHelper.$B(tupleXml);PPSMA.AnalyzeInDecompHelper.$C(this.$6,reportId,Sys.Serialization.JavaScriptSerializer.serialize($1),Sys.Serialization.JavaScriptSerializer.serialize($0),clientViewState,decompTreePage);PPSMA.AnalyzeInDecompHelper.$9(this.$6,'_DecompThrobberId');}}
PPSMA.MenuOptionHelper=function(member,hierarchy,canNavigate,olapViewContext){this.$0=member;this.$1=hierarchy;this.$2=canNavigate;this.$3=olapViewContext;}
PPSMA.MenuOptionHelper.$5=function($p0){var $0=20;if($p0.length>$0){$p0=$p0.substr(0,$0-3)+'...';}return String.format(PPSMA.SR.OlapContextMenu_SwitchToType,$p0);}
PPSMA.MenuOptionHelper.$6=function($p0){PPSMA.ContextMenu.addMenuOption($p0,PPSMA.SR.OlapContextMenu_DynamicLoadText,null,null,null,false,false);}
PPSMA.MenuOptionHelper.prototype={$0:null,$1:null,$2:false,$3:null,$4:0,get_optionsAdded:function(){return this.$4;},showHideInfo:function(m,eventFunction,indent){if(this.$4>0){PPSMA.ContextMenu.addMenuSeparator(m);}var $0;if(this.$3.get_infoBarVisible()){$0=PPSMA.SR.OlapContextMenu_HideInfo;}else{$0=PPSMA.SR.OlapContextMenu_ShowInfo;}PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,this.$3.get_resourcePath()+'ViewInformation.gif',null,false,indent);this.$4++;},drillDown:function(m,eventFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_DrillDown;if(this.$0.get_hasChildren()){PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,this.$3.get_resourcePath()+'DrillDown.gif',null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,this.$3.get_resourcePath()+'DrillDownD.gif',indent);}this.$4++;}},drillUp:function(m,eventFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_DrillUp;if(this.$0.get_hasParent()){PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,this.$3.get_resourcePath()+'DrillUp.gif',null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,this.$3.get_resourcePath()+'DrillUpD.gif',indent);}this.$4++;}},expandCollapse:function(m,expandFunction,collapseFunction,indent){if(this.$2){var $0;if(this.$0.get_drilledDown()){$0=PPSMA.SR.OlapContextMenu_Collapse;if(this.$0.get_hasChildren()){PPSMA.ContextMenu.addMenuOption(m,$0,collapseFunction,null,null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,null,indent);}this.$4++;}else{$0=PPSMA.SR.OlapContextMenu_Expand;if(this.$0.get_hasChildren()){PPSMA.ContextMenu.addMenuOption(m,$0,expandFunction,null,null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,null,indent);}this.$4++;}}},showOnly:function(m,eventFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_ShowOnly;if(!this.$1.get_isSingleton()){PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,null,indent);}this.$4++;}},remove:function(m,eventFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_Remove;if(!this.$1.get_isSingleton()){PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,null,indent);}this.$4++;}},pivot:function(m,eventFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_Pivot;PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);this.$4++;}},showProperties:function(m,eventFunction,indent,enabled){var $0=PPSMA.SR.OlapContextMenu_ShowProperties;if(enabled){PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,eventFunction,null,indent);}this.$4++;},hideProperty:function(m,caption,eventFunction,indent){var $0=caption;PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);this.$4++;},showChangeMeasure:function(m,eventFunction,isDesigner,indent){if(!isDesigner){var $0=PPSMA.SR.OlapChangeMeasure_ContextMenuLabel;PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);this.$4++;}},selectItems:function(m,eventFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_SelectItems;PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);this.$4++;}},hasAggregatedBackGroundHierarchies:function(){var $0=this.$3.get_results();if($0.get_unknownFilterParameters()){return true;}var $1=$0.get_filterHierarchies();if($1){for(var $2=0;$2<$1.length;$2++){var $3=$1[$2];if($3.get_isAggregated()){return true;}}}return false;},isSilverlightInstalled:function(){return isSilverlightInstalled('3.0.40624');},decompositionTree:function(m,eventFunction,indent,nonEmptyCell,isDesigner){if(isDesigner){return;}if(!this.isSilverlightInstalled()||!this.$2||!nonEmptyCell){return;}var $0=PPSMA.SR.OlapContextMenu_AnalyzeInDecomp;PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,this.$3.get_resourcePath()+'DecompositionTree.png',null,false,indent);this.$4++;},showDetails:function(m,eventFunction,indent,enabled){var $0=PPSMA.SR.OlapContextMenu_ShowDetails;if(enabled){PPSMA.ContextMenu.addMenuOption(m,$0,eventFunction,null,null,false,indent);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,eventFunction,null,indent);}this.$4++;},switchToOption:function(m,t,fn,indent){if(this.$2){var $0=PPSMA.MenuOptionHelper.$5(t);PPSMA.ContextMenu.addMenuOption(m,$0,fn,null,null,false,indent);this.$4++;}},addDisabledOption:function(m,t,indent){PPSMA.ContextMenu.addDisabledMenuOption(m,t,null,null,indent);this.$4++;},drillDownTo:function(m,fetchFunction,populateFunction,hoverOffFunction,indent){if(this.$2){var $0=PPSMA.SR.OlapContextMenu_DrillDownTo;var $1=PPSMA.ContextMenu.addDynamicSubMenu(m,$0,fetchFunction,populateFunction,hoverOffFunction,indent);PPSMA.MenuOptionHelper.$6($1);this.$4++;return $1;}return null;},additionalActions:function(m,fetchFunction,populateFunction,hoverOffFunction,indent,enabled){var $0=PPSMA.SR.OlapContextMenu_AdditionalActions;var $1=null;if(enabled){$1=PPSMA.ContextMenu.addDynamicSubMenu(m,$0,fetchFunction,populateFunction,hoverOffFunction,indent);PPSMA.MenuOptionHelper.$6($1);}else{PPSMA.ContextMenu.addDisabledMenuOption(m,$0,null,null,indent);}this.$4++;return $1;},reportTypeSubMenu:function(m,contextId,reportType){if(this.$2){var $0=PPSMA.ContextMenu.addSubMenu(m,PPSMA.SR.OlapContextMenu_ReportType,this.$3.get_resourcePath()+'BarChart.png',false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_Grid,contextId+'.switchToGrid()',this.$3.get_resourcePath()+'Grid.png',null,(!reportType),false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_ColumnChart,contextId+'.switchToColumnChart()',this.$3.get_resourcePath()+'BarChart.png',null,(reportType===1),false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_ColumnChartStacked,contextId+'.switchToColumnChartStacked()',this.$3.get_resourcePath()+'BarChartStacked.png',null,(reportType===2),false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_ColumnChartStacked100,contextId+'.switchToColumnChartStacked100()',this.$3.get_resourcePath()+'BarChartStacked100.png',null,(reportType===3),false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_LineChart,contextId+'.switchToLineChart()',this.$3.get_resourcePath()+'LineChartNoMarker.png',null,(reportType===4),false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_LineChartWithMarkers,contextId+'.switchToLineChartWithMarkers()',this.$3.get_resourcePath()+'LineChart.png',null,(reportType===5),false);PPSMA.ContextMenu.addMenuOption($0,PPSMA.SR.OlapContextMenu_ReportType_PieChart,contextId+'.switchToPieChart()',this.$3.get_resourcePath()+'PieChart.png',null,(reportType===6),false);this.$4++;}},formatReportSubMenu:function(m,indent){var $0=PPSMA.SR.OlapContextMenu_FormatReport;this.$4++;return PPSMA.ContextMenu.addSubMenu(m,$0,this.$3.get_resourcePath()+'FormatReport.gif',indent);}}
PPSMA.SubMenu=function(menuElement,menuType){this.$2=menuElement;this.$1=menuType;}
PPSMA.SubMenu.prototype={$0:false,$1:0,$2:null,$3:false,get_hoverOn:function(){return this.$0;},set_hoverOn:function(value){this.$0=value;return value;},get_menuType:function(){return this.$1;},set_menuType:function(value){this.$1=value;return value;},get_isPopulated:function(){return this.$3;},set_isPopulated:function(value){this.$3=value;return value;},get_menu:function(){return this.$2;}}
PPSMA.OlapViewContext=function(controlFactoryPath,metadataFactoryPath,ctrlProxyId,targetId,webPartTargetId,resourcePath,decompTreePage,drillThroughPage){this.$14={};this.$15=new PPSMA.Measures();this.$22='<div class=pps-reportErrorDiv><div class=pps-reportErrorTable>'+PPSMA.SR.Dashboard_Render_UnexpectedError+'</div></div>';this.$0=controlFactoryPath;this.$1=metadataFactoryPath;this.$2=ctrlProxyId;this.$4=targetId;this.$3=webPartTargetId;this.$5=resourcePath;this.$6=decompTreePage;this.$7=drillThroughPage;if(!isNullOrEmpty(webPartTargetId)){this.$8=PPSMA.ClientConnectionManager.get_instance().findClientWebPart(webPartTargetId);if(this.$8){this.$8.registerDisposableView(this);}}PPSMA.OlapViewContext.globalIds[ctrlProxyId]=this;}
PPSMA.OlapViewContext.$2D=function(){var $0=new Sys.UI.Point(0,0);if(window.self.innerWidth){$0.x=window.self.innerWidth;$0.y=window.self.innerHeight;}else{$0.x=PPSMA.SizeEx.getClientWidth();$0.y=PPSMA.SizeEx.getClientHeight();}return $0;}
PPSMA.OlapViewContext.$2F=function($p0){var $0=new Sys.UI.Point(0,0);if(!$p0){$0=PPSMA.OlapViewContext.$2D();}else{var $1=getStyle($p0,'width');var $2=getStyle($p0,'height');if($1!=='auto'||$2!=='auto'){$0.x=$p0.clientWidth;$0.y=$p0.clientHeight;}}return $0;}
PPSMA.OlapViewContext.$30=function($p0,$p1){var $0=$get($p0);var $1=$0.childNodes;for(var $2=0;$2<$1.length;$2++){if($1[$2].id===$p1){return $1[$2];}}return null;}
PPSMA.OlapViewContext.getViewInfoDiv=function(elem){while(elem){if(PPSMA.DomElementEx.tagsMatch(elem.tagName,'div')&&elem.id==='_viewInfoId'){return elem;}elem=elem.parentNode;}return null;}
PPSMA.OlapViewContext.overTbItem=function(e){var $0=PPSMA.EventsEx.getCurrentElement(e);while($0&&$0.tagName.toLowerCase()!=='td'){$0=$0.parentNode;}if($0){$0.className='bsm-toolbarCellSelected';}}
PPSMA.OlapViewContext.outTbItem=function(e,className){var $0=PPSMA.EventsEx.getCurrentElement(e);while($0&&$0.tagName.toLowerCase()!=='td'){$0=$0.parentNode;}if($0){$0.className=className;}}
PPSMA.OlapViewContext.overLiItem=function(e,className){var $0=PPSMA.EventsEx.getCurrentElement(e);while($0&&$0.tagName.toLowerCase()!=='li'){$0=$0.parentNode;}if($0){$0.className=className;}}
PPSMA.OlapViewContext.outLiItem=function(e,className){var $0=PPSMA.EventsEx.getCurrentElement(e);while($0&&$0.tagName.toLowerCase()!=='li'){$0=$0.parentNode;}if($0){$0.className=className;}}
PPSMA.OlapViewContext.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,$9:null,$A:null,$B:null,$C:0,$D:null,$E:null,$F:null,renderWebRequest:null,$10:null,$11:null,$12:null,$13:null,$16:true,$17:false,$18:false,$19:false,$1A:false,$1B:1,$1C:null,$1D:false,$1E:null,$1F:null,$20:null,$21:null,$23:true,$24:0,$25:0,$26:null,onHistoryNavigated:function(sender,e){if(!isNullOrEmpty(e.get_entryName())){var $0=e.get_entryName().split('|');var $1=$0[0];var $2=$0[1];if($1===this.$2){if($2!=='null'&&$2!=='error'){this.$A=$2;var $3=1;if($0.length>2&&$0[2].length>0){$3=Number.parseInvariant($0[2]);}this.$1B=$3;this.$1D=true;this.set_targetType($0[4]);this.setPage($3);}else{if(null!==this.$4){var $4=$get(this.$4);if(null!==$4){$4.style.position='static';$4.innerHTML=this.$22;}}}}}},get_toolbar:function(){return this.$26;},set_toolbar:function(value){this.$26=value;return value;},get_reportId:function(){return this.$A;},set_reportId:function(value){this.$A=value;return value;},get_targetType:function(){return this.$B;},set_targetType:function(value){this.$B=value;return value;},get_innerTargetId:function(){return this.$9;},set_innerTargetId:function(value){this.$9=value;return value;},get_outerTargetId:function(){return this.$4;},get_webPartTargetId:function(){return this.$3;},get_results:function(){return this.$D;},set_results:function(value){this.$D=value;return value;},get_measureHierarchyName:function(){return this.$E;},set_measureHierarchyName:function(value){this.$E=value;return value;},get_formatDimHierarchyName:function(){return this.$F;},set_formatDimHierarchyName:function(value){this.$F=value;return value;},get_measureData:function(){return this.$10;},set_measureData:function(value){this.$10=value;return value;},get_dimensionData:function(){return this.$11;},set_dimensionData:function(value){this.$11=value;return value;},get_cellActionData:function(){return this.$12;},set_cellActionData:function(value){this.$12=value;return value;},get_resourcePath:function(){return this.$5;},get_decompTreePage:function(){return this.$6;},get_drillThroughPage:function(){return this.$7;},get_cubeMetadata:function(){return this.$13;},set_cubeMetadata:function(value){this.$13=value;return value;},get_webPartProxy:function(){return this.$8;},get_infoBarVisible:function(){return this.$16;},set_infoBarVisible:function(value){this.$16=value;return value;},get_toolbarVisible:function(){return this.$1A;},set_toolbarVisible:function(value){this.$1A=value;return value;},get_historyButtonsVisible:function(){return this.$17;},set_historyButtonsVisible:function(value){this.$17=value;return value;},get_isSingleView:function(){return this.$18;},set_isSingleView:function(value){this.$18=value;return value;},get_isDesigner:function(){return this.$19;},set_isDesigner:function(value){this.$19=value;return value;},get_currentDataPage:function(){return this.$1B;},set_currentDataPage:function(value){this.$1B=value;return value;},get_ctrlProxyId:function(){return this.$2;},get_reportContext:function(){return this.$1E;},set_reportContext:function(value){this.$1E=value;return value;},applyMeasureSelectorChanges:function(){var $0=this.$2E();var $1='<Action type=\"ApplyMeasureSelectorChanges\">'+this.get_$27()+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},applyDimensionProperties:function(){var $0=this.$2E();var $1='<Action type=\"ApplyDimensionProperties\">'+'<DimensionProperties>'+this.get_$28()+'</DimensionProperties>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},execute:function(height,width){var $0=this.$2E();if(!width){width=$0.x;}if(!height){height=$0.y;}this.makeNavigationRequest('',height,width);},changeViewSize:function(viewInfoBarSize){if(!isNullOrEmpty(this.$9)){var $0=$get(this.$9);if($0){$0.style.height=($0.offsetHeight+viewInfoBarSize)+'px';}}},setOuterTagAttribute:function(attribName,attribValue){if(!isNullOrEmpty(this.$4)){var $0=$get(this.$4);if($0){$0.setAttribute(attribName,attribValue);}}},getOuterTagAttribute:function(attribName){var $0='';if(!isNullOrEmpty(this.$4)){var $1=$get(this.$4);if($1){$0=$1.getAttribute(attribName);}}return $0;},toggleViewInfoBar:function(viewInfoBar){this.changeViewConfiguration('ShowInformationBar',(!this.$16).toString());},drillUp:function(hierarchyName,memberName){var $0=this.$2E();var $1='<Action type=\"DrillUp\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},drillDown:function(hierarchyName,memberName){var $0=this.$2E();var $1='<Action type=\"DrillDown\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},get_$27:function(){var $0;if(this.$15.get_axis()==='none'){if(this.$15.get_selectedCount()===1){$0='<Measures Axis=\"Filter\" ';}else{$0='<Measures Axis=\"Columns\" ';}}else{if(!this.$15.get_selectedCount()){$0='<Measures Axis=\"Filter\" ';}else{if((this.$15.get_axis()==='Filter')&&(this.$15.get_selectedCount()>1)){if(this.$B==='AnalyticChart'){$0='<Measures Axis=\"Rows\" Moved=\"yes\" ';}else{$0='<Measures Axis=\"Columns\" Moved=\"yes\" ';}}else{$0='<Measures Axis=\"'+this.$15.get_axis()+'\" ';}}}$0+='MeasureGroupName=\"';$0+=this.$15.get_measureGroupName();$0+='\">';for(var $1=0;$1<this.$15.get_hierarchyCount();$1++){var $2=this.$15.getHierarchyName($1);$0+='<Hierarchy name=\"';$0+=$2;$0+='\">';for(var $3=0;$3<this.$15.get_selectedCount();$3++){var $4=this.$15.getSelectedMeasureByOrder($3);if(!$4){continue;}if($4.get_axisHierarchy()!==$2){continue;}$0+='<Measure name=\"';$0+=$4.get_name();$0+='\"/>';}$0+='</Hierarchy>';}$0+='</Measures>';return $0;},get_$28:function(){var $0='';if((!this.$D)||(!this.$D.get_rowHierarchies())){return $0;}for(var $1=0;$1<this.$D.get_rowHierarchies().length;$1++){var $2=this.$D.get_rowHierarchies()[$1].get_name();var $3=this.getDimensionPropertiesList($2);if($3){if($3.get_enabledCount()>0){$0+='<Hierarchy name=\"'+$3.get_name()+'\" PropertyCount=\"'+$3.get_enabledCount()+'\">';for(var $4=0;$4<$3.get_count();$4++){if($3.get_checked()[$4]){$0+='<DimProperty name=\"'+$3.get_names()[$4]+'\" caption=\"'+$3.get_captions()[$4]+'\"/>';}}$0+='</Hierarchy>';}delete this.$14[$2];}else{var $5=this.$D.get_rowHierarchies()[$1].get_memberProperties();var $6=($5.get_count()-$5.get_numPropertiesHidden());if($6>0){$0+='<Hierarchy name=\"'+$2+'\" PropertyCount=\"'+$6+'\">';for(var $7=0;$7<$5.get_count();$7++){if(!$5.isPropertyHidden($5.get_names()[$7])){$0+='<DimProperty name=\"'+$5.get_names()[$7]+'\" caption=\"'+$5.get_captions()[$7]+'\"/>';}}$0+='</Hierarchy>';}}}return $0;},getPageHeadersHeight:function(){var $0=0;if(this.$1A){$0+=23;}if(this.$16){$0+=22;}return $0;},setPage:function(pageno){var $0=this.$2E();var $1=true;if(this.$D){$1=this.$D.get_canNavigate();}var $2='<Action type=\"Execute\">'+'<Page>'+pageno+'</Page>'+'<Nav>'+$1+'</Nav>'+'</Action>';this.makeNavigationRequest($2,$0.y,$0.x);},setPage2:function(pageno,e){var $0=e.keyCode;if($0===13){this.setPage(pageno);}},setAllPageWithMessage:function(msg){var $0;$0=confirm(msg);if($0){var $1=this.$2E();var $2=true;if(this.$D){$2=this.$D.get_canNavigate();}var $3='<Action type=\"Execute\">'+'<Page>0</Page>'+'<Nav>'+$2+'</Nav>'+'</Action>';this.makeNavigationRequest($3,$1.y,$1.x);}},setAllPageWithMessage2:function(msg,e){var $0=e.keyCode;if($0===13){this.setAllPageWithMessage(msg);}},expand:function(hierarchyName,memberName){var $0=this.$2E();var $1='<Action type=\"Expand\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},collapse:function(hierarchyName,memberName){var $0=this.$2E();var $1='<Action type=\"Collapse\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},showOnly:function(hierarchyName,memberName){var $0=this.$2E();var $1='<Action type=\"ShowOnly\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},hide:function(hierarchyName,memberName){var $0=this.$2E();var $1='<Action type=\"Hide\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},crossDrill:function(hierarchyName,memberName,drillToHierarchyName,drillToMemberName,drillToLevelName){var $0=this.$2E();var $1='<Action type=\"CrossDrill\">'+'<Member>'+PPSMA.EncodeEx.xmlEncode(memberName)+'</Member>'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchyName)+'</Hierarchy>'+'<Page>'+this.$1B+'</Page>'+'<DrillToMember>'+PPSMA.EncodeEx.xmlEncode(drillToMemberName)+'</DrillToMember>'+'<DrillToLevel>'+PPSMA.EncodeEx.xmlEncode(drillToLevelName)+'</DrillToLevel>'+'<DrillToHierarchy>'+PPSMA.EncodeEx.xmlEncode(drillToHierarchyName)+'</DrillToHierarchy>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},pivot:function(){var $0=this.$2E();var $1='<Action type=\"Pivot\"></Action>';this.makeNavigationRequest($1,$0.y,$0.x);},switchOlapReportType:function(reportType,callback){var $0=this.$2E();var $1='<Action type=\"SwitchReportType\">'+'<Page>'+reportType+'</Page>'+'</Action>';var $2;if(!reportType){$2='OLAPGrid';}else{$2='AnalyticChart';}this.$1F=callback;this.$2B($1,$0.y,$0.x,$2);},changeViewConfiguration:function(propertyName,propertyValue){var $0=this.$2E();var $1='<Action type=\"ChangeViewConfiguration\">'+'<'+propertyName+'>'+propertyValue+'</'+propertyName+'>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},changeViewConfigurationWithCallback:function(propertyName,propertyValue,callback){this.$1F=callback;this.changeViewConfiguration(propertyName,propertyValue);},filterEmpty:function(axis,filter){var $0=this.$2E();var $1='<Action type=\"FilterEmpty\">'+'<Axis>'+PPSMA.EncodeEx.xmlEncode(axis)+'</Axis>'+'<Filter>'+filter+'</Filter>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},clearFilter:function(axis,resetPaging){var $0=this.$2E();var $1=this.$1B;if(!$1&&resetPaging){$1=1;}var $2='<Action type=\"Filter\">'+'<Hierarchy></Hierarchy>'+'<TupleXML></TupleXML>'+'<Axis>'+PPSMA.EncodeEx.xmlEncode(axis)+'</Axis>'+'<FilterType>'+PPSMA.EncodeEx.xmlEncode('0')+'</FilterType>'+'<Level></Level>'+'<Value1></Value1>'+'<Value2></Value2>'+'<Page>'+$1+'</Page>'+'</Action>';this.makeNavigationRequest($2,$0.y,$0.x);},filter:function(filterType,hierarchy,tupleXml,axis,level,value1,value2){var $0=this.$2E();var $1='<Action type=\"Filter\">'+'<Hierarchy>'+PPSMA.EncodeEx.xmlEncode(hierarchy)+'</Hierarchy>'+'<TupleXML>'+tupleXml+'</TupleXML>'+'<Axis>'+PPSMA.EncodeEx.xmlEncode(axis)+'</Axis>'+'<FilterType>'+PPSMA.EncodeEx.xmlEncode(filterType)+'</FilterType>'+'<Level>'+PPSMA.EncodeEx.xmlEncode(level)+'</Level>'+'<Value1>'+PPSMA.EncodeEx.xmlEncode(value1)+'</Value1>'+'<Value2>'+PPSMA.EncodeEx.xmlEncode(value2)+'</Value2>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},sort:function(axis,tupleXml,sortType,preservePeerGroup){var $0=this.$2E();var $1='<Action type=\"Sort\">'+'<Axis>'+PPSMA.EncodeEx.xmlEncode(axis)+'</Axis>'+'<TupleXML>'+tupleXml+'</TupleXML>'+'<SortType>'+PPSMA.EncodeEx.xmlEncode(sortType)+'</SortType>'+'<PreservePeerGroup>'+PPSMA.EncodeEx.xmlEncode(preservePeerGroup)+'</PreservePeerGroup>'+'<Page>'+this.$1B+'</Page>'+'</Action>';this.makeNavigationRequest($1,$0.y,$0.x);},loadCubeMetadata:function(metadataContextId){var $0='<Action type=\"GetCubeMetadata\"></Action>';this.makeCubeMetadataRequest($0,metadataContextId);},getCellLevelActions:function(tupleXml){var $0='<Action type=\"CellLevelActions\">'+'<Tuple>'+tupleXml+'</Tuple>'+'</Action>';this.$29($0,1);},getDimensionProperties:function(selectedMemberXml,callback){this.$21=callback;var $0='<Action type=\"DimensionProperties\">'+'<Member>'+selectedMemberXml+'</Member>'+'</Action>';this.$29($0,3);},getMeasureGroups:function(callback){this.$20=callback;var $0='<Action type=\"MeasureGroups\">'+'<RetrieveKpis>'+this.$15.get_displayKpis()+'</RetrieveKpis>'+'</Action>';this.$29($0,2);},$29:function($p0,$p1){var $0='InfoBar:'+this.$16+',History:'+this.$17+',SingleView:'+this.$18+',IsDesigner:'+this.$19+',ActionXML:'+$p0.replace(':','');var $1=PPSMA.$create_AjaxOlapRenderRequestRecord(this.$4,'OLAPGrid',this.$2,0,0,this.$A,'',$p0,$0);var $2={requestRecord:$1};var $3=new Sys.Net.WebRequest();$3.get_headers()['Content-Type']='application/json; charset=utf-8';$3.get_headers()['MenuMetadata-Type']=($p1===1)?'CellActions':($p1===3)?'DimensionData':($p1===2)?'MeasureData':'None';$3.set_url(this.$0);$3.set_body(Sys.Serialization.JavaScriptSerializer.serialize($2));$3.set_httpVerb('POST');$3.add_completed(Function.createDelegate(this,this.onMenuMetadataRequestCompleted));$3.invoke();},onMenuMetadataRequestCompleted:function(executor){var $0=0;var $1='';if(executor.get_webRequest()){$1=executor.get_webRequest().get_headers()['MenuMetadata-Type'];$0=($1==='CellActions')?1:($1==='DimensionData')?3:($1==='MeasureData')?2:0;}else{this.menuMetadataRequestCompletedError('The request was destroyed');}if(executor.get_responseAvailable()&&executor.get_statusCode()===200){var $2=PPSMA.WebRequestExecuterEx.simpleResult(executor,'AjaxRenderResultRecord');var $3=$2.Html;if(!isNullOrUndefined($3)){var $4;if($0===2){$4=$3.startsWith('<MeasureGroups');this.$10=($4)?$3:null;if(this.$20){this.$20($4);this.$20=null;}}else if($0===3){$4=$3.startsWith('<DimensionProperties');this.$11=($4)?$3:null;if(this.$21){this.$21($4);this.$21=null;}}else if($0===1){$4=$3.startsWith('<AdditionalActions');this.$12=($4)?$3:null;}else{this.menuMetadataRequestCompletedError('Unrecognized return type '+$1);}}else{this.menuMetadataRequestCompletedError('Response is blank');}}else{this.menuMetadataRequestCompletedError('Menu metadata response '+((executor.get_responseAvailable())?'available, ':'not available, ')+'StatusCode='+executor.get_statusCode());}if(executor&&!executor.get_aborted()){executor.abort();}},notifyBrowserOfAsyncUpdate:function(elem){if(PPSMA.ReportsCommon.isInMoreAccessibleMode()){if(elem){notifyBrowserOfAsyncUpdate(elem);}else{PPSMA.ReportsCommon.logErrorCondition('Couldn\'t notify browser of an asynchronous update.');}}},menuMetadataRequestCompletedError:function(errorMsg){},$2A:function(){if(this.renderWebRequest){this.renderWebRequest.dispose();this.renderWebRequest=null;}if(this.$1A){var $0='OTB'+this.$9;var $1=$get($0);$1.style.display='block';}if(this.$16){var $2=PPSMA.OlapViewContext.$30(this.$4,'_viewInfoId');if($2){$2.style.display='block';}}},$2B:function($p0,$p1,$p2,$p3){if(this.renderWebRequest){this.renderWebRequest.dispose();this.renderWebRequest=null;}var $0=null;if(!isNullOrEmpty(this.$9)){$0=$get(this.$9);}if(this.$1A){var $5='OTB'+this.$9;var $6=$get($5);$6.style.display='none';}if(this.$16){var $7=PPSMA.OlapViewContext.$30(this.$4,'_viewInfoId');if($7){$7.style.display='none';}}this.renderWebRequest=new PPSMA.OlapWebRequest($0,Function.createDelegate(this,this.$2A));if($0){this.renderWebRequest.show();}this.$C++;var $1='InfoBar:'+this.$16+',History:'+this.$17+',SingleView:'+this.$18+',IsDesigner:'+this.$19;var $2=PPSMA.$create_AjaxOlapRenderRequestRecord(this.$4,$p3||'OLAPGrid',this.$2,$p1,$p2,this.$A,'',$p0,$1);var $3={requestRecord:$2};var $4=PPSMA.$create_WebRequestDetails(this.$0,Sys.Serialization.JavaScriptSerializer.serialize($3),'POST','application/json; charset=utf-8',Function.createDelegate(this,this.$2C));this.renderWebRequest.submit($4);},makeNavigationRequest:function(actionXml,height,width){this.$2B(actionXml,height,width,this.$B);},invokeAnalyticCallback:function(success){if(this.$1F){this.$1F(success);this.$1F=null;}},$2C:function($p0){if($p0.get_aborted()){this.invokeAnalyticCallback(false);return;}else{this.invokeAnalyticCallback(true);}this.renderWebRequest.dispose();this.renderWebRequest=null;if(this.$18&&!this.$1C){var $0=$get(this.$4);this.$1C=AjaxFX.HistoryManager.createHistory($0,this.$5+'plus.gif?'+this.$2+'|'+this.$A+'|1|'+this.$C+'|'+this.get_targetType());if(Sys.Browser.agent===Sys.Browser.Firefox){this.$1C.addEntry(this.$2+'|'+this.$A+'|1|'+this.$C+'|'+this.get_targetType());}this.$1C.add_navigated(Function.createDelegate(this,this.onHistoryNavigated));}if($p0.get_responseAvailable()&&$p0.get_statusCode()===200){var $1;$1=PPSMA.WebRequestExecuterEx.simpleResult($p0,'AjaxRenderResultRecord');var $2=false;if(!isNullOrUndefined($1)){$2=this.renderResult($1);}if(this.$1C&&!this.$1D){if($2&&!isNullOrEmpty(this.$A)){this.$1C.addEntry(this.$2+'|'+this.$A+'|'+this.$1B+'|'+this.$C+'|'+this.get_targetType());}else{this.$1C.addEntry(this.$2+'|error|1|'+this.$C+'|'+this.get_targetType());}}}else{if(null!==this.$4){var $3=$get(this.$4);if(null!==$3){$3.style.position='static';$3.innerHTML=this.$22;}}if(this.$1C&&!this.$1D){this.$1C.addEntry(this.$2+'|error|1|'+this.$C+'|'+this.get_targetType());}}this.$1D=false;this.notifyBrowserOfAsyncUpdate($get(this.$4));},makeCubeMetadataRequest:function(metadataXML,metadataContextId){if(this.renderWebRequest){this.renderWebRequest.dispose();this.renderWebRequest=null;}this.renderWebRequest=new PPSMA.OlapWebRequest(null,null);this.$C++;var $0=PPSMA.$create_AjaxOlapMetadataRequestRecord(this.$4,'OlapMetadata',this.$2,metadataContextId,this.$A,metadataXML);var $1={requestRecord:$0};var $2=PPSMA.$create_WebRequestDetails(this.$1,Sys.Serialization.JavaScriptSerializer.serialize($1),'POST','application/json; charset=utf-8',Function.createDelegate(this,this.onCubeMetadataRequestCompleted));this.renderWebRequest.submit($2);},onCubeMetadataRequestCompleted:function(executor){if(this.renderWebRequest){this.renderWebRequest.dispose();this.renderWebRequest=null;}if(executor.get_responseAvailable()&&executor.get_statusCode()===200){var $0;$0=PPSMA.WebRequestExecuterEx.simpleResult(executor,'AjaxRenderResultRecord');if(!isNullOrUndefined($0)){this.renderMetadataResult($0);}}else{}},renderResult:function(record){var $0=$get(this.$4);if(isNullOrUndefined($0)){return false;}if(!isNullUndefinedOrEmpty(record.Html)){$0.innerHTML=record.Html;}if(!isNullUndefinedOrEmpty(record.Script)){try{eval(record.Script);}catch($1){alert($1.message);}}else{$0.style.position='static';}return true;},renderMetadataResult:function(record){var $0=record.Script;if(!isNullOrEmpty($0)){try{eval($0);}catch($1){alert($1.message);}}},renderUpdate:function(){var $0=$get(this.$4);if($0){var $1=PPSMA.OlapViewContext.$2D();this.$25=$1.y;this.$24=$1.x;if(!isNullOrEmpty(this.$9)){var $2=$get(this.$9);if($2){this.$23=false;}}}},resize:function(e){if(this.$23){return;}if(PPSMA.SizeEx.getClientHeight()<=30){return;}var $0=$get(this.$4);if($0&&!isNullOrEmpty(this.$9)){var $1=$get(this.$9);if($1){var $2=PPSMA.OlapViewContext.$2D();if($2.y!==this.$25){$1.style.height=($0.offsetParent.offsetHeight-this.getPageHeadersHeight()-4)+'px';}if($2.x!==this.$24){$1.style.width=$0.offsetParent.offsetWidth+'px';}}}},$2E:function(){var $0=null;if(!isNullOrEmpty(this.$3)){$0=$get(this.$3);}return PPSMA.OlapViewContext.$2F($0);},dispose:function(){if(this.$1C){this.$1C.dispose();}if(this.renderWebRequest){this.renderWebRequest.dispose();this.renderWebRequest=null;}delete PPSMA.OlapViewContext.globalIds[this.$2];},get_measures:function(){return this.$15;},getDimensionPropertiesList:function(uniqueName){return (this.$14[uniqueName]);},addDimensionPropertiesList:function(uniqueName,displayCaption,count){var $0=this.getDimensionPropertiesList(uniqueName);if($0){return $0;}$0=new PPSMA.DimensionProperties(uniqueName,displayCaption,count);this.$14[uniqueName]=$0;return $0;}}
PPSMA.ChangeMeasure=function(viewCtxName,olapViewContext){this.measureList=[];this.$1C=viewCtxName;this.$1D=olapViewContext;this.$1E=new PPSMA.ThinFieldList(this.$1D,true,false);this.$1E.add_itemSelected(Function.createDelegate(this,this.handleThinFieldListItemSelected));this.$1E.add_resizeOnDataLoaded(Function.createDelegate(this,this.$29));this.$23=this.$1D.get_ctrlProxyId()+'_DragContainer';this.$24=this.$1D.get_ctrlProxyId()+'_CmId';this.$25=this.$1D.get_ctrlProxyId()+'MeasureGroupsDropDownSelect';}
PPSMA.ChangeMeasure.prototype={$1C:null,$1D:null,$1E:null,$1F:null,$20:null,$21:null,$22:null,$23:null,$24:null,$25:null,$26:null,setCallbackMethod:function(callback){this.$20=callback;},get_selectedButton:function(){return this.$22;},show:function(currCell){this.initializeChangeMeasureDiv();this.$1E.showInChangeMeasure();window.setTimeout(Function.createDelegate(this,this.$29),250);window.setTimeout(Function.createDelegate(this,this.setInitialFocus),500);this.$27();},$27:function(){this.$21=Function.createDelegate(this,this.$2C);if(!PPSMA.DialogsCommon.addDialogResizeEventHandlers(this.$21,Function.createDelegate(this,this.$2A))){PPSMA.ReportsCommon.logErrorCondition('ChangeMeasure: couldn\'t add the resize event handlers');}var $0=$get('tabMoverLinkId');if($0){Sys.UI.DomEvent.addHandler($0,'click',Function.createDelegate(this,this.$2E));Sys.UI.DomEvent.addHandler($0,'keydown',Function.createDelegate(this,this.handleTabMoverLinkKeydown));}var $1=$get('okLinkId');if($1){Sys.UI.DomEvent.addHandler($1,'click',Function.createDelegate(this,this.applyNewMeasureSelection));Sys.UI.DomEvent.addHandler($1,'focus',Function.createDelegate(this,this.handleOKButtonFocus));}var $2=$get('cancelLinkId');if($2){Sys.UI.DomEvent.addHandler($2,'click',Function.createDelegate(this,this.closeChangeMeasureDialog));}},$28:function(){if(!PPSMA.DialogsCommon.removeWindowResizeEventHandler(this.$21)){PPSMA.ReportsCommon.logErrorCondition('ChangeMeasure: couldn\'t remove the resize event handlers');}this.$21=null;},setInitialFocus:function(){if(!PPSMA.ReportsCommon.isInMoreAccessibleMode()){this.skipToMeasureList();}else{this.showAndActivateSkipToLink();}},showAndActivateSkipToLink:function(){var $0=$get('tabMoverDivId');if($0){$0.style.display='block';var $1=$get('tabMoverLinkId');if($1){$1.focus();}else{PPSMA.ReportsCommon.logErrorCondition('SetInitialFocus: couldn\'t find anchor '+'tabMoverLinkId'+' to focus on it.');}}else{PPSMA.ReportsCommon.logErrorCondition('SetInitialFocus: couldn\'t find div '+'tabMoverDivId'+' to make it visible.');}},initializeChangeMeasureDiv:function(){var $0=document.createElement('div');$0.id=this.$24;$0.title=PPSMA.SR.OlapChangeMeasure_DialogAltText;$0.setAttribute('alt',PPSMA.SR.OlapChangeMeasure_DialogAltText);$0.style.position='relative';$0.style.backgroundColor='#f0f0f0';$0.style.width=400+'px';$0.style.height=286+'px';document.body.appendChild($0);var $1=document.createElement('div');$1.id='tabMoverDivId';$1.style.position='absolute';$1.style.backgroundColor='#ffcc00';$1.style.top='2px';$1.style.left='2px';$1.style.height='16px';$1.style.padding='2px 3px 0xp 3xp';$1.style.border='Solid 1px #000000';$1.style.display='none';$1.style.zIndex=1;$0.appendChild($1);var $2=document.createElement('a');$2.href='javascript:;';$2.id='tabMoverLinkId';$2.title=PPSMA.SR.OlapChangeMeasure_SkipToMeasureList;$2.style.fontFamily='tahoma';$2.style.fontSize='8pt';$2.style.textDecoration='none';PPSMA.DomElementEx.setInnerText($2,PPSMA.SR.OlapChangeMeasure_SkipToMeasureList);$1.appendChild($2);var $3=document.createElement('div');$3.id='aboveFooterLayoutDivId';$0.appendChild($3);var $4=document.createElement('div');$4.id='flId';$4.style.backgroundColor='#ffffff';$4.style.styleFloat='left';$3.appendChild($4);var $5=document.createElement('div');$5.id='mlId';$5.style.backgroundColor='#ffffff';$5.style.top='0px';$5.style.styleFloat='left';$3.appendChild($5);var $6=document.createElement('div');$6.id=this.$23;$6.style.overflowY='auto';$6.style.overflowX='hidden';$6.noWrap=true;$5.appendChild($6);var $7=document.createElement('div');$7.id='cmfId';$7.style.backgroundColor='#f0f0f0';$7.style.left='0px';$7.style.height='30px';$0.appendChild($7);var $8=document.createElement('div');$8.id='ftrLayoutDiv0Id';$8.innerHTML='&nbsp;';$8.style.styleFloat='left';$7.appendChild($8);var $9=document.createElement('div');$9.id='ftrLayoutDiv1Id';$9.style.styleFloat='left';$9.style.marginTop='4px';$9.style.marginBottom='4px';$7.appendChild($9);var $A=document.createElement('input');$A.type='button';$A.id='okLinkId';$A.value=PPSMA.SR.OlapChangeMeasure_Ok;$A.title=PPSMA.SR.OlapChangeMeasure_Ok;$A.setAttribute('alt',PPSMA.SR.OlapChangeMeasure_Ok);$A.className='ms-ButtonHeightWidth';if(!compareStrings(PPSMA.SR.OlapChangeMeasure_Ok,'OK')){$A.style.width='5em';}$A.style.marginRight='4px';$9.appendChild($A);var $B=document.createElement('input');$B.type='button';$B.id='cancelLinkId';$B.value=PPSMA.SR.OlapChangeMeasure_Cancel;$B.title=PPSMA.SR.OlapChangeMeasure_Cancel;$B.setAttribute('alt',PPSMA.SR.OlapChangeMeasure_Cancel);$B.className='ms-ButtonHeightWidth';if(!compareStrings(PPSMA.SR.OlapChangeMeasure_Cancel,'Cancel')){$B.style.width='5em';}$B.style.marginLeft='4px';$B.style.marginRight='8px';$9.appendChild($B);var $C=document.createElement('div');$C.appendChild($0);var $D=PPSMA.SizeEx.getCenterXandY(400,286);var $E=SP.UI.$create_DialogOptions();$E.height=286;$E.width=400;$E.title=PPSMA.SR.OlapChangeMeasure_DialogTitle;$E.html=$C;$E.html.innerHTML=$C.innerHTML;PPSMA.DomElementEx.removeElement($0);$E.x=$D.x;$E.y=$D.y;$E.dialogReturnValueCallback=Function.createDelegate(this,this.$2D);this.$1F=SP.UI.ModalDialog.showModalDialog($E);},handleOKButtonFocus:function(e){this.focusOnlyMeasure('deadbeefdeadbeefdeadbeef');},$29:function(){var $0=$get(this.$24);var $1=$get('aboveFooterLayoutDivId');var $2=$get('flId');var $3=$get('mlId');var $4=$get(this.$23);var $5=$get('cmfId');var $6=$get('ftrLayoutDiv0Id');var $7=$get('ftrLayoutDiv1Id');if(!$0||!$1||!$2||!$3||!$4||!$5){if(!$0){PPSMA.ReportsCommon.logErrorCondition('changeMeasureDiv is null');}if(!$1){PPSMA.ReportsCommon.logErrorCondition('fieldAndMeasListsLayout is null');}if(!$2){PPSMA.ReportsCommon.logErrorCondition('fieldListDiv is null');}if(!$3){PPSMA.ReportsCommon.logErrorCondition('measureListDiv is null');}if(!$4){PPSMA.ReportsCommon.logErrorCondition('dragContainerDiv is null');}if(!$5){PPSMA.ReportsCommon.logErrorCondition('footerDiv is null');}if(!$6){PPSMA.ReportsCommon.logErrorCondition('ftrLayoutDiv0 is null');}if(!$7){PPSMA.ReportsCommon.logErrorCondition('ftrLayoutDiv1 is null');}return;}var $8=PPSMA.DialogsCommon.getDlgFrameContainerDiv();if(!$8){PPSMA.ReportsCommon.logErrorCondition('can\'t find ms-dlgFrameContainer');return;}var $9=$8.offsetWidth;var $A=$8.offsetHeight;$0.style.width=$9+'px';$0.style.height=$A+'px';$5.style.width=$9+'px';var $B=($5.offsetWidth-$7.offsetWidth);$6.style.width=($B>0)?$B+'px':'0px;';var $C=$A-$5.offsetHeight;$1.style.height=$C+'px';$1.style.width=$9+'px';$2.style.height=$C+'px';$2.style.width=($9/2)+'px';var $D=$get(this.$1D.get_ctrlProxyId()+'_ThinFieldListDiv');if($D){$D.style.height=$C+'px';$D.style.width=$2.style.width;var $E=$get(this.$25);var $F=$get(this.$1D.get_ctrlProxyId()+'MeasureGroupsDropDownSelectWrapperDiv');if($E&&$F){$F.style.width=$2.style.width;$E.style.width=$2.offsetWidth+'px';var $10=$get('_ScrollList');if($10){$10.style.height=($C-$F.offsetHeight)+'px';$10.style.width=$2.style.width;}else{PPSMA.ReportsCommon.logErrorCondition('Resize: coudln\'t find the scroll list.');}}else{PPSMA.ReportsCommon.logErrorCondition('Resize: couldn\'t find measure group drop down or it\'s container div.');}}$3.style.height=$C+'px';$3.style.width=($9/2)+'px';$4.style.height=$C+'px';$4.style.width=($9/2)+'px';for(var $11=0;$11<$4.childNodes.length;$11++){$4.childNodes[$11].style.width=($4.clientWidth-9>0)?($4.clientWidth-9)+'px':'0px';}this.$2B();if(this.$26){this.focusMeasure(this.$26);}},$2A:function($p0){window.setTimeout(Function.createDelegate(this,this.$29),250);},$2B:function(){var $0=$get('upDownCloseRemoveBufferDivId');if($0){var $1=$0.parentNode;var $2=$1.firstChild;var $3=$1.offsetWidth-($2.offsetWidth+16+16+16+7);$0.style.width=($3>0)?$3+'px':'0px';}},$2C:function($p0){window.setTimeout(Function.createDelegate(this,this.$29),250);},handleThinFieldListItemSelected:function(sender,args){if(sender){var $0=$get(this.$23);if(args.itemIsSelected){if(!Array.contains(this.measureList,args.itemUniqueName)){if($0){var $1=document.createElement('div');$0.appendChild($1);$1.id=args.itemUniqueName;$1.className='dragBox';$1.title=args.itemCaption;Sys.UI.DomEvent.addHandler($1,'keyup',Function.createDelegate(this,this.handleMeasureNameDivKeyup));Sys.UI.DomEvent.addHandler($1,'click',Function.createDelegate(this,this.handleMeasureNameDivClick));var $2=document.createElement('a');$1.appendChild($2);$2.id='msNameId'+args.itemUniqueName;$2.setAttribute('href','#');$2.style.overflow='hidden';$2.style.whiteSpace='nowrap';$2.style.textDecoration='none';$2.style.color='#000000';$2.style.styleFloat='left';$2.style.verticalAlign='middle';$2.style.paddingLeft='4px';$2.style.width=125+'px';PPSMA.DomElementEx.setInnerText($2,args.itemCaption);Sys.UI.DomEvent.addHandler($2,'click',Function.createDelegate(this,this.handleMeasureNameLinkClick));Sys.UI.DomEvent.addHandler($2,'focus',Function.createDelegate(this,this.handleMeasureNameLinkFocus));Sys.UI.DomEvent.addHandler($2,'keydown',Function.createDelegate(this,this.blurMeasureListOnTabToFieldList));Array.add(this.measureList,args.itemUniqueName);if(($0.clientWidth<$0.offsetWidth)&&(this.$26)){if(this.$26.clientWidth>$0.clientWidth){this.$26.style.width=($0.clientWidth-9>0)?($0.clientWidth-9)+'px':'0px';}this.focusMeasure(this.$26);}}else{PPSMA.ReportsCommon.logErrorCondition('can\'t add measures to the drag container div '+this.$23+' because it couldn\'t be found');}}}else{var $3=$get(args.itemUniqueName);var $4=$3.parentNode;$4.removeChild($3);Array.remove(this.measureList,args.itemUniqueName);}}else{PPSMA.ReportsCommon.logErrorCondition('HandleThinFieldListItemSelected sender was NULL!');}},$2D:function($p0,$p1){this.$28();this.$22='2';if($p0===1){this.$22='1';this.$1D.setOuterTagAttribute('MeasureGroupName',this.$1D.get_measures().get_measureGroupName());this.$1D.applyMeasureSelectorChanges();}Array.clear(this.measureList);if(this.$20){this.$20();}},closeChangeMeasureDialog:function(e){this.$1F.close(0);},applyNewMeasureSelection:function(e){this.defineMeasureOrder();this.$1F.close(1);},defineMeasureOrder:function(){var $0=$get(this.$23);for(var $1=0;$1<$0.childNodes.length;$1++){var $2=$0.childNodes[$1];if($2){var $3=$2.id;this.$1E.reOrderItem($3,$1);}}},handleMeasureNameLinkClick:function(e){},handleMeasureNameLinkFocus:function(e){this.focusOnlyMeasure(e.target.parentNode.id);},blurMeasureListOnTabToFieldList:function(e){var $0=e.target.parentNode;if($0){if($0.className!=='dragBox'){PPSMA.ReportsCommon.logErrorCondition('BlurMeasureListOnTabToFieldList: i\'m not so sure we have a valid measure, we have tag='+$0.tagName+', ID='+$0.id+', className='+$0.className);}else{if(e.keyCode===9&&e.shiftKey&&$0.id===$0.parentNode.firstChild.id){this.focusOnlyMeasure('deadbeefdeadbeefdeadbeef');}}}else{PPSMA.ReportsCommon.logErrorCondition('BlurMeasureListOnTabToFieldList: couldn\'t get a measure dragbox from event target '+e.target.id);}},moveMeasureUp:function(measure){var $0=measure.parentNode;var $1=measure.id;if(measure.previousSibling){$0.insertBefore(measure,measure.previousSibling);this.focusMeasureAndMeasureNameLink($1);}},moveMeasureDown:function(measure){var $0=measure.parentNode;var $1=measure.id;if(measure.nextSibling){$0.insertBefore(measure.nextSibling,measure);this.focusMeasureAndMeasureNameLink($1);}},removeMeasureFromList:function(measure){var $0=measure.id;if(this.$1E.deSelectItem($0)){measure.parentNode.removeChild(measure);Array.remove(this.measureList,$0);}},handleRemoveMeasureLinkClick:function(e){var $0=null;var $1=null;if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'img')){$0=e.target.parentNode.parentNode;}else if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'a')){$0=e.target.parentNode;}else{PPSMA.ReportsCommon.logErrorCondition('HandleRemoveMeasureLinkClick: unidentified tag='+e.target.tagName+' id='+e.target.id);}if($0){if($0.nextSibling){$1=$0.nextSibling;}else if($0.previousSibling){$1=$0.previousSibling;}else{$1=$get('_ScrollList');if($1){var $2=$1.getElementsByTagName('input');$1=($2&&$2.length>0)?$2[0]:null;}}this.removeMeasureFromList($0);if($1&&$1.className==='dragBox'){this.focusMeasureAndMeasureNameLink($1.id);}else if($1&&$1.className==='chgMeasTflListCheckBox'){try{$1.focus();}catch($3){try{var $4=$get(this.$25);if($4){$4.focus();}else{PPSMA.ReportsCommon.logErrorCondition('HandleRemoveMeasureLinkClick: couldn\'t find ID=\''+this.$25+'\' to focus.');}}catch($5){PPSMA.ReportsCommon.logErrorCondition('HandleRemoveMeasureLinkClick: couldn\'t focus ID=\''+this.$25+'\' to focus.');}}}else{PPSMA.ReportsCommon.logErrorCondition('HandleRemoveMeasureLinkClick: couldn\'t find anything to focus.');}}else{PPSMA.ReportsCommon.logErrorCondition('HandleRemoveMeasureLinkClick: couldn\'t find anything to delete.');}},focusOnlyMeasure:function(uniqueMeasureId){var $0=$get(this.$23);if(!$0){PPSMA.ReportsCommon.logErrorCondition('FocusOnlyMeasure: can\'t find div '+this.$23);return;}for(var $1=0;$1<$0.childNodes.length;$1++){if(uniqueMeasureId===$0.childNodes[$1].id){this.focusMeasure($0.childNodes[$1]);}else{this.blurMeasure($0.childNodes[$1]);}}},focusMeasureAndMeasureNameLink:function(uniqueMeasureId){this.focusOnlyMeasure(uniqueMeasureId);var $0=$get(uniqueMeasureId);if($0&&$0.firstChild){$0.firstChild.focus();}else{PPSMA.ReportsCommon.logErrorCondition('FocusMeasureAndMeasureNameLink: couldn\'t focus measure and its first child for '+uniqueMeasureId);}},handleMeasureNameDivKeyup:function(e){var $0=e.keyCode;if($0===38||$0===40){var $1;if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'a')){$1=e.target.parentNode;}else{$1=e.target;}if($0===38&&$1.previousSibling){this.focusMeasureAndMeasureNameLink($1.previousSibling.id);}else if($0===40&&$1.nextSibling){this.focusMeasureAndMeasureNameLink($1.nextSibling.id);}}},handleMoveUpLinkClick:function(e){if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'img')){this.moveMeasureUp(e.target.parentNode.parentNode);}else if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'a')){this.moveMeasureUp(e.target.parentNode);}else{PPSMA.ReportsCommon.logErrorCondition('HandleMoveUpLinkClick: unidentified tag='+e.target.tagName+' id='+e.target.id);}},handleMoveDownLinkClick:function(e){if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'img')){this.moveMeasureDown(e.target.parentNode.parentNode);}else if(PPSMA.DomElementEx.tagsMatch(e.target.tagName,'a')){this.moveMeasureDown(e.target.parentNode);}else{PPSMA.ReportsCommon.logErrorCondition('HandleMoveDownLinkClick: unidentified tag='+e.target.tagName+' id='+e.target.id);}},skipToMeasureList:function(){this.$2F();var $0=$get(this.$23);if($0&&$0.hasChildNodes()&&$0.firstChild.hasChildNodes()){if(getBrowserIs().ie55up){this.focusMeasure($0.firstChild);}$0.firstChild.firstChild.focus();if(getBrowserIs().ie55up){$0.firstChild.firstChild.setActive();}}else{PPSMA.ReportsCommon.logErrorCondition('SkipToMeasureList: couldn\'t find the drag container or it doesn\'t have any measure children divs.');}},$2E:function($p0){this.$2F();this.skipToMeasureList();},handleTabMoverLinkKeydown:function(e){if(e.keyCode===9){this.$2F();}},$2F:function(){var $0=$get('tabMoverDivId');if($0){$0.style.display='none';}else{PPSMA.ReportsCommon.logErrorCondition('coudln\'t find div '+'tabMoverDivId'+' so that we could hide it');}},handleMeasureNameDivClick:function(e){if(PPSMA.DomElementEx.tagsMatch(e.target.className,'dragBox')){this.focusOnlyMeasure(e.target.id);}},focusMeasure:function(measure){this.$26=measure;var $0=0;measure.style.backgroundColor='#D2EAFF';measure.style.border='solid 1px #9EC7FC';while(measure.childNodes.length>1){measure.removeChild(measure.lastChild);}var $1=document.createElement('div');$1.id='upDownCloseRemoveBufferDivId';$1.innerHTML='&nbsp;';$1.style.styleFloat='left';$1.style.width='1px';measure.appendChild($1);var $2=document.createElement('a');$2.href='#';$2.id='upLinkId';measure.appendChild($2);Sys.UI.DomEvent.addHandler($2,'click',Function.createDelegate(this,this.handleMoveUpLinkClick));var $3=document.createElement('img');$3.id='muLinkImage';$3.src=this.$1D.get_resourcePath()+'pps_moveup.gif';$3.title=PPSMA.SR.OlapChangeMeasure_MoveUp;$3.alt=PPSMA.SR.OlapChangeMeasure_MoveUp;$3.style.border='0px';$2.appendChild($3);$0+=$2.offsetWidth;var $4=document.createElement('a');$4.href='#';$4.id='downLinkId';measure.appendChild($4);Sys.UI.DomEvent.addHandler($4,'click',Function.createDelegate(this,this.handleMoveDownLinkClick));var $5=document.createElement('img');$5.src=this.$1D.get_resourcePath()+'pps_movedown.gif';$5.id='mdLinkImage';$5.title=PPSMA.SR.OlapChangeMeasure_MoveDown;$5.alt=PPSMA.SR.OlapChangeMeasure_MoveDown;$5.style.border='0px';$4.appendChild($5);$0+=$4.offsetWidth;if(this.$1E.get_measuresLoaded()){var $7=document.createElement('a');$7.href='#';$7.id='removelinkId';measure.appendChild($7);Sys.UI.DomEvent.addHandler($7,'click',Function.createDelegate(this,this.handleRemoveMeasureLinkClick));var $8=document.createElement('img');$8.src=this.$1D.get_resourcePath()+'pps_remove.gif';$8.id='rmLinkImage';$8.title=PPSMA.SR.OlapChangeMeasure_Remove;$8.alt=PPSMA.SR.OlapChangeMeasure_Remove;$8.style.border='0px';$7.appendChild($8);$0+=$7.offsetWidth;}var $6=measure.firstChild;if($6){var $9=9;var $A=measure.clientWidth-$0-$9-9;$6.style.width=($A>125)?$A+'px':125+'px';}this.$2B();},blurMeasure:function(measure){if(measure){measure.style.backgroundColor='#FFFFFF';measure.style.border='solid 1px #ffffff';while(measure.childNodes.length!==1){measure.removeChild(measure.lastChild);}measure.firstChild.style.width=measure.clientWidth+'px';}}}
PPSMA.FilterDialog=function(olapViewContext,gridCtxName){this.$1F=olapViewContext;this.$17=null;this.$20=gridCtxName;this.$21=',';this.$22='.';if(olapViewContext){this.$23=this.$1F.get_ctrlProxyId();this.$1C=olapViewContext.get_resourcePath();this.$1D=olapViewContext.get_innerTargetId();}this.$15='0';this.$16=false;this.$1A=130;this.$19=500;}
PPSMA.FilterDialog.$35=function($p0){if(!$p0){return '';}var $0=$p0.getAttribute('value');if(!getBrowserIs().ie55up){var $1=$p0;$0=$1.value;}if(!$0){$0='';}return $0;}
PPSMA.FilterDialog.$36=function($p0,$p1){if(!$p0){return;}$p0.setAttribute('value',$p1);if(!getBrowserIs().ie55up){var $0=$p0;$0.value=$p1;}}
PPSMA.FilterDialog.$4D=function($p0,$p1){var $0=$p0;if($p0.length>1&&$p0.endsWith('%')){$p0=$p0.substring(0,$p0.length-1);$0=$p0;if(!$p1){try{var $1=parseFloat($p0);$1=$1/100;$0=$1.toString();}catch($2){$0=$p0;}}}return $0;}
PPSMA.FilterDialog.$52=function($p0,$p1,$p2,$p3,$p4){var $0=document.createElement('span');if($p2){$0.setAttribute('id',$p2);}$0.className=(($p3)?'FilterItemHidden':$p4);$0.innerHTML=$p1;$p0.appendChild($0);}
PPSMA.FilterDialog.$57=function($p0){$p0.click = '';}
PPSMA.FilterDialog.prototype={$0:1,$1:4,$2:7,$3:8,$4:9,$5:10,$6:11,$7:12,$8:13,$9:14,$A:0,$B:null,$C:null,$D:0,$E:null,$F:null,$10:null,$11:null,$12:null,$13:null,$14:null,$15:null,$16:false,$17:null,$18:null,$19:0,$1A:0,$1B:null,$1C:null,$1D:null,$1E:null,$1F:null,$20:null,$21:null,$22:null,$23:null,$24:null,$25:null,get_currentCell:function(){return this.$17;},set_currentCell:function(value){this.$17=value;return value;},get_filterType:function(){return this.$A;},set_filterType:function(value){this.$A=value;return value;},get_value1:function(){return this.$B;},set_value1:function(value){this.$B=value;return value;},get_value2:function(){return this.$C;},set_value2:function(value){this.$C=value;return value;},get_tupleIndex:function(){return this.$D;},set_tupleIndex:function(value){this.$D=value;return value;},get_tupleXML:function(){return this.$E;},set_tupleXML:function(value){this.$E=value;return value;},get_hierarchyName:function(){return this.$F;},set_hierarchyName:function(value){this.$F=value;return value;},get_axis:function(){return this.$10;},set_axis:function(value){this.$10=value;return value;},get_levelName:function(){return this.$11;},set_levelName:function(value){this.$11=value;return value;},setCallbackMethod:function(callback){this.$12=callback;},get_dimensionName:function(){return this.$13;},set_dimensionName:function(value){this.$13=value;return value;},get_callback:function(){return this.$14;},set_callback:function(value){this.$14=value;return value;},get_selectedButton:function(){return this.$15;},set_selectedButton:function(value){this.$15=value;return value;},get_showClearOption:function(){return this.$16;},set_showClearOption:function(value){this.$16=value;return value;},get_tupleOptionList:function(){return this.$1B;},set_tupleOptionList:function(value){this.$1B=value;return value;},get_proxyID:function(){return this.$23;},set_proxyID:function(value){this.$23=value;return value;},get_resourcePath:function(){return this.$1C;},set_resourcePath:function(value){this.$1C=value;return value;},get_innerTargetID:function(){return this.$1D;},set_innerTargetID:function(value){this.$1D=value;return value;},$26:function($p0,$p1,$p2){var $0=PPSMA.SizeEx.getCenterXandY(this.$19,this.$1A);var $1=SP.UI.$create_DialogOptions();$1.height=this.$1A;$1.width=this.$19;$1.title=$p1;$1.showMaximized=false;$1.allowMaximize=false;$1.html=$p2;$1.x=$0.x;$1.y=$0.y;$1.dialogReturnValueCallback=Function.createDelegate(this,this.$27);this.$18=SP.UI.ModalDialog.showModalDialog($1);var $2=$get(this.$23+((this.$A<7)?'IDTopFilterOptionsDropdown':'IDValueFilterTupleDropdown'));$2.focus();this.$29($p0);},$27:function($p0,$p1){this.$28();if($p0===1){if(this.$12){this.$12();}}},$28:function(){},$29:function($p0){var $0=$get(this.$23+'IDClearFilterBtn'+$p0);Sys.UI.DomEvent.addHandler($0,'click',Function.createDelegate(this,this.clear));var $1=$get(this.$23+'IDFilterApply'+$p0);Sys.UI.DomEvent.addHandler($1,'click',Function.createDelegate(this,this.apply));var $2=$get(this.$23+'IDFilterCancel'+$p0);Sys.UI.DomEvent.addHandler($2,'click',Function.createDelegate(this,this.cancel));var $3=(($p0==='IDValueFilterDialog')?1:2);switch($3){case 1:var $4=$get(this.$23+'IDValueFilterInput1');Sys.UI.DomEvent.addHandler($4,'change',Function.createDelegate(this,this.$31));Sys.UI.DomEvent.addHandler($4,'keyup',Function.createDelegate(this,this.$2F));var $5=$get(this.$23+'IDValueFilterInput2');Sys.UI.DomEvent.addHandler($5,'change',Function.createDelegate(this,this.$32));Sys.UI.DomEvent.addHandler($5,'keyup',Function.createDelegate(this,this.$30));var $6=$get(this.$23+'IDValueFilterOptionsDropdown');Sys.UI.DomEvent.addHandler($6,'change',Function.createDelegate(this,this.$34));break;case 2:var $7=$get(this.$23+'IDTopFilterInput');Sys.UI.DomEvent.addHandler($7,'change',Function.createDelegate(this,this.$5F));Sys.UI.DomEvent.addHandler($7,'keyup',Function.createDelegate(this,this.$5E));var $8=$get(this.$23+'IDTopVarOptionsDropdown');Sys.UI.DomEvent.addHandler($8,'change',Function.createDelegate(this,this.$61));break;}},showValueFilterDlg:function(){this.$1A=180;this.$19=465;this.$24=this.$C;if(!this.$11||this.$11===''){this.$11=this.$3C();}this.$1E=this.$2A();if(!this.$1E){this.$1E=this.$2B();}this.$1E.style.visibility='visible';var $0=document.createElement('div');$0.appendChild(this.$1E);var $1=PPSMA.SR.OlapFilter_ValueFilterHeader+' '+this.$11;this.$26('IDValueFilterDialog',$1,$0);},showTopFilterDlg:function(){this.$1A=180;this.$19=390;if(!this.$11||this.$11===''){this.$11=this.$3C();}this.$1E=this.$58();if(!this.$1E){this.$1E=this.$59();}this.$1E.style.visibility='visible';var $0=document.createElement('div');$0.appendChild(this.$1E);var $1=PPSMA.SR.OlapFilter_TopFilterHeader+' '+this.$11;this.$26('IDTopFilterDialog',$1,$0);},loadFilterDialog:function(sFilterTypeIndex,tuple,level,hierarchy,value1,value2,lastCell,axis){this.$A=parseInt(sFilterTypeIndex);var $0=(this.$A<7)?false:true;this.$F=hierarchy;this.$17=lastCell;this.$11=level;this.$10=axis;this.$B=value1;this.$C=value2;this.$16=true;var $1=this.$42();this.$25=tuple;var $2=this.$55();this.$D=0;for(var $3=0;$3<$2.length;$3++){var $4=$2[$3]+$1;if(!$4.indexOf(tuple)){this.$D=$3;break;}}if($0){this.showValueFilterDlg();}else{this.showTopFilterDlg();}},$2A:function(){var $0=$get(this.$23+'IDValueFilterDialog');if(!$0){return null;}this.$45(PPSMA.SR.OlapFilter_ValueFilterHeader+'&nbsp;'+this.$11);this.$3F('IDValueFilterOptionsDropdown');this.$43('IDValueFilterTupleDropdown');this.$44('IDValueFilterInput1');this.$41('IDValueFilterAndLabel');this.$46('IDValueFilterInput2');this.$47('IDValueFilterDialog');return $0;},$2B:function(){var $0=this.$2C(PPSMA.SR.OlapFilter_ValueFilterText);var $1=this.$37('IDValueFilterDialog',$0,this.$19+'px');return $1;},$2C:function($p0){var $0=this.$38($p0);var $1=this.$2D();$0.appendChild($1);var $2=this.$49('test',2,'IDValueFilterDialog');$0.appendChild($2);return $0;},$2D:function(){var $0=this.$23+'IDValueFilterInputDiv';var $1=$get($0);if(!$1){$1=document.createElement('div');$1.setAttribute('id',$0);$1.className='FilterInputDiv';var $2=document.createElement('div');var $3=1;this.$2E($3,$2);$1.appendChild($2);var $4=document.createElement('div');var $5=2;var $6=3;var $7=4;var $8=5;this.$2E($5,$4);this.$2E($6,$4);this.$2E($7,$4);this.$2E($8,$4);$1.appendChild($4);}return $1;},$2E:function($p0,$p1){switch($p0){case 1:this.$51($p1,this.$23+'IDValueFilterTupleDropdown',this.$D);break;case 2:this.$33($p1);break;case 3:this.$48($p1,this.$A,this.$B,this.$23+'IDValueFilterInput1',(this.$A<this.$8)?'ValueFilterInput':'FilterInputForBetween',true);break;case 4:PPSMA.FilterDialog.$52($p1,PPSMA.SR.OlapFilter_AndLabel,this.$23+'IDValueFilterAndLabel',(this.$A<this.$8)?true:false,'FilterLabelForBetween');break;case 5:this.$48($p1,this.$A,this.$C,this.$23+'IDValueFilterInput2','FilterInputForBetween',(this.$A<this.$8)?false:true);break;}},$2F:function($p0){if(this.$3A()){this.$50(false);return;}var $0=$get(this.$23+'IDValueFilterInput1');var $1=String.format(PPSMA.SR.OlapFilter_Number,'0');var $2=this.$4E($0,1,true,true,this.$21,this.$22,0,0,false,$1,'IDValueFilterDialog');if($2){var $3=$get(this.$23+'IDValueFilterInput2');var $4='';if($3){$4=PPSMA.FilterDialog.$35($3);}var $5=this.$4B($4,true,true,this.$21);if($5>0){$2=false;}}this.$50($2);},$30:function($p0){if(this.$3A()){this.$50(false);return;}var $0=$get(this.$23+'IDValueFilterInput2');var $1=String.format(PPSMA.SR.OlapFilter_Number,'0');var $2=this.$4E($0,2,true,true,this.$21,this.$22,0,0,false,$1,'IDValueFilterDialog');if($2){this.$24=PPSMA.FilterDialog.$35($0);var $3=$get(this.$23+'IDValueFilterInput1');var $4='';if($3){$4=PPSMA.FilterDialog.$35($3);}var $5=this.$4B($4,true,true,this.$21);if($5>0){$2=false;}}this.$50($2);},$31:function($p0){this.$2F($p0);var $0=$get(this.$23+'IDValueFilterInput1');this.$3E($0,false);},$32:function($p0){this.$30($p0);var $0=$get(this.$23+'IDValueFilterInput2');this.$3E($0,false);},$33:function($p0){var $0=document.createElement('select');var $1=this.$23+'IDValueFilterOptionsDropdown';$0.setAttribute('id',$1);$0.className='FilterValueOptionsDropdown';var $2=false;if(this.$A<7||this.$A>14){$2=true;}var $3=this.$3D(this.$2.toString(),PPSMA.SR.OlapFilter_Equals,this.$A===7);$0.appendChild($3);var $4=this.$3D(this.$3.toString(),PPSMA.SR.OlapFilter_NotEqual,this.$A===8);$0.appendChild($4);var $5=this.$3D(this.$4.toString(),PPSMA.SR.OlapFilter_GreaterThan,$2||this.$A===9);$0.appendChild($5);var $6=this.$3D(this.$5.toString(),PPSMA.SR.OlapFilter_GreaterThanOrEqual,this.$A===10);$0.appendChild($6);var $7=this.$3D(this.$6.toString(),PPSMA.SR.OlapFilter_LessThan,this.$A===11);$0.appendChild($7);var $8=this.$3D(this.$7.toString(),PPSMA.SR.OlapFilter_LessThanOrEqual,this.$A===12);$0.appendChild($8);var $9=this.$3D(this.$8.toString(),PPSMA.SR.OlapFilter_Between,this.$A===13);$0.appendChild($9);var $A=this.$3D(this.$9.toString(),PPSMA.SR.OlapFilter_NotBetween,this.$A===14);$0.appendChild($A);$p0.appendChild($0);},$34:function($p0){var $0=$get(this.$23+'IDValueFilterOptionsDropdown');if($0){var $1=$0;var $2=$0.getElementsByTagName('option');var $3=PPSMA.FilterDialog.$35($2[$1.selectedIndex]);var $4=parseInt($3);var $5=$get(this.$23+'IDValueFilterInput1');var $6=$get(this.$23+'IDValueFilterInput2');var $7=$get(this.$23+'IDValueFilterAndLabel');if($4===this.$8||$4===this.$9){$5.className='FilterInputForBetween';$7.className='FilterLabelForBetween';$6.className='FilterInputForBetween';}else{$5.className='ValueFilterInput';$7.className='FilterItemHidden';$6.className='FilterItemHidden';var $8=String.format(PPSMA.SR.OlapFilter_Number,'0');var $9=this.$4E($6,2,true,true,this.$21,this.$22,0,0,false,$8,'IDValueFilterDialog');if(!$9){this.$C=this.$24;PPSMA.FilterDialog.$36($6,this.$C);this.$30(null);}}}},$37:function($p0,$p1,$p2){var $0=this.$39($p0,$p2);$0.appendChild($p1);var $1=this.$3B($p0);$0.appendChild($1);document.body.appendChild($0);return $0;},$38:function($p0){var $0=document.createElement('div');$0.setAttribute('id',this.$23+'IDFilterDialogContents');$0.className='FilterDialogContents';var $1=document.createElement('div');$1.className='FilterLabelDiv';var $2=document.createElement('span');$2.className='FilterLabel';$2.innerHTML=$p0;$1.appendChild($2);$0.appendChild($1);return $0;},$39:function($p0,$p1){var $0=document.createElement('div');$0.setAttribute('id',this.$23+$p0);$0.className='FilterParentBorder';$0.style.height=(this.$1A-1)+'px';$0.style.width=$p1;$0.style.overflow='hidden';return $0;},$3A:function(){if(this.$1B&&this.$1B!==''){return false;}var $0=false;var $1=this.$1F.get_results();var $2=((this.$10==='1')?$1.get_rowMembers():$1.get_columnMembers());if(!$2||!$2.length){$0=true;}return $0;},handleClearFilterKeyEvent:function(e){var $0=e.keyCode;var $1=13;switch($0){case $1:alert('enter');this.clear(e);break;}},$3B:function($p0){var $0=document.createElement('Div');$0.setAttribute('id',this.$23+'IDFilterFooter');$0.className='FilterFooter';var $1=document.createElement('span');$1.setAttribute('id',this.$23+'IDClearFilterBtn'+$p0);$1.className=((this.$16)?'FilterClear':'FilterItemHidden');var $2=document.createElement('a');$2.tabIndex=0;Sys.UI.DomEvent.addHandler($2,'keyup',Function.createDelegate(this,this.handleClearFilterKeyEvent));var $3=document.createElement('img');$3.setAttribute('id',this.$23+'IDClearFilterBtnImage');$3.setAttribute('border','0');$3.className='FilterDialogHeaderImage';$3.setAttribute('src',this.$1C+'ClearFilter.gif');$2.appendChild($3);var $4=document.createElement('span');$4.setAttribute('id',this.$23+'IDClearFilterText');$4.innerHTML=PPSMA.SR.OlapFilter_Clear;$2.appendChild($4);$1.appendChild($2);$0.appendChild($1);var $5=document.createElement('input');$5.setAttribute('id',this.$23+'IDFilterApply'+$p0);$5.className=((this.$A<7)?'FilterApply':'ms-ButtonHeightWidth');$5.setAttribute('type','button');$5.setAttribute('value',PPSMA.SR.OlapChangeMeasure_Ok);$5.style.margin='5px 0px 8px 8px';$5.style.marginRight='8px';$5.style.marginTop='8px';$5.style.marginBottom='8px';if(this.$3A()){$5.disabled=true;}else{$5.disabled=false;}$0.appendChild($5);var $6=document.createElement('input');$6.setAttribute('id',this.$23+'IDFilterCancel'+$p0);$6.className=((this.$A<7)?'FilterCancel':'ms-ButtonHeightWidth');$6.setAttribute('type','button');$6.setAttribute('value',PPSMA.SR.OlapChangeMeasure_Cancel);$6.style.marginRight='15px';$6.style.marginTop='8px';$6.style.marginBottom='8px';$6.setAttribute('onkeydown',this.$20+'._valueFilter.handleTabEvent(event)');$0.appendChild($6);return $0;},$3C:function(){if(!this.$1F){return '';}var $0=((this.$10==='1')?this.$1F.get_results().get_columnHierarchies():this.$1F.get_results().get_rowHierarchies());var $1=$0.length-1;var $2=$0[$1];this.$13=$2.get_dimension();this.$13=this.$13.replace('[','');this.$13=this.$13.replace(']','');var $3=$2.get_highestLevelName();$3=$3.substring($3.lastIndexOf('.')+1,$3.length);$3=$3.replace('[','');$3=$3.replace(']','');if(($3.toLowerCase().indexOf(this.$13.toLowerCase()))<0){$3=this.$13+' '+$3;}return $3;},$3D:function($p0,$p1,$p2){var $0=document.createElement('option');$0.setAttribute('value',$p0);if($p2){$0.setAttribute('selected','selected');}$0.setAttribute('title',$p1);$0.innerHTML=$p1;return $0;},$3E:function($p0,$p1){if($p0){var $0=PPSMA.FilterDialog.$35($p0);if($0.toUpperCase().indexOf('E')>0){return;}var $1=new RegExp('^[0]+');$0=$0.replace($1,'');if(!$0||$0===''){$0='0';}while($0.indexOf(this.$21)>=0){$0=$0.replace(this.$21,'');}var $2=$0.split(this.$22);var $3=$2[0];var $4=($2.length>1)?this.$22+$2[1]:'';var $5=new RegExp('(\\d+)(\\d{3})');while($5.test($3)){$3=$3.replace($5,'$1'+this.$21+'$2');}PPSMA.FilterDialog.$36($p0,$3+(($p1)?'':$4));}},$3F:function($p0){var $0=$get(this.$23+$p0);if($0){var $1=$0.getElementsByTagName('option');for(var $2=0;$2<$1.length;$2++){var $3=PPSMA.FilterDialog.$35($1[$2]);var $4=parseInt($3);if($4===this.$A){$1[$2].setAttribute('selected','selected');}else{$1[$2].setAttribute('selected','');}}}},$40:function($p0){if(this.$A>6){return;}var $0=$get(this.$23+$p0);if($0){var $1=$0.getElementsByTagName('option');var $2=0;if(this.$A===2||this.$A===5){$2=1;}else if(this.$A===3||this.$A===6){$2=2;}for(var $3=0;$3<$1.length;$3++){var $4=PPSMA.FilterDialog.$35($1[$3]);var $5=parseInt($4);if($5===$2){$1[$3].setAttribute('selected','selected');}else{$1[$3].setAttribute('selected','');}}}},$41:function($p0){if(!this.$23){return;}var $0=$get(this.$23+$p0);if(!$0){return;}if(this.$A>=this.$2&&this.$A<=this.$7){$0.className='FilterItemHidden';}else if(this.$A>this.$7){$0.className='FilterLabelForBetween';}},$42:function(){var $0='';if(this.$1F.get_results()){var $1=this.$1F.get_results().get_filterMembers();if($1){for(var $2=0;$2<$1.length;$2++){var $3=$1[$2];if($3.get_name().startsWith('[Measures]')){$0=$0+', '+$3.get_caption();}}}}return $0;},$43:function($p0){var $0=$get(this.$23+$p0);if($0){var $1='';if(!this.$1B||this.$1B===''){var $4=$0.getElementsByTagName('option');while(true){if(!$4.length){break;}$0.removeChild($4[0]);}$1=this.$42();}var $2=this.$55();var $3=new Array($2.length);for(var $5=0;$5<$2.length;$5++){var $6=$2[$5];var $7=false;if($5===this.$D){$7=true;}var $8=$5.toString();$3[$5]=this.$3D($8,$6+$1,$7);$0.appendChild($3[$5]);}}},$44:function($p0){var $0=$get(this.$23+$p0);if(this.$A>=this.$2&&this.$A<=this.$7){$0.className='ValueFilterInput';}else if(this.$A>this.$7){$0.className='FilterInputForBetween';}PPSMA.FilterDialog.$36($0,this.$B);this.$3E($0,(this.$A===this.$0||this.$A===this.$1));},$45:function($p0){var $0=$get(this.$23+'IDFilterByLevelDisplay');if($0){$0.innerHTML=$p0;}},$46:function($p0){var $0=$get(this.$23+$p0);if(this.$A>=this.$2&&this.$A<=this.$7){$0.className='FilterItemHidden';}else if(this.$A>this.$7){$0.className='FilterInputForBetween';}PPSMA.FilterDialog.$36($0,this.$C);this.$3E($0,false);},$47:function($p0){var $0=$get(this.$23+'IDClearFilterBtn'+$p0);if($0){if(this.$16){$0.className='FilterClear';}else{$0.className='FilterItemHidden';}}},$48:function($p0,$p1,$p2,$p3,$p4,$p5){var $0=document.createElement('input');$0.setAttribute('id',$p3);$0.className=(($p5)?$p4:'FilterItemHidden');$0.setAttribute('type','text');$0.setAttribute('maxlength',100);PPSMA.FilterDialog.$36($0,$p2);this.$3E($0,($p1===1||$p1===4));$p0.appendChild($0);},$49:function($p0,$p1,$p2){var $0=this.$23+'IDNumericValidationWarning'+$p2;var $1=$get($0);if($1){return $1;}$1=document.createElement('div');$1.setAttribute('id',$0);$1.className='NumericValidationWarningDiv';for(var $5=0;$5<$p1;$5++){var $6=document.createElement('div');$6.style.visibility='hidden';$6.className='FilterWarningLabelDiv';var $7=document.createElement('img');$7.className='FilterDialogHeaderImage';$7.setAttribute('src',this.$1C+'WizardActionWarning.gif');$6.appendChild($7);var $8=document.createElement('span');$8.className='FilterWarningLabel';$8.innerHTML=$p0;$6.appendChild($8);$1.appendChild($6);}var $2=document.createElement('div');$2.style.visibility='hidden';$2.className='FilterWarningLabelDiv';var $3=document.createElement('img');$3.className='FilterDialogHeaderImage';$3.setAttribute('src',this.$1C+'WizardActionWarning.gif');$2.appendChild($3);var $4=document.createElement('span');$4.className='FilterWarningLabel';$4.innerHTML=$p0;$2.appendChild($4);return $1;},$4A:function($p0){var $0=$p0.toUpperCase().replace(this.$22,'');if($p0.toUpperCase().indexOf('+')>0||$p0.toUpperCase().indexOf('-')>0){$0=$0.replace('E+','').replace('E-','');}else{$0=$0.replace('E','');}return $0;},$4B:function($p0,$p1,$p2,$p3){while($p0.indexOf($p3)>=0){$p0=$p0.replace($p3,'');}if($p2&&!$p0.trim().indexOf('-')){$p0=$p0.replace('-','');}if($p0===''||!$p0){return 4;}if($p1&&!$p0.trim().indexOf('.')){var $5=$p0.replace('.','');if($5===''||!$5){return 4;}}var $0=new RegExp('^[0]+');$p0=$p0.replace($0,'');if(!$p0||$p0===''){$p0='0';}var $1=0;var $2;while($p0.indexOf($p3)>=0){$p0=$p0.replace($p3,'');}var $3=$p0.split(this.$22);var $4=(($p1)?2:1);$2=$3.length<=$4;if(!$2){$1=3;}if($2){$p0=this.$4A($p0);var $6=new RegExp('(\\D+)');$2=!$6.test($p0);if(!$2){$1=1;}}if($2&&!$p2){$2=$p0.indexOf('-')<0;if(!$2){$1=2;}}return $1;},$4C:function($p0){var $0=false;if(this.$A===this.$0||this.$A===this.$1){var $1=this.$5D();if($1===1){$0=true;}}return PPSMA.FilterDialog.$4D($p0,$0);},$4E:function($p0,$p1,$p2,$p3,$p4,$p5,$p6,$p7,$p8,$p9,$p10){if(!$p0){return true;}var $0=true;var $1=PPSMA.FilterDialog.$35($p0);$1=$1.trimStart().trimEnd();var $2;var $3=$p9;if(!$1||$1===''){$2=4;}else{var $8=new RegExp('^[0]+');$1=$1.replace($8,'');if(!$1||$1===''){$1='0';}$1=PPSMA.FilterDialog.$4D($1,$p8);$2=this.$4B($1,$p3,$p2,$p4);}if($2>0){$0=false;}else{while($1.indexOf($p4)>=0){$1=$1.replace($p4,'');}var $9=parseInt($1.replace($p4,''));if((!$p2&&$9<$p6)||($p7>0&&$9>$p7)){$0=false;}}var $4=$get(this.$23+'IDNumericValidationWarning'+$p10);var $5=$4.getElementsByTagName('div');var $6=$5[$p1-1];var $7=($2===4||$2===3);if(!$0&&!$7){var $A=this.$4F($3,$5[$5.length-1]);if(getBrowserIs().ie55up){$6.style.left=($p0.offsetLeft+PPSMA.FilterDialog.margiN_LEFT)+'px';}else{$6.style.left=$p0.offsetLeft+'px';}$6.className='FilterWarningLabelDiv';var $B=$6.getElementsByTagName('span');$6.style.visibility='visible';$6.setAttribute('role','alert');var $C=$B[0];$C.innerHTML=$3;$6.style.width=$A+'px';}else{$6.style.visibility='hidden';$6.setAttribute('role','');}return $0;},$4F:function($p0,$p1){$p1.className='FilterWarningLabelDiv';var $0=$p1.getElementsByTagName('span');var $1=$0[0];$1.innerHTML=$p0;return $p1.offsetWidth;},$50:function($p0){var $0=(this.$A>6);var $1=($0)?'IDValueFilterDialog':'IDTopFilterDialog';var $2=$get(this.$23+'IDFilterApply'+$1);if($2){if($p0){$2.className=((this.$A<7)?'FilterApply':'ms-ButtonHeightWidth');$2.disabled=false;this.$56($2,'apply');}else{$2.disabled=true;PPSMA.FilterDialog.$57($2);}}},$51:function($p0,$p1,$p2){var $0=document.createElement('select');$0.setAttribute('id',$p1);$0.className=($p1.indexOf('IDTopFilterTupleDropdown')>=0)?'TopFilterTupleDropdown':'FilterTupleDropdown';$0.setAttribute('name',$p1);$p0.appendChild($0);var $1=this.$42();var $2=this.$55();var $3=new Array($2.length);for(var $4=0;$4<$2.length;$4++){var $5=$2[$4];var $6=false;if($4===$p2){$6=true;}$3[$4]=this.$3D($4.toString(),$5+$1,$6);$0.appendChild($3[$4]);}$p0.appendChild($0);},$53:function(){var $0=this.$1F.get_results().get_rowHierarchies();if($0&&$0.length>0){return $0[$0.length-1];}return null;},$54:function($p0){var $0=this.$42();this.$D=-1;for(var $1=0;$1<$p0.length;$1++){var $2=$p0[$1];if($2.indexOf($0)<0){$2+=$0;}if(!$2.indexOf(this.$25)){this.$D=$1;break;}}if(this.$D===-1){Array.insert($p0,0,this.$25);}},$55:function(){var $0=[];if(this.$1B&&this.$1B!==''){var $3=this.$1B.split(':');for(var $4=0;$4<$3.length;$4++){Array.add($0,$3[$4]);}return $0;}var $1=this.$1F.get_results();var $2=((this.$10==='1')?$1.get_rowMembers():$1.get_columnMembers());if($2){var $5=$2.length;for(var $6=0;$6<$5;$6++){var $7='';for(var $8=0;$8<$2[$6].length;$8++){var $9=$2[$6][$8];$7=$7+$9.get_caption();if($8<$2[$6].length-1){$7=$7+', ';}}Array.add($0,$7);}}return $0;},$56:function($p0,$p1){var $0=PPSMA.EncodeEx.jsQuoteEncode(this.$20);$p0.click = eval('new Function(\''+$0+'._valueFilter.'+$p1+'(event);\');');},$58:function(){var $0=$get(this.$23+'IDTopFilterDialog');if(!$0){return null;}this.$45(PPSMA.SR.OlapFilter_TopFilterHeader+'&nbsp;'+this.$11);this.$3F('IDTopFilterOptionsDropdown');this.$43('IDTopFilterTupleDropdown');this.$40('IDTopVarOptionsDropdown');this.$44('IDTopFilterInput');this.$47('IDTopFilterDialog');return $0;},$59:function(){var $0=this.$5A(PPSMA.SR.OlapFilter_TopFilterText);var $1=this.$37('IDTopFilterDialog',$0,this.$19+'px');return $1;},$5A:function($p0){var $0=this.$38($p0);var $1=this.$5B();$0.appendChild($1);var $2=this.$49('test',2,'IDTopFilterDialog');$0.appendChild($2);return $0;},$5B:function(){var $0=this.$23+'IDTopFilterInputDiv';var $1=$get($0);if(!$1){$1=document.createElement('div');$1.setAttribute('id',$0);$1.className='FilterInputDiv';var $2=1;var $3=2;var $4=3;this.$5C($2,$1);this.$5C($3,$1);this.$5C($4,$1);var $5=this.$49('test',2,'IDTopFilterDialog');$1.appendChild($5);var $6=document.createElement('div');var $7=4;this.$5C($7,$6);$1.appendChild($6);var $8=document.createElement('div');var $9=5;this.$5C($9,$8);$1.appendChild($8);}return $1;},$5C:function($p0,$p1){switch($p0){case 1:this.$60($p1,this.$A);break;case 2:this.$48($p1,this.$A,this.$B,this.$23+'IDTopFilterInput','FilterInput',true);break;case 3:this.$62($p1,this.$A);break;case 4:PPSMA.FilterDialog.$52($p1,PPSMA.SR.OlapFilter_ByLabel,null,false,'FilterLabelForBy');break;case 5:this.$51($p1,this.$23+'IDTopFilterTupleDropdown',this.$D);break;}},$5D:function(){var $0=0;var $1=$get(this.$23+'IDTopVarOptionsDropdown');if($1){var $2=$1;$0=$2.selectedIndex;}return $0;},$5E:function($p0){if(this.$3A()){this.$50(false);return;}var $0=$get(this.$23+'IDTopFilterInput');var $1=this.$5D();var $2=0;var $3=0;var $4=false;var $5='';switch($1){case 0:$2=1;$3=2000000000;$5=String.format(PPSMA.SR.OlapFilter_NumberOnly);break;case 1:$3=100;$4=true;$5=String.format(PPSMA.SR.OlapFilter_NumberLimit,$2.toString(),$3.toString());break;case 2:$5=String.format(PPSMA.SR.OlapFilter_NumberGreaterThanZero,$2.toString());break;}var $6=this.$4E($0,1,false,true,this.$21,this.$22,$2,$3,$4,$5,'IDTopFilterDialog');this.$50($6);},$5F:function($p0){this.$5E($p0);var $0=$get(this.$23+'IDTopFilterInput');var $1=$get(this.$23+'IDTopVarOptionsDropdown');var $2=false;if($1){var $3=$1;if(!$3.selectedIndex){$2=true;}}this.$3E($0,$2);},$60:function($p0,$p1){var $0=document.createElement('select');var $1=this.$23+'IDTopFilterOptionsDropdown';$0.setAttribute('id',$1);$0.className='FilterTopOptionsDropdown';$0.setAttribute('name','IDTopFilterOptionsDropdown');var $2=($p1>3)?4:1;var $3=this.$3D('1',PPSMA.SR.OlapFilter_Top,$2===1);$0.appendChild($3);var $4=this.$3D('4',PPSMA.SR.OlapFilter_Bottom,$2===4);$0.appendChild($4);$p0.appendChild($0);},$61:function($p0){this.$5E($p0);},$62:function($p0,$p1){var $0=($p1-1)%3;var $1=document.createElement('select');var $2=this.$23+'IDTopVarOptionsDropdown';$1.setAttribute('id',$2);$1.className='FilterTopVarDropdown';$1.setAttribute('name','IDTopVarOptionsDropdown');var $3=this.$3D('0',PPSMA.SR.OlapFilter_Count,!$0);$1.appendChild($3);var $4=this.$3D('1',PPSMA.SR.OlapFilter_Percent,$0===1);$1.appendChild($4);var $5=this.$3D('2',PPSMA.SR.OlapFilter_Sum,$0===2);$1.appendChild($5);$p0.appendChild($1);},apply:function(e){this.$63();this.$15='1';this.$18.close(1);},$63:function(){var $0=this.$F;if(isNullUndefinedOrEmpty($0)){var $D=null;if(!this.$17&&this.$1F.get_results().get_rowHierarchies()&&this.$1F.get_results().get_rowHierarchies().length>0){$D=this.$1F.get_results().get_rowHierarchies()[0];}else{$D=this.$53();}if($D){$0=$D.get_name();}}var $1=true;if(this.$A<7){$1=false;}this.$F=$0;var $2=$get(this.$23+(($1)?'IDValueFilterOptionsDropdown':'IDTopFilterOptionsDropdown'));var $3=$get(this.$23+(($1)?'IDValueFilterInput1':'IDTopFilterInput'));var $4=$get(this.$23+'IDValueFilterInput2');var $5=$get(this.$23+(($1)?'IDValueFilterTupleDropdown':'IDTopFilterTupleDropdown'));if(!this.$11||this.$11===''){this.$11=this.$3C();}var $6=$5.children;if(!$6){$6=$5.childNodes;}var $7=$5;var $8=PPSMA.FilterDialog.$35($6[$7.selectedIndex]);try{this.$D=parseInt($8);}catch($E){this.$D=0;}if(this.$1F){var $F=new PPSMA.DetailsHelper(this.$1F,this.$20,((this.$10==='1')?this.$D:0),((this.$10==='1')?0:this.$D),'');this.$E=$F.getCellTupleXml();}this.$B=PPSMA.FilterDialog.$35($3);this.$B=this.$4C(this.$B);if($4){this.$C=PPSMA.FilterDialog.$35($4);this.$C=this.$4C(this.$C);}else{this.$C='0';}var $9=$2.getElementsByTagName('option');var $A=$2;var $B=PPSMA.FilterDialog.$35($9[$A.selectedIndex]);var $C;try{$C=parseInt($B);}catch($10){$C=1;}if($C<6){this.$5F(null);var $11=$get(this.$23+'IDTopVarOptionsDropdown');var $12=$11.getElementsByTagName('option');var $13=$11;var $14=PPSMA.FilterDialog.$35($12[$13.selectedIndex]);var $15=parseInt($14);$C=$C+$15;}this.$A=$C;if(this.$A===this.$8||this.$A===this.$9){this.$64();}},$64:function(){var $0=this.$B;var $1=this.$C;while($0.indexOf(this.$21)>=0){$0=$0.replace(this.$21,'');}while($1.indexOf(this.$21)>=0){$1=$1.replace(this.$21,'');}var $2=parseInt($0);var $3=parseInt($1);if($2>$3){var $4=this.$B;this.$B=this.$C;this.$C=$4;}},cancel:function(e){this.$15='2';this.$18.close(1);},clear:function(e){this.$15='3';this.$18.close(1);},handleTabEvent:function(e){var $0=9;var $1=PPSMA.EventsEx.getEvent(e);var $2=$1.keyCode;if($2!==$0){return;}if($1.shiftKey){return;}var $3=PPSMA.EventsEx.getCurrentElement(e);var $4=$3.getAttribute('id');if($4===this.$23+'IDFilterCancel'+'IDValueFilterDialog'){var $5=$get(this.$23+'IDValueFilterInputDiv');$5.focus();}else if($4===this.$23+'IDFilterCancel'+'IDTopFilterDialog'){var $6=$get(this.$23+'IDTopFilterInputDiv');$6.focus();}}}
PPSMA.DOMElementForFireFox=function(){PPSMA.DOMElementForFireFox.initializeBase(this);}
PPSMA.DOMElementForFireFox.prototype={value:null}
PPSMA.Toolbar=function(olapViewContext,toolbarContextId){this.$0=olapViewContext;this.$1=toolbarContextId;}
PPSMA.Toolbar.prototype={$0:null,$1:null,handleLinksBeforeAndAfterSkipToolbarDivKeyup:function(e){var $0=e.srcElement;if($0){if($0.id&&$0.id===this.$0.get_ctrlProxyId()+'_bstr'){if(e.keyCode===9){if(e.shiftKey){this.hideSkipToolbarDiv();}else{this.showSkipToolbarDiv();}}}else if($0.id&&$0.id===this.$0.get_ctrlProxyId()+'_astr'){if(e.keyCode===9){if(e.shiftKey){this.showSkipToolbarDiv();}else{this.hideSkipToolbarDiv();}}}}else{PPSMA.ReportsCommon.logErrorCondition('can\'t find what was focused');}},showSkipToolbarDiv:function(){var $0=$get(this.$0.get_ctrlProxyId()+'_skipToolBar');if($0){$0.style.display='block';$0.firstChild.focus();}else{PPSMA.ReportsCommon.logErrorCondition('couldn\'t find '+this.$0.get_ctrlProxyId()+'_skipToolBar');}},hideSkipToolbarDiv:function(){var $0=$get(this.$0.get_ctrlProxyId()+'_skipToolBar');if($0){$0.style.display='none';}else{PPSMA.ReportsCommon.logErrorCondition('couldn\'t find '+this.$0.get_ctrlProxyId()+'_skipToolBar');}},handleSkipToReportLinkClick:function(){this.hideSkipToolbarDiv();this.$0.get_reportContext().assignFocus();}}
PPSMA.OlapWebRequest=function(containerElement,cancelCallback){if(isNullOrUndefined(containerElement)){return;}this.$0=new PPSMA.CancellableWebRequest(containerElement);this.$0.add_onCancelled(Function.createDelegate(this,this.$3));this.$2=cancelCallback;}
PPSMA.OlapWebRequest.prototype={$0:null,$1:null,$2:null,dispose:function(){if(this.$0){this.$0.dispose();this.$0=null;}if(this.$1){if(!isNullOrUndefined(this.$1.get_executor())&&!this.$1.get_executor().get_aborted()){this.$1.get_executor().abort();}this.$1=null;}},$3:function($p0){if(this.$2){this.$2();}},show:function(){if(this.$0){this.$0.show();}},hide:function(){if(this.$0){this.$0.hide();}},submit:function(details){if(this.$0){this.$0.submit(details);}else{if(this.$1){this.$1.get_executor().abort();}this.$1=new Sys.Net.WebRequest();this.$1.set_url(details.url);this.$1.set_body(details.body);this.$1.set_httpVerb(details.httpVerb);this.$1.get_headers()['Content-Type']=details.contentType;this.$1.add_completed(details.completedCallback);this.$1.invoke();}}}
Type.registerNamespace('AjaxFX');AjaxFX.HistoryEventArgs=function(entryName){AjaxFX.HistoryEventArgs.initializeBase(this);this.$1_0=entryName;}
AjaxFX.HistoryEventArgs.prototype={$1_0:null,get_entryName:function(){return this.$1_0;}}
AjaxFX.HistoryManager=function(enabled,iframe){this.$9=new Sys.EventHandlerList();this.$0=enabled;this.$1=iframe;this.$A=500;}
AjaxFX.HistoryManager.createHistory=function(target,iframeUrl){if(AjaxFX.HistoryManager.$D){AjaxFX.HistoryManager.$D.dispose();}AjaxFX.HistoryManager.$D=null;if(Sys.Browser.agent!==Sys.Browser.InternetExplorer&&Sys.Browser.agent!==Sys.Browser.Firefox&&Sys.Browser.agent!==Sys.Browser.Safari){AjaxFX.HistoryManager.$D=new AjaxFX.HistoryManager(false,null);}else{var $0=null;if(Sys.Browser.name==='Microsoft Internet Explorer'){AjaxFX.HistoryManager.$16(target,iframeUrl);$0=$get('_historyFrame');}AjaxFX.HistoryManager.$D=new AjaxFX.HistoryManager(true,$0);}AjaxFX.HistoryManager.$D.$10();return AjaxFX.HistoryManager.$D;}
AjaxFX.HistoryManager.$16=function($p0,$p1){if($p0){var $0=document.createElement('iframe');$0.id='_historyFrame';$0.style.display='none';$0.src=$p1;$p0.parentNode.insertBefore($0,$p0);}}
AjaxFX.HistoryManager.prototype={$0:false,$1:null,$2:null,$3:null,$4:false,$5:false,$6:false,$7:null,$8:null,$A:0,$B:0,$C:null,get_isEnabled:function(){return this.$0;},add_navigated:function(value){this.$9.addHandler(AjaxFX.HistoryManager.$E,value);},remove_navigated:function(value){this.$9.removeHandler(AjaxFX.HistoryManager.$E,value);},addEntry:function(entryName){if(!this.$0){return;}this.$5=true;if(this.$1&&!this.$4){this.$6=true;this.$1.src=this.$2+entryName;if(Sys.Browser.name==='Microsoft Internet Explorer'){if(window.navigator.userAgent.search(new RegExp('Trident'))>=0||Sys.Browser.version===8){this.$4=true;}}}else{this.$15(entryName);}},dispose:function(){if(this.$1){Sys.UI.DomEvent.clearHandlers(this.$1);this.$1=null;}if(this.$B){window.clearTimeout(this.$B);}},$F:function(){var $0=window.location.hash;if(($0.length)&&($0.charAt(0)==='#')){$0=$0.substr(1);}return $0;},goBack:function(){window.history.back();},goForward:function(){window.history.forward();},$10:function(){if(!this.$0){return;}this.$8=Function.createDelegate(this,this.$12);this.$C=Function.createDelegate(this,this.$11);this.$B=window.setTimeout(this.$C,this.$A);if(this.$1){var $0=this.$1.src.indexOf('?');if($0>0){this.$2=this.$1.src.substr(0,$0)+'?';}else{this.$2=this.$1.src+'?';}this.$3=Function.createDelegate(this,this.$13);Sys.UI.DomEvent.addHandler(this.$1,'load',this.$3);}this.$7=this.$F();this.$14(this.$7);Sys.Application.registerDisposableObject(this);},$11:function(){this.$B=0;if(this.$8){this.$8(this,Sys.EventArgs.Empty);this.$B=window.setTimeout(this.$C,this.$A);}},$12:function($p0,$p1){var $0=this.$F();if($0!==this.$7){if(this.$5){return;}this.$7=$0;this.$14($0);}else{this.$5=false;}},$13:function($p0){var $0=this.$1.contentWindow.location.search;if(($0.length)&&($0.charAt(0)==='?')){$0=$0.substr(1);}this.$15($0);if(this.$6){this.$6=false;return;}this.$14($0);if(Sys.Browser.name==='Microsoft Internet Explorer'){if(window.navigator.userAgent.search(new RegExp('Trident'))>=0||Sys.Browser.version===8){this.$4=false;}}},$14:function($p0){var $0=this.$9.getHandler(AjaxFX.HistoryManager.$E);if($0){$0(this,new AjaxFX.HistoryEventArgs($p0));}},$15:function($p0){window.location.hash=$p0;this.$7=this.$F();}}
PPSMA.Dimension.registerClass('PPSMA.Dimension');PPSMA.DimensionProperties.registerClass('PPSMA.DimensionProperties');PPSMA.Hierarchy.registerClass('PPSMA.Hierarchy');PPSMA.Level.registerClass('PPSMA.Level');PPSMA.ResultHierarchy.registerClass('PPSMA.ResultHierarchy');PPSMA.ResultMemberProperties.registerClass('PPSMA.ResultMemberProperties');PPSMA.Results.registerClass('PPSMA.Results');PPSMA.Member.registerClass('PPSMA.Member');PPSMA.ReportsCommon.registerClass('PPSMA.ReportsCommon');PPSMA.DialogsCommon.registerClass('PPSMA.DialogsCommon');PPSMA.ContextMenu.registerClass('PPSMA.ContextMenu');PPSMA.ShowProperties.registerClass('PPSMA.ShowProperties');PPSMA.ThinFieldListItemSelectedEventArgs.registerClass('PPSMA.ThinFieldListItemSelectedEventArgs',Sys.EventArgs);PPSMA.ThinFieldList.registerClass('PPSMA.ThinFieldList');PPSMA.BaseMeasureKpi.registerClass('PPSMA.BaseMeasureKpi');PPSMA.Kpi.registerClass('PPSMA.Kpi',PPSMA.BaseMeasureKpi);PPSMA.Measure.registerClass('PPSMA.Measure',PPSMA.BaseMeasureKpi);PPSMA.Folder.registerClass('PPSMA.Folder');PPSMA.Measures.registerClass('PPSMA.Measures');PPSMA.DetailsHelper.registerClass('PPSMA.DetailsHelper');PPSMA.DrillDownToHelper.registerClass('PPSMA.DrillDownToHelper');PPSMA.AnalyzeInDecompHelper.registerClass('PPSMA.AnalyzeInDecompHelper');PPSMA.MenuOptionHelper.registerClass('PPSMA.MenuOptionHelper');PPSMA.SubMenu.registerClass('PPSMA.SubMenu');PPSMA.OlapViewContext.registerClass('PPSMA.OlapViewContext',null,Sys.IDisposable);PPSMA.ChangeMeasure.registerClass('PPSMA.ChangeMeasure');PPSMA.FilterDialog.registerClass('PPSMA.FilterDialog');PPSMA.DOMElementForFireFox.registerClass('PPSMA.DOMElementForFireFox',Object);PPSMA.Toolbar.registerClass('PPSMA.Toolbar');PPSMA.OlapWebRequest.registerClass('PPSMA.OlapWebRequest');AjaxFX.HistoryEventArgs.registerClass('AjaxFX.HistoryEventArgs',Sys.EventArgs);AjaxFX.HistoryManager.registerClass('AjaxFX.HistoryManager',null,Sys.IDisposable);PPSMA.ReportsCommon.wsS_ACCESSIBILITYFEATURE_COOKIE_KEY='WSS_AccessibilityFeature';PPSMA.ContextMenu.$0=null;PPSMA.ContextMenu.$1=null;PPSMA.ThinFieldList.divIDListContainer='_ScrollList';PPSMA.ThinFieldList.ulidDisplayObjectParent='_ULDisplayObjects';PPSMA.ThinFieldList.divIDThinFieldListMain='_ThinFieldListDiv';PPSMA.Kpi.classThinFieldListLI='chgMeasTflListItem';PPSMA.Kpi.classThinFieldListCheckBox='chgMeasTflListCheckBox';PPSMA.Kpi.listElemID='_kli';PPSMA.Kpi.kpiComponentSize=4;PPSMA.Kpi.kpI_GOAL_INDEX=0;PPSMA.Kpi.kpI_VALUE_INDEX=1;PPSMA.Kpi.kpI_STATUS_INDEX=2;PPSMA.Kpi.kpI_TREND_INDEX=3;PPSMA.Measure.classThinFieldListLI='chgMeasTflListItem';PPSMA.Measure.classThinFieldListCheckBox='chgMeasTflListCheckBox';PPSMA.Measure.listElemID='_mli';PPSMA.Folder.classExCoA='chgMeasExCoA';PPSMA.Folder.classExCoImg='chgMeasExCoImg';PPSMA.Folder.listElemID='_fli_';PPSMA.Folder.parentChildDelimitor='\\';PPSMA.Folder.multipleFoldersDelimitor=';';PPSMA.Measures.noAxisSelected='none';PPSMA.Measures.measureGroupID='mg_';PPSMA.Measures.measureGroupALLID='_ALL_';PPSMA.Measures.measureGroupDropDownComboxBoxID='MeasureGroupsDropDownSelect';PPSMA.Measures.measureGroupDropDownComboxBoxWrapperDivID='MeasureGroupsDropDownSelectWrapperDiv';PPSMA.Measures.comboBoxDefaultHeight_IE=20;PPSMA.Measures.comboBoxDefaultHeight_FF=23;PPSMA.Measures.paddingOffset=10;PPSMA.Measures.folderCount=0;PPSMA.OlapViewContext.globalIds={};PPSMA.OlapViewContext.menU_METADATA_HEADER_TYPE='MenuMetadata-Type';PPSMA.ChangeMeasure.initialChangeMeasureWidth=400;PPSMA.ChangeMeasure.initialChangeMeasureHeight=286;PPSMA.ChangeMeasure.initialMeasureNameLinkWidth=125;PPSMA.ChangeMeasure.idFieldList='flId';PPSMA.FilterDialog.margiN_LEFT=15;PPSMA.FilterDialog.classFilterParentBorder='FilterParentBorder';PPSMA.FilterDialog.classFilterDialogHeaderImage='FilterDialogHeaderImage';PPSMA.FilterDialog.classFilterDialogContents='FilterDialogContents';PPSMA.FilterDialog.classFilterLabelDiv='FilterLabelDiv';PPSMA.FilterDialog.classFilterLabel='FilterLabel';PPSMA.FilterDialog.classFilterLabelForBy='FilterLabelForBy';PPSMA.FilterDialog.classFilterLabelForBetween='FilterLabelForBetween';PPSMA.FilterDialog.classFilterInputDiv='FilterInputDiv';PPSMA.FilterDialog.classFilterClear='FilterClear';PPSMA.FilterDialog.classFilterApply='ms-ButtonHeightWidth';PPSMA.FilterDialog.classFilterCancel='ms-ButtonHeightWidth';PPSMA.FilterDialog.classFilterApplyForTopCount='FilterApply';PPSMA.FilterDialog.classFilterCancelForTopCount='FilterCancel';PPSMA.FilterDialog.classFilterFooter='FilterFooter';PPSMA.FilterDialog.classFilterTupleDropdown='FilterTupleDropdown';PPSMA.FilterDialog.classTopFilterTupleDropdown='TopFilterTupleDropdown';PPSMA.FilterDialog.classFilterTopOptionsDropdown='FilterTopOptionsDropdown';PPSMA.FilterDialog.classFilterTopVarDropdown='FilterTopVarDropdown';PPSMA.FilterDialog.classFilterValueOptionsDropdown='FilterValueOptionsDropdown';PPSMA.FilterDialog.classFilterValueAndOrDropdown='FilterValueAndOrDropdown';PPSMA.FilterDialog.classNumericValidationWarningDiv='NumericValidationWarningDiv';PPSMA.FilterDialog.classFilterItemHidden='FilterItemHidden';PPSMA.FilterDialog.classFilterInput='FilterInput';PPSMA.FilterDialog.classvalueFilterInput='ValueFilterInput';PPSMA.FilterDialog.classFilterInputForBetween='FilterInputForBetween';PPSMA.FilterDialog.classFilterWarningLabel='FilterWarningLabel';PPSMA.FilterDialog.classFilterWarningLabelDiv='FilterWarningLabelDiv';PPSMA.FilterDialog.idValueFilterDialog='IDValueFilterDialog';PPSMA.FilterDialog.idTopFilterDialog='IDTopFilterDialog';PPSMA.FilterDialog.idFilterDialogContents='IDFilterDialogContents';PPSMA.FilterDialog.idFilterApply='IDFilterApply';PPSMA.FilterDialog.idFilterCancel='IDFilterCancel';PPSMA.FilterDialog.idFilterFooter='IDFilterFooter';PPSMA.FilterDialog.idTopFilterTupleDropdown='IDTopFilterTupleDropdown';PPSMA.FilterDialog.idValueFilterTupleDropdown='IDValueFilterTupleDropdown';PPSMA.FilterDialog.idValueFilterOptionsDropdown='IDValueFilterOptionsDropdown';PPSMA.FilterDialog.idTopFilterOptionsDropdown='IDTopFilterOptionsDropdown';PPSMA.FilterDialog.idTopVarOptionsDropdown='IDTopVarOptionsDropdown';PPSMA.FilterDialog.idNumericValidationWarning='IDNumericValidationWarning';PPSMA.FilterDialog.idValueFilterInput1='IDValueFilterInput1';PPSMA.FilterDialog.idValueFilterInput2='IDValueFilterInput2';PPSMA.FilterDialog.idValueFilterAndLabel='IDValueFilterAndLabel';PPSMA.FilterDialog.idTopFilterInput='IDTopFilterInput';PPSMA.FilterDialog.idTopFilterInputDiv='IDTopFilterInputDiv';PPSMA.FilterDialog.idValueFilterInputDiv='IDValueFilterInputDiv';PPSMA.FilterDialog.idClearFilterBtn='IDClearFilterBtn';PPSMA.FilterDialog.idClearFilterBtnImage='IDClearFilterBtnImage';PPSMA.FilterDialog.idClearFilterText='IDClearFilterText';PPSMA.FilterDialog.idFilterByLevelDisplay='IDFilterByLevelDisplay';AjaxFX.HistoryManager.$D=null;AjaxFX.HistoryManager.$E='Navigated';
// ---- Do not remove this footer ----
// Generated using Script# v0.5.0.0 (http://projects.nikhilk.net)
// -----------------------------------
function _ovc(s){return PPSMA.OlapViewContext.globalIds[s];}
function _ovrc(s){return PPSMA.OlapViewContext.globalIds[s].get_reportContext();}
function _ovtc(s){return PPSMA.OlapViewContext.globalIds[s].get_toolbar();}
function isValidBrowser(){return(browseris.ie55up||browseris.nav6up||browseris.safari125up);}
function isSilverlightInstalled(version){return Silverlight.isInstalled(version);}
function byid(id){return document.getElementById(id);}
function newE(tag){return document.createElement(tag);}
function wpf(){return document.forms[MSOWebPartPageFormName];}
function startReplacement(){}
Type.registerNamespace('PPSMA');PPSMA.Menu=function(){};PPSMA.Menu.AttachEvent=function PPSMA_Menu$AttachEvent(eventName,eventFunc,el){if(!el)el=window;if(eventName=='domLoad'){eventName=el.addEventListener&&ppsbrowseris.nav?'DOMContentLoaded':'load';} if(typeof(eventFunc)=='string')eventFunc=new Function(eventFunc);if(el.addEventListener)el.addEventListener(eventName,eventFunc,false);else el.attachEvent('on'+eventName,eventFunc);}
PPSMA.Menu.CancelEvent=function PPSMA_Menu$CancelEvent(e){e.cancelBubble=true;e.returnValue=false;}
PPSMA.Menu.GetEventSrcElement=function PPSMA_Menu$GetEventSrcElement(e){return e.srcElement;}
PPSMA.Menu.GetEventKeyCode=function PPSMA_Menu$GetEventKeyCode(e){return e.keyCode;}
PPSMA.Menu.GetInnerText=function PPSMA_Menu$GetInnerText(e){return e.innerText;}
var kfnDisableEvent=new Function("return false");PPSMA.Menu.g_lastMenu=null;PPSMA.Menu.g_uniqueNumber=0;PPSMA.Menu.IsAccessibilityFeatureEnabledProxy=function PPSMA_Menu$IsAccessibilityFeatureEnabledProxy(){if(typeof(IsAccessibilityFeatureEnabled)!="undefined")return IsAccessibilityFeatureEnabled();return false;}
PPSMA.Menu.GetType=function PPSMA_Menu$GetType(oMaster){if(oMaster==null)return"menu";else return oMaster._menuType;}
PPSMA.Menu.Show=function PPSMA_Menu$Show(oMaster,oParent,fForceRefresh,fFlipTop,xOffset,yOffset){if(!(ppsbrowseris.ie55up||ppsbrowseris.nav6up||ppsbrowseris.safari125up))return false;PPSMA.Menu.Hide();PPSMA.Menu.Init(oMaster);oMaster._oParent=oParent;oMaster._fIsRtL=PPSMA.Menu.IsElementRtl(oMaster._oParent);if((ppsbrowseris.ie||ppsbrowseris.nav)&&PPSMA.Menu.IsAccessibilityFeatureEnabledProxy()){var menu=null;if(oParent.foa!=null){menu=byid(oParent.foa);if(menu==null){menu=eval(oParent.foa);}} if(menu!=null&&menu.onblur!=null){menu.onblur();} PPSMA.Menu.RenderAccessibleMenu(oMaster,fForceRefresh);PPSMA.Menu.g_lastMenu=oMaster;} else{PPSMA.Menu.SetBodyEventHandlers(null,false);PPSMA.Menu.AssureId(oParent);var result=PPSMA.Menu.ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,xOffset,yOffset);PPSMA.Menu.g_lastMenu=oMaster;PPSMA.Menu.NavigateToMenu(oMaster);PPSMA.Menu.SetBodyEventHandlers(PPSMA.Menu.HandleDocumentBodyClick,PPSMA.Menu.GetType(oMaster)=="tooltip");} if(ppsbrowseris.ie){if(window.event!=null)window.event.cancelBubble=true;} return false;}
PPSMA.Menu.Hide=function PPSMA_Menu$Hide(){PPSMA.Menu.ClearTimeoutToHideMenu();var oMaster=PPSMA.Menu.g_lastMenu;if(oMaster!=null){if(oMaster._accessibleMenu!=null){PPSMA.Menu.CloseAccessibleMenu(oMaster);} else{PPSMA.Menu.HideMenu(oMaster);}} PPSMA.Menu.g_lastMenu=null;}
PPSMA.Menu.IsOpen=function PPSMA_Menu$IsOpen(oMaster){if(!oMaster||!oMaster._initialized)return false;var result=PPSMA.Menu.IsOpenInternal(oMaster);return result;}
PPSMA.Menu.Item=function PPSMA_Menu$Item(oMaster,nLevel,nIndex){PPSMA.Menu.Init(oMaster);var result=PPSMA.Menu.GetItem(oMaster,nLevel,nIndex);return result;}
PPSMA.Menu.TrapMenuClick=function PPSMA_Menu$TrapMenuClick(e){if(e!=null){PPSMA.Menu.CancelEvent(e);} return false;}
PPSMA.Menu.SetBodyEventHandlers=function PPSMA_Menu$SetBodyEventHandlers(h,handleContextMenu){if("ontouchstart"in window){document.ontouchstart=h;} else{document.onmousedown=h;}}
PPSMA.Menu.HandleDocumentBodyClick=function PPSMA_Menu$HandleDocumentBodyClick(e){var currEvent=PPSMA.EventsEx.getEvent(e);if(PPSMA.Menu.g_lastMenu!=null){PPSMA.Menu.HideMenu(PPSMA.Menu.g_lastMenu);} return false;}
PPSMA.Menu.GetEventPopup=function PPSMA_Menu$GetEventPopup(e){var obj=PPSMA.Menu.GetEventSrcElement(e);while(obj!=null){if(obj.master!=null)return obj;obj=obj.parentNode;} return null;}
PPSMA.Menu.GetUniqueNumber=function PPSMA_Menu$GetUniqueNumber(){PPSMA.Menu.g_uniqueNumber++;return PPSMA.Menu.g_uniqueNumber;}
PPSMA.Menu.Init=function PPSMA_Menu$Init(oMaster){if(oMaster._initialized)return;oMaster._initialized=true;oMaster._wzPrefixID="mp"+PPSMA.Menu.GetUniqueNumber();if(oMaster.id==null)oMaster.id=oMaster._wzPrefixID+"_id";oMaster._nLevel=0;oMaster._arrPopup=new Array();oMaster._arrSelected=new Array();if(typeof(oMaster._onDestroy)=="undefined")oMaster._onDestroy=null;oMaster._fLargeIconMode=false;oMaster._fCompactItemsWithoutIcons=false;}
PPSMA.Menu.PrepContents=function PPSMA_Menu$PrepContents(oMaster){oMaster._fLargeIconMode=(oMaster.getAttribute("largeIconMode")=="true");oMaster._fCompactItemsWithoutIcons=(oMaster.getAttribute("CompactMode")=="true");if(!ppsbrowseris.safari){oMaster._oContents=document.createElement("span");oMaster._oContents.style.display="none";oMaster._oContents.innerHTML=oMaster.innerHTML;} else{oMaster._oContents=oMaster.cloneNode(true);oMaster._oContents.style.display="none";} if(PPSMA.Menu.GetType(oMaster)=="tooltip"){oMaster._wzMenuStyle="bsm-ToolTipUI";} else{if(oMaster._fLargeIconMode){if(oMaster._fIsRtL)oMaster._wzMenuStyle="bsm-MenuUILargeRtL";else oMaster._wzMenuStyle="bsm-MenuUILarge";} else{if(oMaster._fIsRtL)oMaster._wzMenuStyle="bsm-MenuUIRtL";else oMaster._wzMenuStyle="bsm-MenuUI";}} oMaster._wzChkMrkPath=g_resFolder+"ChkMrk.gif";oMaster._wzMArrPath=g_resFolder+"MArr.gif";oMaster._wzMArrPathRtL=g_resFolder+"MArrRtL.gif";}
PPSMA.Menu.FixUpMenuStructure=function PPSMA_Menu$FixUpMenuStructure(oMaster){var menuNodes=oMaster._oRoot.childNodes;var lastGroupId=null;var lastMenuSeparatorRow=null;for(var nIndex=0;nIndex<menuNodes.length;nIndex++){var menuRow=menuNodes[nIndex];if(menuRow.nodeType!=1)continue;var deleteRow=false;var displayNone=menuRow.style!=null&&menuRow.style.display=='none';var jsHidden=PPSMA.Menu.FIsHidden(menuRow);if(displayNone||jsHidden){deleteRow=true;} else if(PPSMA.Menu.FIsIType(menuRow,"separator")){if(lastMenuSeparatorRow!=null||nIndex==0)deleteRow=true;else lastMenuSeparatorRow=menuRow;} else{var cGroupId=menuRow.getAttribute("menuGroupId");if(cGroupId!=lastGroupId&&lastMenuSeparatorRow==null&&nIndex!=0){var lastMenuSeparatorRow=document.createElement("ie:menuitem");lastMenuSeparatorRow.setAttribute("type","separator");oMaster._oRoot.insertBefore(lastMenuSeparatorRow,menuRow);} else{lastMenuSeparatorRow=null;} lastGroupId=cGroupId;} if(deleteRow){menuRow.parentNode.removeChild(menuRow);nIndex--;}} if(lastMenuSeparatorRow!=null)lastMenuSeparatorRow.parentNode.removeChild(lastMenuSeparatorRow);}
PPSMA.Menu.IsElementRtl=function PPSMA_Menu$IsElementRtl(oCurrent){while(oCurrent!=null&&oCurrent.tagName!=null){var dir=oCurrent.getAttribute("dir");if((dir==null||dir=="")&&oCurrent.style!=null){dir=oCurrent.style.direction;} if(dir=="rtl")return true;else if(dir=="ltr")return false;oCurrent=oCurrent.parentNode;} return false;}
PPSMA.Menu.AdjustScrollPosition=function PPSMA_Menu$AdjustScrollPosition(element,relativeToElement,result){var oCurrent=element;while(oCurrent!=null&&oCurrent!=relativeToElement&&oCurrent!=element.offsetParent&&oCurrent.tagName!=null&&oCurrent.tagName.toLowerCase()!="body"&&oCurrent.tagName.toLowerCase()!="html"){if(oCurrent.scrollWidth>oCurrent.clientWidth&&oCurrent.offsetWidth>=oCurrent.clientWidth&&oCurrent.clientWidth!=0){if(!PPSMA.Menu.IsElementRtl(oCurrent)){if(oCurrent.scrollLeft>0)result.x-=oCurrent.scrollLeft;} else{result.x+=(oCurrent.scrollWidth-oCurrent.offsetWidth-oCurrent.scrollLeft);}} if(oCurrent.scrollTop>0)result.y-=oCurrent.scrollTop;oCurrent=oCurrent.parentNode;}}
PPSMA.Menu.GetElementPosition=function PPSMA_Menu$GetElementPosition(element,relativeToElement){var result=new Object();result.x=0;result.y=0;result.width=0;result.height=0;if(element.offsetParent){var parent=element;while(parent!=null&&parent!=relativeToElement){result.x+=parent.offsetLeft;result.y+=parent.offsetTop;PPSMA.Menu.AdjustScrollPosition(parent,relativeToElement,result);var parentTagName=parent.tagName.toLowerCase();if(parentTagName!="table"&&parentTagName!="body"&&parentTagName!="html"&&parentTagName!="div"&&parent.clientTop&&parent.clientLeft){result.x+=parent.clientLeft;result.y+=parent.clientTop;} if(ppsbrowseris.ie&&parentTagName=="td"){if(parent.runtimeStyle.borderTopStyle!="none"||parent.currentStyle.borderTopStyle!="none"){var shift;if(parent.runtimeStyle.borderTopWidth!=""){shift=parseInt(parent.runtimeStyle.borderTopWidth);} else{shift=parseInt(parent.currentStyle.borderTopWidth);} if(!isNaN(shift)){result.y+=shift;}} if(parent.runtimeStyle.borderLeftStyle!="none"||parent.currentStyle.borderLeftStyle!="none"){var shift;if(parent.runtimeStyle.borderLeftWidth!=""){shift=parseInt(parent.runtimeStyle.borderLeftWidth);} else{shift=parseInt(parent.currentStyle.borderLeftWidth);} if(!isNaN(shift)){result.x+=shift;}}} parent=parent.offsetParent;}} else if(element.left&&element.top){result.x=element.left;result.y=element.top;} else{if(element.x){result.x=element.x;} if(element.y){result.y=element.y;}} if(element.offsetWidth&&element.offsetHeight){result.width=element.offsetWidth;result.height=element.offsetHeight;} else if(element.style&&element.style.pixelWidth&&element.style.pixelHeight){result.width=element.style.pixelWidth;result.height=element.style.pixelHeight;} return result;}
PPSMA.Menu.InternalShow=function PPSMA_Menu$InternalShow(oMaster,oParent,x,y,fFlipTop){var oPopup=oMaster._arrPopup[oMaster._nLevel];var nIndex;var fTopLevel;var oInnerDiv;if(!oMaster._oContents)PPSMA.Menu.PrepContents(oMaster);if(!oMaster._oContents||PPSMA.Menu.IsOpenInternal(oMaster))return;if(!oPopup&&!oMaster._oRoot){oMaster._nLevel=0;oMaster._oRoot=oMaster._oContents;} fTopLevel=oMaster._nLevel==0;fFlipTop=fFlipTop&&fTopLevel;if(!oPopup){oMaster._arrPopup[oMaster._nLevel]=document.createElement("DIV");oPopup=oMaster._arrPopup[oMaster._nLevel];oPopup.isMenu=true;oPopup.master=oMaster;oPopup.level=oMaster._nLevel;oInnerDiv=document.createElement("DIV");var oTable=document.createElement("table");var oTBody=document.createElement("tbody");oInnerDiv.isInner=true;oPopup.style.position="absolute";oInnerDiv.style.overflow="visible";oTable.appendChild(oTBody);oInnerDiv.appendChild(oTable);oPopup.appendChild(oInnerDiv);if(oMaster._fIsRtL)oPopup.setAttribute("dir","rtl");else oPopup.setAttribute("dir","ltr");document.body.appendChild(oPopup);PPSMA.Menu.FixUpMenuStructure(oMaster);var id=0;var childNodeLength=oMaster._oRoot.childNodes.length;for(nIndex=0;nIndex<childNodeLength;nIndex++){var oNode=oMaster._oRoot.childNodes[nIndex];if(oNode.nodeType!=1)continue;if(!PPSMA.Menu.FIsIType(oNode,"label")){var oItem=PPSMA.Menu.CreateMenuItem(oMaster,oNode,PPSMA.Menu.MakeID(oMaster,oMaster._nLevel,id));if(oItem)oTBody.appendChild(oItem);id++;}} if(PPSMA.Menu.GetType(oMaster)=="tooltip"){oPopup.className="bsm-TooltipUIPopupBody";} else{oPopup.className="bsm-MenuUIPopupBody";} oTable.className=oMaster._wzMenuStyle;oTable.cellSpacing=0;oTable.cellPadding=0;oPopup.oncontextmenu=kfnDisableEvent;oPopup.ondragstart=kfnDisableEvent;oPopup.onselectstart=kfnDisableEvent;if(oParent._onmouseover==null)oParent._onmouseover=oParent.onmouseover;if(oParent._onmouseout==null)oParent._onmouseout=oParent.onmouseout;if(oParent._onmouseup==null)oParent._onmouseup=oParent.onmouseup;if(oParent._onclick==null)oParent._onclick=oParent.onclick;if(oParent._oncontextmenu==null)oParent._oncontextmenu=oParent.oncontextmenu;if(ppsbrowseris.nav){oPopup.onkeypress=function(e){return false;};oPopup.onkeyup=function(e){return false;};oPopup.onmousedown=function(e){PPSMA.Menu.TrapMenuClick(e);return false;};oPopup.onmouseover=function(e){PPSMA.Menu.PopupMouseOver(e);return false;};oPopup.onmouseout=function(e){PPSMA.Menu.PopupMouseLeave(e);return false;};if("ontouchstart"in window){oPopup.ontouchstart=function(e){e.cancelBubble=true;return true;};} if(PPSMA.Menu.GetType(oMaster)!="tooltip"){oPopup.onkeydown=function(e){PPSMA.Menu.PopupKeyDown(e);return false;};oPopup.onclick=function(e){PPSMA.Menu.PopupMouseClick(e);PPSMA.Menu.TrapMenuClick(e);return false;};oParent.onmouseup=function(e){PPSMA.Menu.TrapMenuClick(e);return false;};oParent.onclick=function(e){PPSMA.Menu.TrapMenuClick(e);return false;};oParent.oncontextmenu=function(e){PPSMA.Menu.TrapMenuClick(e);return false;};} else{oPopup.onclick=function(e){PPSMA.Menu.TrapMenuClick(e);return false;};} oParent.onmouseover=function(e){PPSMA.Menu.PopupMouseOverParent(e);return false;};oParent.onmouseout=function(e){PPSMA.Menu.PopupMouseLeaveParent(e);return false;};} else{oPopup.onmousedown=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");oPopup.onmouseover=new Function("PPSMA.Menu.PopupMouseOver(event); return false;");oPopup.onmouseout=new Function("PPSMA.Menu.PopupMouseLeave(event); return false;");if("ontouchstart"in window){oPopup.ontouchstart=function(e){e.cancelBubble=true;return true;};} if(PPSMA.Menu.GetType(oMaster)!="tooltip"){oPopup.onkeydown=new Function("PPSMA.Menu.PopupKeyDown(event); return false;");oPopup.onclick=new Function("PPSMA.Menu.PopupMouseClick(event); PPSMA.Menu.TrapMenuClick(event); return false;");oParent.onmouseup=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");oParent.onclick=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");oParent.oncontextmenu=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");} else{oPopup.onclick=new Function("PPSMA.Menu.TrapMenuClick(event); return false;");} oParent.onmouseover=new Function("PPSMA.Menu.PopupMouseOverParent(event); return false;");oParent.onmouseout=new Function("PPSMA.Menu.PopupMouseLeaveParent(event); return false;");} if(fTopLevel){var wzOnUnload=oMaster.getAttribute("onunloadtext");if(wzOnUnload)oPopup.onunload=new Function(wzOnUnload);}} else{var oOld=oMaster._arrSelected[oMaster._nLevel];if(oOld)PPSMA.Menu.UnselectItem(oOld);} oMaster._arrSelected[oMaster._nLevel]=null;var oBackFrame;var oBackDiv;if(ppsbrowseris.ie){var originalScrollLeft=PPSMA.SizeEx.getScrollLeft();oBackFrame=document.createElement("iframe");PPSMA.Menu.AssureId(oBackFrame);oBackFrame.style.position="absolute";oBackFrame.style.display="none";oBackFrame.scrolling="no";oBackFrame.frameBorder="0";document.body.appendChild(oBackFrame);oPopup.style.zIndex=103;oPopup._backgroundFrameId=oBackFrame.id;oBackDiv=document.createElement("div");PPSMA.Menu.AssureId(oBackDiv);oBackDiv.style.backgroundColor="black";oBackDiv.style.position="absolute";oBackDiv.style.display="none";document.body.appendChild(oBackDiv);oPopup._backgroundDivId=oBackDiv.id;if(originalScrollLeft!=PPSMA.SizeEx.getScrollLeft()){PPSMA.SizeEx.setScrollLeft(originalScrollLeft);}} PPSMA.Menu.SetMenuPosition(oMaster,oParent,oPopup,oInnerDiv,x,y,fFlipTop,fTopLevel);if(ppsbrowseris.ie){PPSMA.Menu.SetBackFrameSize(null,oPopup);oPopup.onresize=new Function("PPSMA.Menu.SetBackFrameSize(event, null);");oBackFrame.style.display="block";oBackFrame.style.zIndex=101;oBackDiv.style.display="block";oBackDiv.style.zIndex=102;}}
PPSMA.Menu.SetMenuPosition=function PPSMA_Menu$SetMenuPosition(oMaster,oParent,oPopup,oInnerDiv,xClick,yClick,fFlipTop,fTopLevel){var maxWidth=window.screen.width;var maxHeight=window.screen.height;if(self.innerHeight){maxWidth=self.innerWidth;maxHeight=self.innerHeight;} else if(document.documentElement&&document.documentElement.clientHeight){maxWidth=document.documentElement.clientWidth;maxHeight=document.documentElement.clientHeight;} else if(document.body){maxWidth=document.body.clientWidth;maxHeight=document.body.clientHeight;} var nRealWidth=oPopup.scrollWidth+oPopup.offsetWidth-oPopup.clientWidth;var nRealHeight=oPopup.scrollHeight+oPopup.offsetHeight-oPopup.clientHeight;var widthTooBig=false;var heightTooBig=false;if(oMaster._fCompactItemsWithoutIcons&&nRealHeight>=375){heightTooBig=true;nRealHeight=375;} if(nRealHeight>=maxHeight-10){heightTooBig=true;nRealHeight=maxHeight-10;nRealWidth+=16;} if(nRealWidth>maxWidth-10){widthTooBig=true;nRealWidth=maxWidth-10;} if(!widthTooBig&&!heightTooBig){oInnerDiv.style.overflow="visible";} else{if(ppsbrowseris.ie){if(widthTooBig){oPopup.style.width=nRealWidth+"px";oInnerDiv.style.width=nRealWidth+"px";oInnerDiv.style.overflowX="scroll";} else{oInnerDiv.style.width=nRealWidth+"px";oInnerDiv.style.overflowX="visible";} if(heightTooBig){oPopup.style.height=nRealHeight+"px";oInnerDiv.style.height=nRealHeight+"px";oInnerDiv.style.overflowY="scroll";} else{oInnerDiv.style.height=nRealHeight+"px";oInnerDiv.style.overflowY="visible";}} else{oPopup.style.height=nRealHeight+"px";oInnerDiv.style.height=nRealHeight+"px";oPopup.style.width=nRealWidth+"px";oInnerDiv.style.width=nRealWidth+"px";oInnerDiv.style.overflow="auto";}} nRealWidth=oPopup.scrollWidth+oPopup.offsetWidth-oPopup.clientWidth;nRealHeight=oPopup.scrollHeight+oPopup.offsetHeight-oPopup.clientHeight;var EdgeLeft=0;var EdgeRight=maxWidth;var ParentLeft=0;var EdgeTop=0;var ParentTop=0;var nParentWidth;var oCurrent=oParent;if(ppsbrowseris.safari){if(oCurrent.tagName=="TR"&&oCurrent.childNodes.length>0)oCurrent=oCurrent.childNodes[0];} var p=PPSMA.Menu.GetElementPosition(oCurrent);ParentLeft=p.x;ParentTop=p.y;if(fTopLevel){if(xClick==-1&&yClick==-1){nParentWidth=p.width;ParentTop+=p.height-1;} else{ParentLeft+=xClick;ParentTop+=yClick;nParentWidth=-4;}} else{nParentWidth=p.width+1;} var fTryGoDefault=!fFlipTop&&!document.body.getAttribute("flipped");var fFlippedDefault,fFlippedNonDefault;var xDefault,xFlipped;if(!oMaster._fIsRtL){var MenuRightDefault;var MenuLeftFlipped;if(fTopLevel){xDefault=ParentLeft;MenuRightDefault=ParentLeft+nRealWidth;MenuLeftFlipped=ParentLeft+nParentWidth-nRealWidth;} else{xDefault=ParentLeft+nParentWidth;MenuRightDefault=ParentLeft+nParentWidth+nRealWidth;MenuLeftFlipped=ParentLeft-nRealWidth;} xFlipped=MenuLeftFlipped;fFlippedDefault=MenuRightDefault>EdgeRight&&MenuLeftFlipped>EdgeLeft;fFlippedNonDefault=!(MenuLeftFlipped<EdgeLeft&&MenuRightDefault<EdgeRight);} else{var MenuLeftDefault;var MenuRightFlipped;if(fTopLevel){MenuLeftDefault=ParentLeft+nParentWidth-nRealWidth;MenuRightFlipped=ParentLeft+nRealWidth;xFlipped=ParentLeft;} else{MenuLeftDefault=ParentLeft-nRealWidth;MenuRightFlipped=ParentLeft+nParentWidth+nRealWidth;xFlipped=ParentLeft+nParentWidth;} xDefault=MenuLeftDefault;fFlippedDefault=MenuLeftDefault<EdgeLeft&&MenuRightFlipped<EdgeRight;fFlippedNonDefault=!(MenuRightFlipped>EdgeRight&&MenuLeftDefault>EdgeLeft);} var fFlipped=fTryGoDefault?fFlippedDefault:fFlippedNonDefault;var x=fFlipped?xFlipped:xDefault;var xOffset;var yOffset;if(window.pageXOffset!==undefined){xOffset=window.pageXOffset;yOffset=window.pageYOffset;} else{var htmlElement=document.body.parentElement;if(!PPSMA.Menu.IsElementRtl(document.body)){xOffset=document.body.scrollLeft;xOffset+=htmlElement.scrollLeft;} else{xOffset=-document.body.scrollWidth+document.body.offsetWidth+document.body.scrollLeft;xOffset+=-htmlElement.scrollWidth+htmlElement.offsetWidth+htmlElement.scrollLeft;} yOffset=document.body.scrollTop;yOffset+=htmlElement.scrollTop;} if(nRealWidth>=maxWidth){x=xOffset;} else if(x-xOffset+nRealWidth>=maxWidth){x=xOffset+maxWidth-nRealWidth;} var y;if(nRealHeight>=maxHeight){y=yOffset;} else if(ParentTop+nRealHeight-yOffset>=maxHeight){y=yOffset+maxHeight-nRealHeight;} else{y=ParentTop;} oPopup.setAttribute("flipped",fFlipTop?fFlipped&&fFlippedDefault:fFlipped);var posLeft=Math.max(x,xOffset);var posTop=Math.max(y,yOffset);oPopup.style.left=posLeft+"px";oPopup.style.top=posTop+"px";}
PPSMA.Menu.SetBackFrameSize=function PPSMA_Menu$SetBackFrameSize(e,oPopup){if(oPopup==null)oPopup=PPSMA.Menu.GetEventSrcElement(e);var nRealWidth=oPopup.scrollWidth+oPopup.offsetWidth-oPopup.clientWidth;var nRealHeight=oPopup.scrollHeight+oPopup.offsetHeight-oPopup.clientHeight;var oBackFrame=document.getElementById(oPopup._backgroundFrameId);oBackFrame.style.left=oPopup.offsetLeft+"px";oBackFrame.style.top=oPopup.offsetTop+"px";oBackFrame.style.width=nRealWidth+"px";oBackFrame.style.height=nRealHeight+"px";var oBackDiv=document.getElementById(oPopup._backgroundDivId);oBackDiv.style.left=oPopup.offsetLeft+"px";oBackDiv.style.top=oPopup.offsetTop+"px";oBackDiv.style.width=nRealWidth+"px";oBackDiv.style.height=nRealHeight+"px";}
PPSMA.Menu.HideMenu=function PPSMA_Menu$HideMenu(oMaster,nPhase){PPSMA.Menu.ClearTimeoutToHideMenu();if(nPhase==null)nPhase=0;if(nPhase==2){if(oMaster._onDestroy!=null){oMaster._onDestroy();oMaster._onDestroy=null;} return;} if(PPSMA.Menu.IsOpenInternal(oMaster)&&!PPSMA.Menu.IsAccessibilityFeatureEnabledProxy()){if(oMaster._oParent!=null){oMaster._oParent.onclick=oMaster._oParent._onclick;oMaster._oParent.onmouseover=oMaster._oParent._onmouseover;oMaster._oParent.onmouseout=oMaster._oParent._onmouseout;oMaster._oParent.onmouseup=oMaster._oParent._onmouseup;oMaster._oParent.oncontextmenu=oMaster._oParent._oncontextmenu;} PPSMA.Menu.SetBodyEventHandlers(null,false);PPSMA.Menu.UpdateLevel(oMaster,0);var oPopup=oMaster._arrPopup[0];if(oPopup!=null){var oBackFrame=document.getElementById(oPopup._backgroundFrameId);if(oBackFrame!=null)oBackFrame.parentNode.removeChild(oBackFrame);oPopup.parentNode.removeChild(oPopup);var oBackDiv=document.getElementById(oPopup._backgroundDivId);if(oBackDiv!=null)oBackDiv.parentNode.removeChild(oBackDiv);oMaster._arrPopup[0]=null;if(nPhase==0){if(oMaster._onDestroy!=null){oMaster._onDestroy();oMaster._onDestroy=null;}}} PPSMA.Menu.g_lastMenu=null;}}
PPSMA.Menu.IsOpenInternal=function PPSMA_Menu$IsOpenInternal(oMaster){if(oMaster._accessibleMenu&&!oMaster._accessibleMenu.closed)return true;if(!oMaster._arrPopup)return false;var oPopup=oMaster._arrPopup[oMaster._nLevel];return oPopup!=null;}
PPSMA.Menu.FindLabel=function PPSMA_Menu$FindLabel(oParent){var arrNodes=oParent?oParent.childNodes:null;if(arrNodes){for(var nIndex=0;nIndex<arrNodes.length;nIndex++){var oNode=arrNodes[nIndex];if(oNode.nodeType!=1)continue;if(PPSMA.Menu.FIsIType(oNode,"label"))return oNode;}} return null;}
PPSMA.Menu.ShowRoot=function PPSMA_Menu$ShowRoot(oMaster,oParent,fForceRefresh,fFlipTop,xOffset,yOffset){if(fForceRefresh){oMaster._oContents=null;oMaster._oRoot=null;oMaster._nLevel=0;oMaster._arrPopup=new Array();oMaster._arrSelected=new Array();} else{oMaster._oRoot=oMaster._oContents;} PPSMA.Menu.UpdateLevel(oMaster,0);fFlipTop=fFlipTop!=false;PPSMA.Menu.InternalShow(oMaster,oParent,xOffset,yOffset,fFlipTop);}
PPSMA.Menu.ShowSubMenu=function PPSMA_Menu$ShowSubMenu(oMaster,nLevel,oParent){if(!oParent)return;if(oParent.submenuRoot==null)return;PPSMA.Menu.UpdateLevel(oMaster,nLevel);oMaster._oRoot=oParent.submenuRoot;oMaster._nLevel=oMaster._nLevel+1;PPSMA.Menu.InternalShow(oMaster,oParent,-1,-1,false);PPSMA.Menu.SetSubMenuCallbacks(oMaster);}
PPSMA.Menu.ShowSubMenuEvnt=function PPSMA_Menu$ShowSubMenuEvnt(id){var oMaster=document.getElementById(id);var oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){oPopup.removeAttribute("timeoutID");PPSMA.Menu.ShowSubMenu(oMaster,oMaster._nLevel,oMaster._arrSelected[oMaster._nLevel]);}}
function ClearTimeOut(oAttribute){var id=document.body.getAttribute(oAttribute);if(id!=null){window.clearTimeout(id);} document.body.removeAttribute(oAttribute);}
PPSMA.Menu.ClearShowSubMenuEvnt=function PPSMA_Menu$ClearShowSubMenuEvnt(oPopup){ClearTimeOut("timeoutID");}
PPSMA.Menu.GetEventSrcItem=function PPSMA_Menu$GetEventSrcItem(oMaster,srcElement){for(var oSrc=srcElement;oSrc&&!PPSMA.Menu.FIStringEquals(oSrc.tagName,"BODY");oSrc=oSrc.parentNode){if(PPSMA.Menu.FIStringEquals(oSrc.tagName,"TR")&&oSrc.id.substring(0,oMaster._wzPrefixID.length)==oMaster._wzPrefixID){return oSrc;}} return null;}
PPSMA.Menu.UpdateLevel=function PPSMA_Menu$UpdateLevel(oMaster,nLevel){var oPopup;while(oMaster._nLevel>nLevel){oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){PPSMA.Menu.ClearShowSubMenuEvnt(oPopup);var oBackFrame=document.getElementById(oPopup._backgroundFrameId);if(oBackFrame!=null)oBackFrame.parentNode.removeChild(oBackFrame);var oBackDiv=document.getElementById(oPopup._backgroundDivId);if(oBackDiv!=null)oBackDiv.parentNode.removeChild(oBackDiv);oPopup.parentNode.removeChild(oPopup);} oMaster._arrPopup[oMaster._nLevel]=null;oMaster._arrSelected[oMaster._nLevel]=null;oMaster._oRoot=oMaster._oRoot.parentNode;oMaster._nLevel--;} oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup)PPSMA.Menu.ClearShowSubMenuEvnt(oPopup);}
PPSMA.Menu.PopupMouseOver=function PPSMA_Menu$PopupMouseOver(e){var oPopup=PPSMA.Menu.GetEventPopup(e);if(oPopup!=null){var oMaster=oPopup.master;var nLevel=oPopup.level;if(nLevel<0)return;var oSrcElem=PPSMA.Menu.GetEventSrcItem(oMaster,PPSMA.Menu.GetEventSrcElement(e));if(oSrcElem){if(oSrcElem!=oMaster._arrSelected[nLevel]){if(PPSMA.Menu.FIsIType(oSrcElem,"separator")||PPSMA.Menu.FIsIType(oSrcElem,"valtooltip")||PPSMA.Menu.FIsIType(oSrcElem,"desctooltip")||PPSMA.Menu.FIsIType(oSrcElem,"normaltooltip")||PPSMA.Menu.FIsIType(oSrcElem,"descvaltooltip")||PPSMA.Menu.FIsIType(oSrcElem,"ttpheader")){PPSMA.Menu.ClearTimeoutToHideMenu();return;} PPSMA.Menu.ToggleMenuItem(oMaster,nLevel,oSrcElem);if(PPSMA.Menu.FIsIType(oSrcElem,"submenu"))PPSMA.Menu.EngageSelection(oMaster,true,true,false);} else if(nLevel<oMaster._nLevel){PPSMA.Menu.UnselectCurrentOption(oMaster);}} PPSMA.Menu.ClearTimeoutToHideMenu();}}
PPSMA.Menu.PopupMouseLeave=function PPSMA_Menu$PopupMouseLeave(e){var oPopup;oPopup=PPSMA.Menu.GetEventPopup(e);if(oPopup!=null){PPSMA.Menu.UnselectCurrentOption(oPopup.master);PPSMA.Menu.SetTimeoutToHideMenu();} return false;}
PPSMA.Menu.PopupMouseOverParent=function PPSMA_Menu$PopupMouseOverParent(e){if(PPSMA.Menu.g_lastMenu!=null){PPSMA.Menu.ClearTimeoutToHideMenu();if(PPSMA.Menu.g_lastMenu._oParent!=null&&PPSMA.Menu.g_lastMenu._oParent._onmouseover!=null){PPSMA.Menu.g_lastMenu._oParent._onmouseover();}}}
PPSMA.Menu.PopupMouseLeaveParent=function PPSMA_Menu$PopupMouseLeaveParent(e){if(PPSMA.Menu.g_lastMenu!=null){if(PPSMA.Menu.g_lastMenu._oParent!=null&&PPSMA.Menu.g_lastMenu._oParent._onmouseout!=null){PPSMA.Menu.g_lastMenu._oParent._onmouseout();} PPSMA.Menu.SetTimeoutToHideMenu();}}
PPSMA.Menu.ClearTimeoutToHideMenu=function PPSMA_Menu$ClearTimeoutToHideMenu(){if(document.body.getAttribute("HideMenuTimeOut")!=null){ClearTimeOut("HideMenuTimeOut");}}
PPSMA.Menu.SetTimeoutToHideMenu=function PPSMA_Menu$SetTimeoutToHideMenu(){ClearTimeOut("HideMenuTimeOut");document.body.setAttribute("HideMenuTimeOut",window.setTimeout(PPSMA.Menu.Hide,180000));}
PPSMA.Menu.PopupMouseClick=function PPSMA_Menu$PopupMouseClick(e){var oPopup=PPSMA.Menu.GetEventPopup(e);var oMaster=oPopup.master;var nLevel=oPopup.level;if(nLevel<0)return;if(oMaster&&!oMaster._arrSelected[nLevel]){oMaster._arrSelected[nLevel]=PPSMA.Menu.GetEventSrcItem(oMaster,PPSMA.Menu.GetEventSrcElement(e));} var oItem=oMaster._arrSelected[nLevel];PPSMA.Menu.UpdateLevel(oMaster,nLevel);var onExpand;var fExpand;if(ppsbrowseris.nav){fExpand=(e&&e.target&&e.target.className=="hierarchy");onExpand=(e&&e.target&&e.target.getAttribute("onExpand"));} else{fExpand=(e&&e.srcElement&&e.srcElement.className=="hierarchy");onExpand=(e&&e.srcElement&&e.srcElement.getAttribute("onExpand"));} PPSMA.Menu.EngageSelection(oMaster,true,false,false,fExpand,onExpand);}
PPSMA.Menu.PopupKeyDown=function PPSMA_Menu$PopupKeyDown(e){var oPopup=PPSMA.Menu.GetEventPopup(e);var oMaster=oPopup.master;var nLevel=oPopup.level;if(nLevel<0)return;var nKeyCode=PPSMA.Menu.GetEventKeyCode(e);var shiftKey=e.shiftKey;if(oMaster._fIsRtL){if(nKeyCode==37)nKeyCode=39;else if(nKeyCode==39)nKeyCode=37;} if(nKeyCode==9)nKeyCode=!shiftKey?40:38;PPSMA.Menu.ClearShowSubMenuEvnt(oPopup);switch(nKeyCode){case 38:PPSMA.Menu.MoveMenuSelection(oMaster,-1);break;case 40:PPSMA.Menu.MoveMenuSelection(oMaster,1);break;case 37:case 27:PPSMA.Menu.CloseCurrentLevel(oMaster,nKeyCode==27);break;case 39:case 13:PPSMA.Menu.EngageSelection(oMaster,nKeyCode==13,false,true);break;} e.returnValue=false;}
PPSMA.Menu.AssureId=function PPSMA_Menu$AssureId(obj){if(obj.id==null||obj.id=="")obj.id="msomenuid"+PPSMA.Menu.GetUniqueNumber();return obj.id;}
PPSMA.Menu.NavigateToMenu=function PPSMA_Menu$NavigateToMenu(oMaster){var oMenu=oMaster._arrPopup[oMaster._nLevel].firstChild;if(oMenu.tagName!="DIV"){alert("Internal Error at PPSMA.Menu.NavigateToMenu");} PPSMA.Menu.AssureId(oMenu);try{var oFirstItem=oMenu.firstChild.firstChild.firstChild;oFirstItem.tabIndex=0;if(oFirstItem.setActive!=null)oFirstItem.setActive();else if(oFirstItem.focus!=null)oFirstItem.focus();} catch(e){}}
PPSMA.Menu.ExecuteOnClick=function PPSMA_Menu$ExecuteOnClick(fnOnClick,oMaster){try{if(ppsbrowseris.safari){if(PPSMA.Menu.FIStringEquals(typeof(fnOnClick),"string"))eval("var document=window.document; {"+fnOnClick+"}");else fnOnClick();} else{if(PPSMA.Menu.FIStringEquals(typeof(fnOnClick),"string")){fnOnClick=new Function("event","var document=window.document; {"+fnOnClick+"}");} var oTemp=window.document.body.appendChild(window.document.createElement("span"));oTemp.master=oMaster;oTemp.onclick=fnOnClick;var evt;var ctx=null;if(typeof(currentCtx)!='undefined'&&currentCtx!=null)ctx=currentCtx;else if(typeof(ctxFilter)!='undefined'&&ctxFilter!=null)ctx=ctxFilter;if(ppsbrowseris.ie)evt={"srcElement":oTemp,"fakeEvent":1,"currentCtx":ctx};else evt={"target":oTemp,"fakeEvent":1,"currentCtx":ctx};oTemp.onclick(evt);oTemp.parentNode.removeChild(oTemp);}} catch(e){}}
PPSMA.Menu.EngageSelection=function PPSMA_Menu$EngageSelection(oMaster,fDoSelection,fDelayExpandSM,fEnterSM,fExpand,fCommand){var oItem=oMaster._arrSelected[oMaster._nLevel];if(!oItem||oItem.optionDisabled)return;if(PPSMA.Menu.FIsIType(oItem,"submenu")){if(fDelayExpandSM){PPSMA.Menu.SetTimeoutOnParentWindow(oMaster,"PPSMA.Menu.ShowSubMenuEvnt");} else{PPSMA.Menu.ShowSubMenu(oMaster,oMaster._nLevel,oItem);if(fEnterSM)PPSMA.Menu.MoveMenuSelection(oMaster,1);}} else if(fDoSelection){var fEnabled=oItem.getAttribute("enabled");if(fEnabled!="false"){if(!fExpand){var fnOnClick=oItem.getAttribute("onMenuClick");if(fnOnClick){PPSMA.Menu.HideMenu(oMaster,1);PPSMA.Menu.ExecuteOnClick(fnOnClick,oMaster);PPSMA.Menu.HideMenu(oMaster,2);}} else{eval(fCommand);}}}}
PPSMA.Menu.CloseCurrentLevel=function PPSMA_Menu$CloseCurrentLevel(oMaster,fAllowHideRoot){if(oMaster._nLevel>0){PPSMA.Menu.UpdateLevel(oMaster,oMaster._nLevel-1);var obj=oMaster._arrSelected[oMaster._nLevel];if(obj!=null){if(ppsbrowseris.nav){obj=obj.firstChild.firstChild.firstChild.firstChild.firstChild.nextSibling.firstChild.firstChild;if(obj.focus!=null)obj.focus();} else{if(obj.focus!=null)obj.focus();}}} else if(fAllowHideRoot){PPSMA.Menu.HideMenu(oMaster);var oParent=oMaster._oParent;while(oParent!=null&&oParent.tagName=="SPAN"&&oParent.getAttribute("contentEditable")!=null){oParent=oParent.parentElement;} if(oParent!=null){var focusElement=oParent;if(oParent.foa!=null){var foa=null;foa=eval(oParent.foa);if(foa==null){foa=byid(oParent.foa);} if(foa!=null){focusElement=foa;}} if(focusElement.setActive!=null){focusElement.setActive();} else if(focusElement.focus!=null){focusElement.focus();}}}}
PPSMA.Menu.UnselectCurrentOption=function PPSMA_Menu$UnselectCurrentOption(oMaster){if(oMaster._nLevel>=0){var oItem=oMaster._arrSelected[oMaster._nLevel];if(PPSMA.Menu.FIsIType(oItem,"option")){PPSMA.Menu.UnselectItem(oItem);oMaster._arrSelected[oMaster._nLevel]=null;}}}
PPSMA.Menu.MakeID=function PPSMA_Menu$MakeID(oMaster,nLevel,nIndex){return oMaster._wzPrefixID+"_"+nLevel+"_"+nIndex;}
PPSMA.Menu.GetItem=function PPSMA_Menu$GetItem(oMaster,nLevel,nIndex){var oPopup=oMaster._arrPopup[nLevel];return oPopup?document.getElementById(PPSMA.Menu.MakeID(oMaster,nLevel,nIndex)):null;}
PPSMA.Menu.MoveMenuSelection=function PPSMA_Menu$MoveMenuSelection(oMaster,iDir){var nIndex=-1;var nNumItems=oMaster._oRoot.childNodes.length;var oSelected=oMaster._arrSelected[oMaster._nLevel];if(oSelected){var wzSelectedID=oSelected?oSelected.id:null;if(wzSelectedID){var nCurIndex=parseInt(wzSelectedID.substring(wzSelectedID.lastIndexOf("_")+1,wzSelectedID.length));nIndex=(nCurIndex+nNumItems+iDir)%nNumItems;}} if(nIndex<0)nIndex=iDir>0?0:(nNumItems-1);var oItem;var nIndexStart=nIndex;do{oItem=PPSMA.Menu.GetItem(oMaster,oMaster._nLevel,nIndex);nIndex=(nIndex+nNumItems+iDir)%nNumItems;} while(nIndex!=nIndexStart&&(!oItem||oItem.style.display=="none"||!(PPSMA.Menu.FIsIType(oItem,"option")||PPSMA.Menu.FIsIType(oItem,"submenu"))));PPSMA.Menu.ToggleMenuItem(oMaster,oMaster._nLevel,oItem);}
PPSMA.Menu.ToggleMenuItem=function PPSMA_Menu$ToggleMenuItem(oMaster,nLevel,oItem){var oOld=oMaster._arrSelected[nLevel];if(!oItem||(oOld&&oItem.id==oOld.id))return;if(oOld){PPSMA.Menu.UnselectItem(oOld);oOld.onkeydown=null;oOld.onmousedown=null;oOld.onmouseover=null;oOld.onmouseout=null;oOld.oncontextmenu=null;if(PPSMA.Menu.FIsIType(oOld,"submenu")){PPSMA.Menu.ClearSubMenuInterval(oMaster);var hoverOff=PPSMA.Menu.GetISubMenuOnHoverOff(oOld);if(hoverOff&&hoverOff!="")eval(hoverOff);}} PPSMA.Menu.UpdateLevel(oMaster,nLevel);PPSMA.Menu.SelectItem(oItem);oMaster._arrSelected[nLevel]=oItem;oItem.tabIndex=0;if(oItem.setActive!=null)oItem.setActive();else if(oItem.focus!=null)oItem.focus();var oPopup=oMaster._arrPopup[nLevel];var oDiv=oPopup.childNodes[0];var posPopup=PPSMA.Menu.GetElementPosition(oItem,oDiv);if(posPopup.y+posPopup.height-oDiv.scrollTop>oDiv.offsetHeight){oDiv.scrollTop=posPopup.y+posPopup.height-oDiv.offsetHeight;} else if(posPopup.y<oDiv.scrollTop){oDiv.scrollTop=posPopup.y;}}
PPSMA.Menu.SelectItem=function PPSMA_Menu$SelectItem(oItem){if(!oItem)return;var oItemTableCell=oItem.firstChild;var oItemTable=oItemTableCell.firstChild;if(oItemTableCell.className=="bsm-MenuUIItemTableCellCompact")oItemTableCell.className="bsm-MenuUIItemTableCellCompactHover";else oItemTableCell.className="bsm-MenuUIItemTableCellHover";oItemTable.className="bsm-MenuUIItemTableHover";}
PPSMA.Menu.UnselectItem=function PPSMA_Menu$UnselectItem(oItem){if(!oItem)return;var oItemTableCell=oItem.firstChild;var oItemTable=oItemTableCell.firstChild;if(oItemTableCell.className=="bsm-MenuUIItemTableCellCompactHover")oItemTableCell.className="bsm-MenuUIItemTableCellCompact";else oItemTableCell.className="bsm-MenuUIItemTableCell";oItemTable.className="bsm-MenuUIItemTable";}
PPSMA.Menu.SetImageSize=function PPSMA_Menu$SetImageSize(oMaster,oImg,oSize){if(oSize==null){if(oMaster._fLargeIconMode)oSize=32;else oSize=16;} oImg.width=oSize;oImg.height=oSize;}
PPSMA.Menu.CreateMenuOption=function PPSMA_Menu$CreateMenuOption(oMaster,oRow,oNode,wzID,wzHtml){var oIcon=document.createElement("td");var oLabel=document.createElement("td");var oAccKey=document.createElement("td");var oArrow=document.createElement("td");oRow.appendChild(oIcon);oRow.appendChild(oLabel);oRow.appendChild(oAccKey);oRow.appendChild(oArrow);if(oMaster._fLargeIconMode)oIcon.className=!oMaster._fIsRtL?"bsm-MenuUIIconLarge":"bsm-MenuUIIconRtlLarge";else if(oNode.getAttribute("selected")=="true")oIcon.className=!oMaster._fIsRtL?"bsm-MenuUIIconSelected":"bsm-MenuUIIconSelectedRtL";else oIcon.className=!oMaster._fIsRtL?"bsm-MenuUIIcon":"bsm-MenuUIIconRtL";oIcon.align="center";var labelClass="bsm-MenuUILabel";if(oMaster._fCompactItemsWithoutIcons&&!oNode.getAttribute("iconSrc"))labelClass+="Compact";else if(oNode.getAttribute("selected")=="true")labelClass+="Selected";if(oNode.getAttribute("indent")=="true")labelClass+="Indent";if(oMaster._fIsRtL)labelClass+="RtL";oLabel.className=labelClass;oAccKey.className="bsm-MenuUIAccessKey";oArrow.className="bsm-MenuUISubmenuArrow";if(!oMaster._fLargeIconMode){oLabel.noWrap=true;} oIcon.noWrap=true;oAccKey.noWrap=true;oArrow.noWrap=true;oLabel.id=oNode.id;if(!wzHtml)wzHtml=oNode.innerHTML;if(oNode.getAttribute("enabled")=="false"){oRow.disabled=true;oLabel.className+=" bsm-MenuUIItemTableCellDisabled";} var wzIconSrc=null,wzIconAlt=null;if(oNode.getAttribute("checked")=="true"){wzIconSrc=oMaster._wzChkMrkPath;wzIconAlt="*";} else{wzIconSrc=PPSMA.Menu.EvalAttributeValue(oNode,"iconSrc","iconScript");wzIconAlt=oNode.getAttribute("iconAltText");} var innerHtml=wzHtml;var sText=PPSMA.Menu.EvalAttributeValue(oNode,"text","textScript");var sDescription=PPSMA.Menu.EvalAttributeValue(oNode,"description","descriptionScript");var oMenuItemBody=document.createElement("div");if(sDescription!=null&&oMaster._fLargeIconMode){var oBold=document.createElement("B");var oTextSpan=document.createElement("SPAN");var oTextNode=document.createTextNode(sText);var oBr=document.createElement("BR");var oDescSpan=document.createElement("SPAN");var oDescNode=document.createTextNode(sDescription);oTextSpan.setAttribute("style","white-space: nowrap;");oDescSpan.className="bsm-menuitemdescription";oMenuItemBody.appendChild(oBold);oBold.appendChild(oTextSpan);oTextSpan.appendChild(oTextNode);oMenuItemBody.appendChild(oBr);oMenuItemBody.appendChild(oDescSpan);oDescSpan.appendChild(oDescNode);} else if(sText!=null){var oTextSpan=document.createElement("SPAN");var hierarchy=oNode.getAttribute("hierarchy");if(hierarchy!=null){var myTextSpan=document.createElement("SPAN");myTextSpan.setAttribute("style","white-space: nowrap;");var command=oNode.getAttribute("onExpand");if(command!=null){myTextSpan.setAttribute("onExpand",command);} myTextSpan.className="hierarchy";oMenuItemBody.appendChild(myTextSpan);myTextSpan.innerHTML=hierarchy;oTextSpan.setAttribute("style","white-space: nowrap;");oMenuItemBody.appendChild(oTextSpan);oTextSpan.innerHTML=sText;} else{var oTextNode=document.createTextNode(sText);oTextSpan.setAttribute("style","white-space: nowrap;");oMenuItemBody.appendChild(oTextSpan);oTextSpan.appendChild(oTextNode);}} var htmlSpan=document.createElement("SPAN");htmlSpan.innerHTML=innerHtml;oMenuItemBody.appendChild(htmlSpan);if(wzIconSrc){var oImg=document.createElement("IMG");PPSMA.Menu.SetImageSize(oMaster,oImg);var oImgLbl=document.createElement("LABEL");oIcon.appendChild(oImg);oLabel.appendChild(oImgLbl);var wzIconId=wzID+"_"+"ICON";oImg.id=wzIconId;oImg.src=wzIconSrc;if(wzIconAlt){oImg.alt="";oImg.title="";} oImgLbl.htmlFor=wzIconId;oImgLbl.appendChild(oMenuItemBody);} else{var oImg=document.createElement("IMG");PPSMA.Menu.SetImageSize(oMaster,oImg);var oImgLbl=document.createElement("LABEL");oIcon.appendChild(oImg);oLabel.appendChild(oImgLbl);var wzIconId=wzID+"_"+"ICON";oImg.id=wzIconId;oImg.src=g_resFolder+"blank.gif";oImg.alt="";oImg.title="";oImgLbl.htmlFor=wzIconId;oImgLbl.appendChild(oMenuItemBody);if(oMaster._fLargeIconMode){oImg.width=32;oImg.height=16;} else{oImg.width=16;}} var wzAccKey=oNode.getAttribute("accessKeyText");if(wzAccKey)oAccKey.innerHTML=wzAccKey;PPSMA.Menu.SetIType(oRow,"option");}
PPSMA.Menu.CreateTooltip=function PPSMA_Menu$CreateTooltip(oMaster,oRow,oNode,wzID){var wzHtml="";var oLabel=document.createElement("td");oRow.appendChild(oLabel);oLabel.className="bsm-Tooltipcell";oLabel.noWrap=false;oLabel.id=oNode.id;if(!wzHtml)wzHtml=oNode.ttpdesc;var lblText=null;if(PPSMA.Menu.FIsIType(oNode,"desctooltip")){lblText=PPSMA.Menu.FCLabelText(g_descriptionTag);oLabel.innerHTML=lblText+PPSMA.Menu.ConvertIntoMultiLine(wzHtml);PPSMA.Menu.SetIType(oRow,"desctooltip");} else if(PPSMA.Menu.FIsIType(oNode,"valtooltip")){lblText=PPSMA.Menu.FCLabelText(g_valueTag);oLabel.innerHTML=lblText+PPSMA.Menu.ConvertIntoMultiLine(wzHtml);PPSMA.Menu.SetIType(oRow,"valtooltip");} else if(PPSMA.Menu.FIsIType(oNode,"normaltooltip")){oLabel.innerHTML=PPSMA.Menu.ConvertIntoMultiLine(wzHtml);PPSMA.Menu.SetIType(oRow,"normaltooltip");}}
PPSMA.Menu.CreateDescValTooltip=function PPSMA_Menu$CreateDescValTooltip(oMaster,oRow,oNode,wzID){var wzHtml="";var oLabel=document.createElement("td");oRow.appendChild(oLabel);oLabel.className="bsm-Tooltipcell";oLabel.noWrap=false;oLabel.id=oNode.id;if(oNode.ttpdesc!=null){lblText=PPSMA.Menu.FCLabelText(g_descriptionTag);if(!wzHtml)wzHtml=oNode.ttpdesc;} else if(oNode.ttpval!=null){lblText=PPSMA.Menu.FCLabelText(g_valueTag);if(!wzHtml)wzHtml=oNode.ttpval;} oLabel.innerHTML=lblText+PPSMA.Menu.ConvertIntoMultiLine(wzHtml);PPSMA.Menu.SetIType(oRow,"descvaltooltip");}
PPSMA.Menu.CreateMenuSeparator=function PPSMA_Menu$CreateMenuSeparator(oMaster,oRow){var oCell=document.createElement("td");var oDiv=document.createElement("div");oRow.appendChild(oCell);oCell.appendChild(oDiv);if(oMaster._fLargeIconMode)oDiv.className=!oMaster._fIsRtL?"bsm-MenuUISeparatorLarge":"bsm-MenuUISeparatorLargeRtl";else oDiv.className=!oMaster._fIsRtL?"bsm-MenuUISeparator":"bsm-MenuUISeparatorRtL";oDiv.innerHTML="&nbsp;";PPSMA.Menu.SetIType(oRow,"separator");}
PPSMA.Menu.CreateHeader=function PPSMA_Menu$CreateHeader(oMaster,oRow,oNode){var oHdr=document.createElement("td");oHdr.className="bsm-ttpHdrCell";oRow.appendChild(oHdr);var oparentDiv=document.createElement("div");oHdr.appendChild(oparentDiv);var ochldDiv=document.createElement("div");oparentDiv.appendChild(ochldDiv);ochldDiv.className="bsm-tooltiphdr";var oCloseImg=document.createElement("IMG");ochldDiv.appendChild(oCloseImg);oCloseImg.alt="Close";oCloseImg.src=g_resFolder+"CloseWindow.gif";oCloseImg.onclick=PPSMA.Menu.Hide;PPSMA.Menu.SetIType(oRow,"ttpheader");}
PPSMA.Menu.CreateSubmenu=function PPSMA_Menu$CreateSubmenu(oMaster,oRow,oNode,wzID){var oLabelNode=PPSMA.Menu.FindLabel(oNode);PPSMA.Menu.CreateMenuOption(oMaster,oRow,oNode,wzID,oLabelNode?oLabelNode.innerHTML:null);var oArrow=oRow.childNodes[3];var oArrowImg=document.createElement("IMG");PPSMA.Menu.SetImageSize(oMaster,oArrowImg,16);oArrow.appendChild(oArrowImg);oArrowImg.src=!oMaster._fIsRtL?oMaster._wzMArrPath:oMaster._wzMArrPathRtL;oArrowImg.alt=!oMaster._fIsRtL?">":"<";oArrowImg.title="";PPSMA.Menu.SetIType(oRow,"submenu");PPSMA.Menu.SetISubMenuOnFetch(oRow,PPSMA.Menu.GetISubMenuOnFetch(oNode));PPSMA.Menu.SetISubMenuOnPopulate(oRow,PPSMA.Menu.GetISubMenuOnPopulate(oNode));PPSMA.Menu.SetISubMenuOnHoverOff(oRow,PPSMA.Menu.GetISubMenuOnHoverOff(oNode));oRow.submenuRoot=oNode;}
PPSMA.Menu.MergeAttributes=function PPSMA_Menu$MergeAttributes(oTarget,oSource){if(ppsbrowseris.nav||oTarget.mergeAttributes==null){var oAttributes=oSource.attributes;for(var i=0;i<oAttributes.length;i++){var oAttrib=oAttributes[i];if(oAttrib!=null&&oAttrib.specified&&oAttrib.nodeName!="id"&&oAttrib.nodeName!="ID"&&oAttrib.nodeName!="name"){oTarget.setAttribute(oAttrib.nodeName,oAttrib.nodeValue);}} if(oSource.getAttribute("type")!=null)oTarget.setAttribute("type",oSource.getAttribute("type"));if(oSource.submenuRoot!=null)oTarget.submenuRoot=oSource.submenuRoot;} else{oTarget.mergeAttributes(oSource);}}
PPSMA.Menu.CreateMenuItem=function PPSMA_Menu$CreateMenuItem(oMaster,oNode,wzID,wzHtml){if(PPSMA.Menu.FIsIType(oNode,"label"))return;var oRow=document.createElement("tr");PPSMA.Menu.MergeAttributes(oRow,oNode);if(PPSMA.Menu.GetType(oMaster)!="tooltip"){oRow.setAttribute("onMenuClick",oNode.getAttribute("onMenuClick"));} if(PPSMA.Menu.FIsIType(oNode,"separator")){PPSMA.Menu.CreateMenuSeparator(oMaster,oRow);return oRow;} if(!PPSMA.Menu.GetIType(oNode))PPSMA.Menu.SetIType(oNode,"option");var oFmtTableRow=document.createElement("tr");var oFmtTableCell=document.createElement("td");var oFmtTable=document.createElement("table");var oFmtTableBody=document.createElement("tbody");oFmtTableRow.appendChild(oFmtTableCell);oFmtTableCell.appendChild(oFmtTable);oFmtTable.appendChild(oFmtTableBody);oFmtTableBody.appendChild(oRow);if(PPSMA.Menu.GetType(oMaster)!="tooltip"){if(oMaster._fCompactItemsWithoutIcons&&!oNode.getAttribute("iconSrc"))oFmtTableCell.className="bsm-MenuUIItemTableCellCompact";else oFmtTableCell.className="bsm-MenuUIItemTableCell";oFmtTable.className="bsm-MenuUIItemTable";} else{oFmtTableCell.className="bsm-TooltipUIItemTableCell";oFmtTable.className="bsm-TooltipUIItemTable";} oFmtTable.width="100%";oFmtTable.cellSpacing=0;oFmtTable.cellPadding=0;if(PPSMA.Menu.FIsIType(oNode,"submenu"))PPSMA.Menu.CreateSubmenu(oMaster,oRow,oNode,wzID);else if(PPSMA.Menu.FIsIType(oNode,"option"))PPSMA.Menu.CreateMenuOption(oMaster,oRow,oNode,wzID,wzHtml);else if(PPSMA.Menu.FIsIType(oNode,"valtooltip")||PPSMA.Menu.FIsIType(oNode,"desctooltip")||PPSMA.Menu.FIsIType(oNode,"normaltooltip"))PPSMA.Menu.CreateTooltip(oMaster,oRow,oNode,wzID);else if(PPSMA.Menu.FIsIType(oNode,"descvaltooltip"))PPSMA.Menu.CreateDescValTooltip(oMaster,oRow,oNode,wzID);else if(PPSMA.Menu.FIsIType(oNode,"ttpheader"))PPSMA.Menu.CreateHeader(oMaster,oRow,oNode);if(oRow.disabled||oRow.getAttribute("enabled")=="false"){oRow.disabled=false;oRow.className="bsm-MenuUIDisabled";oRow.disabled=false;for(var nIndex=0;nIndex<oRow.childNodes.length;nIndex++){if(oRow.childNodes[nIndex].nodeType!=1)continue;oRow.childNodes[nIndex].disabled=true;oFmtTableCell.className+=" bsm-MenuUIItemTableCellDisabled";} oRow.optionDisabled=true;} PPSMA.Menu.MergeAttributes(oFmtTableRow,oRow);if(oRow.optionDisabled!=null){oFmtTableRow.optionDisabled=oRow.optionDisabled;} oFmtTableRow.id=wzID;PPSMA.Menu.SetIType(oFmtTableRow,PPSMA.Menu.GetIType(oRow));return oFmtTableRow;}
PPSMA.Menu.GetISubMenuOnFetch=function PPSMA_Menu$GetISubMenuOnFetch(oItem){return oItem?oItem.getAttribute("onfetch"):null;}
PPSMA.Menu.SetISubMenuOnFetch=function PPSMA_Menu$SetISubMenuOnFetch(oItem,fetchCallback){if(oItem)oItem.setAttribute("onfetch",fetchCallback);}
PPSMA.Menu.GetISubMenuOnPopulate=function PPSMA_Menu$GetISubMenuOnPopulate(oItem){return oItem?oItem.getAttribute("onpopulate"):null;}
PPSMA.Menu.SetISubMenuOnPopulate=function PPSMA_Menu$SetISubMenuOnPopulate(oItem,fetchCallback){if(oItem)oItem.setAttribute("onpopulate",fetchCallback);}
PPSMA.Menu.GetISubMenuOnHoverOff=function PPSMA_Menu$GetISubMenuOnHoverOff(oItem){return oItem?oItem.getAttribute("onhoveroff"):null;}
PPSMA.Menu.SetISubMenuOnHoverOff=function PPSMA_Menu$SetISubMenuOnHoverOff(oItem,fetchCallback){if(oItem)oItem.setAttribute("onhoveroff",fetchCallback);}
PPSMA.Menu.GetIType=function PPSMA_Menu$GetIType(oItem){return oItem?oItem.getAttribute("type"):null;}
PPSMA.Menu.FIsIType=function PPSMA_Menu$FIsIType(oItem,wzType){return PPSMA.Menu.FIStringEquals(PPSMA.Menu.GetIType(oItem),wzType);}
PPSMA.Menu.SetIType=function PPSMA_Menu$SetIType(oItem,wzType){if(oItem)oItem.setAttribute("type",wzType);}
PPSMA.Menu.FIStringEquals=function PPSMA_Menu$FIStringEquals(wzX,wzY){return wzX!=null&&wzY!=null&&wzX.toLowerCase()==wzY.toLowerCase();}
PPSMA.Menu.RenderAccessibleMenu=function PPSMA_Menu$RenderAccessibleMenu(oMaster,fForceRefresh){if(fForceRefresh){oMaster._oContents=null;oMaster._oRoot=null;oMaster._nLevel=0;oMaster._arrPopup=new Array();oMaster._arrSelected=new Array();} else{oMaster._oRoot=oMaster._oContents;} if(!oMaster._oContents)PPSMA.Menu.PrepContents(oMaster);if(!oMaster._oContents)return;if(!oMaster._oRoot){oMaster._nLevel=0;oMaster._oRoot=oMaster._oContents;} PPSMA.Menu.FixUpMenuStructure(oMaster);var menuDir=oMaster._fIsRtL?"rtl":"ltr";PPSMA.Menu.g_html="<html dir='"+menuDir+"'><head><title>"+L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";PPSMA.Menu.RenderMenuLevel(oMaster,oMaster._oRoot,true);PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</ul></body></html>";var oNewWindow=window.open("","_blank","status=no,toolbar=no,menubar=no,location=no");oMaster._accessibleMenu=oNewWindow;oNewWindow.document.write(PPSMA.Menu.g_html);oNewWindow.document.close();oNewWindow.focus();}
PPSMA.Menu.RenderAccessibleDynamicMenu=function PPSMA_Menu$RenderAccessibleMenu(oMaster,oContents){oMaster._oContents=oContents;oMaster._oRoot=oContents;oMaster._nLevel=0;oMaster._arrPopup=new Array();oMaster._arrSelected=new Array();PPSMA.Menu.FixUpMenuStructure(oMaster);var menuDir=oMaster._fIsRtL?"rtl":"ltr";PPSMA.Menu.g_html="<html dir='"+menuDir+"'><head><title>"+L_AccessibleMenu_Text+"</title></head><body><ul id='root'>";PPSMA.Menu.RenderMenuLevel(oMaster,oMaster._oRoot,true);PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</ul></body></html>";var oNewWindow=window.open("","_blank","status=no,toolbar=no,menubar=no,location=no");oMaster._accessibleMenu=oNewWindow;oNewWindow.document.write(PPSMA.Menu.g_html);oNewWindow.document.close();oNewWindow.focus();}
PPSMA.Menu.CloseAccessibleMenu=function PPSMA_Menu$CloseAccessibleMenu(oMaster,n){if(n==null)n=0;if(oMaster!=null){if(n==0||n==1){if(oMaster._accessibleMenu!=null){oMaster._accessibleMenu.close();oMaster._accessibleMenu=null;}} if(n==0||n==2){if(oMaster._onDestroy!=null){oMaster._onDestroy();oMaster._onDestroy=null;}}}}
PPSMA.Menu.GetMenuItemText=function PPSMA_Menu$GetMenuItemText(oMaster,oNode,s){if(s==""){s=PPSMA.Menu.EvalAttributeValue(oNode,"text","textScript");var description=PPSMA.Menu.EvalAttributeValue(oNode,"description","descriptionScript");if(description!=null&&description!=""&&oMaster._fLargeIconMode){if(s!="")s=s+": ";s=s+description;}} if(oNode.getAttribute("checked")=="true")s="* "+s;if(oNode.title!=null&&oNode.title!="")s=s+": "+oNode.title;return s;}
PPSMA.Menu.GetMenuItemEnabled=function PPSMA_Menu$GetMenuItemEnabled(oNode,fEnabled){if(!fEnabled)return false;if(oNode.getAttribute("enabled")=="false")return false;if(oNode.getAttribute("disabled")!=null&&oNode.getAttribute("disabled")!="")return false;return true;}
PPSMA.Menu.g_html="";PPSMA.Menu.RenderMenuLevel=function PPSMA_Menu$RenderMenuLevel(oMaster,oRoot,fEnabled){for(var nIndex=0;nIndex<oRoot.childNodes.length;nIndex++){var oNode=oRoot.childNodes[nIndex];if(oNode.nodeType!=1)continue;if(oNode.style.display=="none")continue;if(PPSMA.Menu.FIsIType(oNode,"option")){var s=PPSMA.Menu.GetMenuItemText(oMaster,oNode,oNode.innerHTML);if(!PPSMA.Menu.GetMenuItemEnabled(oNode,fEnabled)){PPSMA.Menu.g_html=PPSMA.Menu.g_html+"<li><span id=\""+oNode.id+"\">"+s+"</span></li>";} else{PPSMA.Menu.g_html=PPSMA.Menu.g_html+"<li><a href=\"#\" id=\""+oNode.id+"\" "+"onMenuClick=\""+oNode.getAttribute("onMenuClick")+"\" "+"onclick=\"javascript:opener.PPSMA.Menu.ExecuteOnAccessibleClick(this.getAttribute('onMenuClick')); return false;\" "+">"+s+"</a></li>";}} else if(PPSMA.Menu.FIsIType(oNode,"submenu")){var s=PPSMA.Menu.GetMenuItemText(oMaster,oNode,"");for(var n=0;n<oNode.childNodes.length;n++){var oLabelNode=oNode.childNodes[n];if(oLabelNode.nodeType!=1)continue;if(oLabelNode.style.display=="none")continue;if(PPSMA.Menu.FIsIType(oLabelNode,"label")){s+=" "+oLabelNode.innerHTML;break;}} var fetchCB=PPSMA.Menu.GetISubMenuOnFetch(oNode);if(fetchCB&&fetchCB!=""){var populateCB=PPSMA.Menu.GetISubMenuOnPopulate(oNode);PPSMA.Menu.g_html=PPSMA.Menu.g_html+"<li><a href=\"#\" id=\""+oNode.id+"\" "+"onfetch=\""+fetchCB+"\" "+"onpopulate=\""+populateCB+"\" "+"onclick=\"javascript:opener.PPSMA.Menu.ExecuteOnAccessibleFetch(this); return false;\" "+">"+s+"</a></li>";} else{PPSMA.Menu.g_html=PPSMA.Menu.g_html+"<li><span id=\""+oNode.id+"\">"+s;PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</span><ul>";PPSMA.Menu.RenderMenuLevel(oMaster,oNode,PPSMA.Menu.GetMenuItemEnabled(oNode,fEnabled));PPSMA.Menu.g_html=PPSMA.Menu.g_html+"</ul></li>";}}}}
PPSMA.Menu.ExecuteOnAccessibleClick=function PPSMA_Menu$ExecuteOnAccessibleClick(fnOnClick){var oMaster=PPSMA.Menu.g_lastMenu;if(oMaster!=null){PPSMA.Menu.CloseAccessibleMenu(oMaster,1);window.focus();PPSMA.Menu.ExecuteOnClick(fnOnClick,oMaster);PPSMA.Menu.CloseAccessibleMenu(oMaster,2);}}
PPSMA.Menu.ExecuteOnAccessibleFetch=function PPSMA_Menu$ExecuteOnAccessibleFetch(oItem){var oMaster=PPSMA.Menu.g_lastMenu;if(oMaster!=null&&oMaster._accessibleMenu!=null){var fetchCB=PPSMA.Menu.GetISubMenuOnFetch(oItem);var populateCB=PPSMA.Menu.GetISubMenuOnPopulate(oItem);if(fetchCB&&fetchCB!=""&&populateCB&&populateCB!=""){oMaster._accessibleMenu.onpopulate=populateCB;oMaster._accessibleMenu.intervalID=oMaster._accessibleMenu.setInterval("opener.PPSMA.Menu.CheckPopulateAccessibleCallback('"+oMaster.id+"');",300);eval(fetchCB);}}}
PPSMA.Menu.FIsHidden=function PPSMA_Menu$FIsHidden(oItem){if(oItem){var hiddenFunc=oItem.getAttribute("hidden");if(!hiddenFunc)return false;return eval(hiddenFunc);} else return false;}
PPSMA.Menu.EvalAttributeValue=function PPSMA_Menu$EvalAttributeValue(oNode,sAttribute1,sAttribute2){var result=oNode.getAttribute(sAttribute2);if(result!=null&&result.toLowerCase().indexOf("javascript:")==0){result=eval(result.substring(11));if(result!=null&&result!="")return result;} var result=oNode.getAttribute(sAttribute1);if(result==null)return"";return result;}
PPSMA.Menu.FCLabelText=function PPSMA_Menu$FCLabelText(wzText){wzText="<b class = \"bsm-TooltipLabel\">"+wzText+"</b><br/>";return wzText;}
PPSMA.Menu.ConvertIntoMultiLine=function PPSMA_Menu$ConvertIntoMultiLine(wzDescription){var displayText=wzDescription;var lenToRead=displayText.length;var chunk=120;var start=0;var output="";while(lenToRead-chunk>=0){var tmp=displayText.substr(start,chunk);output=output+tmp+"<br/>";start=start+chunk;lenToRead=lenToRead-chunk;} var multiline=output+displayText.substr(start,lenToRead)+"<br/>";return multiline;};PPSMA.Menu.Refresh=function PPSMA_Menu$Refresh(oMaster,m,force){PPSMA.Menu.ClearSubMenuInterval(oMaster);if(force){if(oMaster._accessibleMenu!=null){PPSMA.Menu.CloseAccessibleMenu(oMaster,0);PPSMA.Menu.RenderAccessibleDynamicMenu(oMaster,m);} else{PPSMA.Menu.CloseCurrentLevel(oMaster,false);oParent=oMaster._arrSelected[oMaster._nLevel];oParent.submenuRoot=m;PPSMA.Menu.SetTimeoutOnParentWindow(oMaster,"PPSMA.Menu.ShowNewSubMenuEvnt");}}}
PPSMA.Menu.ClearSubMenuInterval=function PPSMA_Menu$ClearSubMenuInterval(oMaster){var oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){var id=oPopup.getAttribute("intervalID");if(typeof(id)=="number")window.clearInterval(id);oPopup.removeAttribute("intervalID");}}
PPSMA.Menu.SetTimeoutOnParentWindow=function PPSMA_Menu$SetTimeoutOnParentWindow(oMaster,fn){var oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){oPopup.setAttribute("timeoutID",window.setTimeout(new Function(fn+"('"+oMaster.id+"');"),100));}}
PPSMA.Menu.ShowNewSubMenuEvnt=function PPSMA_Menu$ShowNewSubMenuEvnt(id){var oMaster=document.getElementById(id);var oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){oPopup.removeAttribute("timeoutID");PPSMA.Menu.ShowNewSubMenu(oMaster,oMaster._nLevel,oMaster._arrSelected[oMaster._nLevel]);}}
PPSMA.Menu.ShowNewSubMenu=function PPSMA_Menu$ShowNewSubMenu(oMaster,nLevel,oParent){if(!oParent)return;if(oParent.submenuRoot==null)return;PPSMA.Menu.UpdateLevel(oMaster,nLevel);oMaster._oRoot=oParent.submenuRoot;oMaster._nLevel=oMaster._nLevel+1;PPSMA.Menu.InternalShow(oMaster,oParent,-1,-1,false);PPSMA.Menu.MoveMenuSelection(oMaster,1);}
PPSMA.Menu.SetSubMenuCallbacks=function PPSMA_Menu$SetSubMenuCallbacks(oMaster){var oPopup=oMaster._arrPopup[oMaster._nLevel];if(oPopup){var oItem=oMaster._arrSelected[oMaster._nLevel-1];var fetchCB=PPSMA.Menu.GetISubMenuOnFetch(oItem);if(fetchCB&&fetchCB!=""){oPopup.setAttribute("intervalID",window.setInterval(new Function("PPSMA.Menu.CheckPopulateCallback('"+oMaster.id+"');"),300));eval(fetchCB);}}}
PPSMA.Menu.CheckPopulateCallback=function PPSMA_Menu$CheckPopulateCallback(id){var oMaster=document.getElementById(id);var oItem=oMaster._arrSelected[oMaster._nLevel-1];var populateCB=PPSMA.Menu.GetISubMenuOnPopulate(oItem);if(populateCB&&populateCB!="")eval(populateCB);}
PPSMA.Menu.CheckPopulateAccessibleCallback=function PPSMA_Menu$CheckPopulateAccessibleCallback(id){var oMaster=document.getElementById(id);if(oMaster._accessibleMenu!=null){var populateCB=oMaster._accessibleMenu.onpopulate;if(populateCB&&populateCB!="")eval(populateCB);}}

if(typeof(Sys)!=='undefined')Sys.Application.notifyScriptLoaded();